

============================== 2025-08-02 12:13:22.415887 | b5bbd8c9-7191-421f-ba15-bb4cf1be547a ==============================
12:13:22.415887 [info ] [MainThread]: Running with dbt=1.0.0
12:13:22.416783 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
12:13:22.417572 [debug] [MainThread]: Tracking: tracking
12:13:22.426287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71024d74a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71024d74a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71024d74a370>]}
12:13:22.799270 [debug] [MainThread]: Executing "git --help"
12:13:22.813839 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:13:22.814464 [debug] [MainThread]: STDERR: "b''"
12:13:22.819613 [debug] [MainThread]: Acquiring new snowflake connection "debug"
12:13:22.823117 [debug] [MainThread]: Using snowflake connection "debug"
12:13:22.827161 [debug] [MainThread]: On debug: select 1 as id
12:13:22.831611 [debug] [MainThread]: Opening a new connection, currently in state init
12:13:23.986950 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.16 seconds
12:13:23.993207 [debug] [MainThread]: On debug: Close
12:13:24.067574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710247b13b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71024d738d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710246333d30>]}
12:13:24.475479 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2025-08-02 12:14:34.584229 | bf8f1ec5-b207-4d3b-9866-16579035dd00 ==============================
12:14:34.584229 [info ] [MainThread]: Running with dbt=1.0.0
12:14:34.589219 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
12:14:34.592954 [debug] [MainThread]: Tracking: tracking
12:14:34.602170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0b78ed460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0b78ed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0b78ed3a0>]}
12:14:35.024389 [debug] [MainThread]: Executing "git --help"
12:14:35.038495 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:14:35.039352 [debug] [MainThread]: STDERR: "b''"
12:14:35.044316 [debug] [MainThread]: Acquiring new snowflake connection "debug"
12:14:35.045495 [debug] [MainThread]: Using snowflake connection "debug"
12:14:35.046009 [debug] [MainThread]: On debug: select 1 as id
12:14:35.046438 [debug] [MainThread]: Opening a new connection, currently in state init
12:14:36.351613 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.31 seconds
12:14:36.354593 [debug] [MainThread]: On debug: Close
12:14:36.425602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0b1cafeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0b1c4daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c0b1c4df40>]}
12:14:36.854607 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2025-08-02 12:25:50.215048 | 1e106cc4-c59a-439e-b34a-e7331adffd2f ==============================
12:25:50.215048 [info ] [MainThread]: Running with dbt=1.0.0
12:25:50.216129 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_sales_train'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:25:50.216927 [debug] [MainThread]: Tracking: tracking
12:25:50.217656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815d4db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815d4dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815d4da60>]}
12:25:50.232491 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:25:50.233159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e106cc4-c59a-439e-b34a-e7331adffd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815d84730>]}
12:25:50.415928 [debug] [MainThread]: Parsing macros/catalog.sql
12:25:50.418058 [debug] [MainThread]: Parsing macros/adapters.sql
12:25:50.443350 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:25:50.444664 [debug] [MainThread]: Parsing macros/materializations/merge.sql
12:25:50.447479 [debug] [MainThread]: Parsing macros/materializations/table.sql
12:25:50.449842 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:25:50.453391 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:25:50.458961 [debug] [MainThread]: Parsing macros/materializations/view.sql
12:25:50.460290 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:25:50.463016 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:25:50.464837 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:25:50.468871 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:25:50.478507 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:25:50.480393 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:25:50.483656 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:25:50.485256 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:25:50.492656 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:25:50.501875 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:25:50.503520 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:25:50.509345 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:25:50.519193 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:25:50.521266 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:25:50.525570 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:25:50.527446 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:25:50.528677 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:25:50.530838 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:25:50.535918 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:25:50.542768 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:25:50.544381 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:25:50.550601 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:25:50.560112 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:25:50.565795 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:25:50.568654 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:25:50.570057 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:25:50.572152 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:25:50.573572 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:25:50.574833 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:25:50.575686 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:25:50.576621 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:25:50.577370 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:25:50.583655 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:25:50.587027 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:25:50.589376 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:25:50.594131 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:25:50.595986 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:25:50.598084 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:25:50.604073 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:25:50.710916 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
12:25:50.723764 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
12:25:50.726049 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
12:25:50.728204 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
12:25:50.730498 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
12:25:50.732628 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
12:25:50.777236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e106cc4-c59a-439e-b34a-e7331adffd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815cbcf10>]}
12:25:50.800062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e106cc4-c59a-439e-b34a-e7331adffd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815cbcd90>]}
12:25:50.801017 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
12:25:50.804224 [info ] [MainThread]: 
12:25:50.805909 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:25:50.807974 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:25:50.816762 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:25:50.817572 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:25:50.818076 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:25:51.873157 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.06 seconds
12:25:51.875457 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:25:51.941713 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_STAGING_staging"
12:25:51.942957 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_STAGING_staging"
12:25:51.943936 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='sales_pipeline', schema='staging_staging', identifier=None)"
12:25:51.947616 [debug] [ThreadPool]: Using snowflake connection "create_SALES_PIPELINE_STAGING_staging"
12:25:51.948368 [debug] [ThreadPool]: On create_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "create_SALES_PIPELINE_STAGING_staging"} */
create schema if not exists SALES_PIPELINE.STAGING_staging
12:25:51.949097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:25:52.607711 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.66 seconds
12:25:52.611290 [debug] [ThreadPool]: On create_SALES_PIPELINE_STAGING_staging: Close
12:25:52.686206 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:25:52.691600 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:25:52.694933 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:25:52.698771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:25:53.212507 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.51 seconds
12:25:53.218307 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:25:53.285745 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:25:53.288101 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:25:53.288719 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:25:53.289167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:25:53.836527 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19a9-0001-63bb-0001-5712000383da
12:25:53.837357 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:25:53.838116 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:25:53.838731 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:25:53.839425 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:25:53.902677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:25:53.905120 [info ] [MainThread]: 
12:25:53.922091 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_sales_train
12:25:53.925888 [info ] [Thread-1  ]: 1 of 1 START view model STAGING_staging.stg_sales_train......................... [RUN]
12:25:53.930387 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
12:25:53.933908 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_sales_train
12:25:53.936653 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_sales_train
12:25:53.938605 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_sales_train"
12:25:53.959822 [debug] [Thread-1  ]: finished collecting timing info
12:25:53.960517 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_sales_train
12:25:53.977685 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_sales_train"
12:25:53.998171 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
12:25:53.998890 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_sales_train: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_sales_train"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_sales_train 
  
   as (
    -- models/staging/stg_sales_train.sql

with source as (
    select
        date,
        cast(date_block_num as int) as date_block_num,
        cast(shop_id as int) as shop_id,
        cast(item_id as int) as item_id,
        cast(item_price as float) as item_price,
        cast(item_cnt_day as float) as item_cnt_day
    from RAW.sales_train
)

select * from source
  );
12:25:53.999507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:25:54.662976 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.66 seconds
12:25:54.668232 [debug] [Thread-1  ]: finished collecting timing info
12:25:54.669124 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_sales_train: Close
12:25:54.732152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e106cc4-c59a-439e-b34a-e7331adffd2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7717f6738940>]}
12:25:54.733392 [info ] [Thread-1  ]: 1 of 1 OK created view model STAGING_staging.stg_sales_train.................... [[32mSUCCESS 1[0m in 0.80s]
12:25:54.734075 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_sales_train
12:25:54.735512 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:25:54.736247 [info ] [MainThread]: 
12:25:54.737006 [info ] [MainThread]: Finished running 1 view model in 3.93s.
12:25:54.737762 [debug] [MainThread]: Connection 'master' was properly closed.
12:25:54.738360 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.stg_sales_train' was properly closed.
12:25:54.760602 [info ] [MainThread]: 
12:25:54.762119 [info ] [MainThread]: [32mCompleted successfully[0m
12:25:54.763080 [info ] [MainThread]: 
12:25:54.763757 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
12:25:54.764616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815dfc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x771815dfc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7717f677ec40>]}


============================== 2025-08-02 12:34:23.089487 | 2349db6d-246a-4dec-9e03-9e1ba6cbea16 ==============================
12:34:23.089487 [info ] [MainThread]: Running with dbt=1.0.0
12:34:23.091979 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_sales_train'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:34:23.093284 [debug] [MainThread]: Tracking: tracking
12:34:23.094473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240df0d0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240df0d0ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240df0d0a60>]}
12:34:23.226988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:34:23.228007 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_sales_train.sql
12:34:23.237470 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
12:34:23.266188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240ddfa3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240dc15da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240dc15daf0>]}


============================== 2025-08-02 12:40:02.520250 | 0ca22640-09a4-43b5-a61e-ce8db957deec ==============================
12:40:02.520250 [info ] [MainThread]: Running with dbt=1.0.0
12:40:02.521003 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['staging'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:40:02.521743 [debug] [MainThread]: Tracking: tracking
12:40:02.522354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d86898ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d86898a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d86898a00>]}
12:40:02.703931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
12:40:02.705159 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/schema.yml
12:40:02.706053 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_item_categories.sql
12:40:02.706687 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_sales_train.sql
12:40:02.707216 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_shops.sql
12:40:02.707685 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_items.sql
12:40:02.716684 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
12:40:02.728077 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
12:40:02.732546 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
12:40:02.734645 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
12:40:02.736686 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
12:40:02.771734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d8414ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d8414ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736d8414adc0>]}


============================== 2025-08-02 12:40:55.742814 | 4434fab9-a38a-44d1-906d-edcc901de934 ==============================
12:40:55.742814 [info ] [MainThread]: Running with dbt=1.0.0
12:40:55.743588 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['staging'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:40:55.744555 [debug] [MainThread]: Tracking: tracking
12:40:55.745691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73898c94aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73898c94aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73898c94aa30>]}
12:40:56.002338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
12:40:56.003752 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/schema.yml
12:40:56.004283 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_sales_train.sql
12:40:56.004732 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_shops.sql
12:40:56.005157 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_items.sql
12:40:56.005605 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_item_categories.sql
12:40:56.015851 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
12:40:56.029392 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
12:40:56.035507 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
12:40:56.040085 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
12:40:56.043840 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
12:40:56.122637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4434fab9-a38a-44d1-906d-edcc901de934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389897950a0>]}
12:40:56.147884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4434fab9-a38a-44d1-906d-edcc901de934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73898c98d040>]}
12:40:56.149245 [info ] [MainThread]: Found 6 models, 15 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:40:56.151121 [info ] [MainThread]: 
12:40:56.152044 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:40:56.153696 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:40:56.163573 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:40:56.164427 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:40:56.164944 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:40:57.378123 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.21 seconds
12:40:57.380595 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:40:57.443920 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:40:57.452574 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:40:57.453082 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:40:57.453587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:40:58.001785 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19b8-0001-63bb-0001-57120003841e
12:40:58.002629 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:40:58.003838 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:40:58.004496 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:40:58.006307 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:40:58.071465 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:40:58.073220 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:40:58.073930 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:40:58.074753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:40:58.632280 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.56 seconds
12:40:58.634151 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:40:58.706922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:40:58.709752 [info ] [MainThread]: 
12:40:58.724718 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_item_categories
12:40:58.730420 [info ] [Thread-1  ]: 1 of 4 START view model STAGING_staging.stg_item_categories..................... [RUN]
12:40:58.731241 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
12:40:58.731761 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_item_categories
12:40:58.732244 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_item_categories
12:40:58.734510 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_item_categories"
12:40:58.739996 [debug] [Thread-1  ]: finished collecting timing info
12:40:58.740597 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_item_categories
12:40:58.757838 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_item_categories"
12:40:58.773660 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
12:40:58.774193 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_item_categories"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_item_categories 
  
   as (
    -- dbt_sales_pipeline/models/staging/stg_item_categories.sql
SELECT
    item_category_id,
    item_category_name
FROM SALES_PIPELINE.RAW.item_categories
  );
12:40:58.774630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:40:59.371154 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
12:40:59.376476 [debug] [Thread-1  ]: finished collecting timing info
12:40:59.378317 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: Close
12:40:59.444883 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4434fab9-a38a-44d1-906d-edcc901de934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738988aad8b0>]}
12:40:59.446124 [info ] [Thread-1  ]: 1 of 4 OK created view model STAGING_staging.stg_item_categories................ [[32mSUCCESS 1[0m in 0.71s]
12:40:59.447257 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_item_categories
12:40:59.448020 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_items
12:40:59.448786 [info ] [Thread-1  ]: 2 of 4 START view model STAGING_staging.stg_items............................... [RUN]
12:40:59.450012 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_items"
12:40:59.451360 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_items
12:40:59.452203 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_items
12:40:59.455565 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_items"
12:40:59.470858 [debug] [Thread-1  ]: finished collecting timing info
12:40:59.471692 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_items
12:40:59.474924 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_items"
12:40:59.498710 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_items"
12:40:59.499737 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_items"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_items 
  
   as (
    -- dbt_sales_pipeline/models/staging/stg_items.sql
SELECT
    item_id,
    item_name
FROM SALES_PIPELINE.RAW.items
  );
12:40:59.500251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:00.316709 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
12:41:00.318822 [debug] [Thread-1  ]: finished collecting timing info
12:41:00.319590 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: Close
12:41:00.388305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4434fab9-a38a-44d1-906d-edcc901de934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738988333b80>]}
12:41:00.389463 [info ] [Thread-1  ]: 2 of 4 OK created view model STAGING_staging.stg_items.......................... [[32mSUCCESS 1[0m in 0.94s]
12:41:00.390419 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_items
12:41:00.391631 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_sales_train
12:41:00.392439 [info ] [Thread-1  ]: 3 of 4 START view model STAGING_staging.stg_sales_train......................... [RUN]
12:41:00.393309 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
12:41:00.393976 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_sales_train
12:41:00.394694 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_sales_train
12:41:00.397399 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_sales_train"
12:41:00.406304 [debug] [Thread-1  ]: finished collecting timing info
12:41:00.408719 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_sales_train
12:41:00.411443 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_sales_train"
12:41:00.420271 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
12:41:00.421232 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_sales_train: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_sales_train"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_sales_train 
  
   as (
    -- models/staging/stg_sales_train.sql

with source as (
    select
        date,
        cast(date_block_num as int) as date_block_num,
        cast(shop_id as int) as shop_id,
        cast(item_id as int) as item_id,
        cast(item_price as float) as item_price,
        cast(item_cnt_day as float) as item_cnt_day
    FROM SALES_PIPELINE.RAW.sales_train
)

select * from source
  );
12:41:00.421919 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:01.066530 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
12:41:01.071886 [debug] [Thread-1  ]: finished collecting timing info
12:41:01.075502 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_sales_train: Close
12:41:01.141898 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4434fab9-a38a-44d1-906d-edcc901de934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738988333a90>]}
12:41:01.144950 [info ] [Thread-1  ]: 3 of 4 OK created view model STAGING_staging.stg_sales_train.................... [[32mSUCCESS 1[0m in 0.75s]
12:41:01.145548 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_sales_train
12:41:01.146088 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_shops
12:41:01.146799 [info ] [Thread-1  ]: 4 of 4 START view model STAGING_staging.stg_shops............................... [RUN]
12:41:01.150750 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_shops"
12:41:01.155059 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_shops
12:41:01.155965 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_shops
12:41:01.164366 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_shops"
12:41:01.185700 [debug] [Thread-1  ]: finished collecting timing info
12:41:01.187737 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_shops
12:41:01.194790 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_shops"
12:41:01.202369 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_shops"
12:41:01.206244 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_shops"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_shops 
  
   as (
    -- dbt_sales_pipeline/models/staging/stg_shops.sql
SELECT
    shop_id,
    shop_name
FROM SALES_PIPELINE.RAW.shops
  );
12:41:01.207185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:02.060994 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.85 seconds
12:41:02.062509 [debug] [Thread-1  ]: finished collecting timing info
12:41:02.063128 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_shops: Close
12:41:02.128628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4434fab9-a38a-44d1-906d-edcc901de934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738988333970>]}
12:41:02.129449 [info ] [Thread-1  ]: 4 of 4 OK created view model STAGING_staging.stg_shops.......................... [[32mSUCCESS 1[0m in 0.98s]
12:41:02.130058 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_shops
12:41:02.133562 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:41:02.137817 [info ] [MainThread]: 
12:41:02.142317 [info ] [MainThread]: Finished running 4 view models in 5.99s.
12:41:02.143182 [debug] [MainThread]: Connection 'master' was properly closed.
12:41:02.144711 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.stg_shops' was properly closed.
12:41:02.176094 [info ] [MainThread]: 
12:41:02.179552 [info ] [MainThread]: [32mCompleted successfully[0m
12:41:02.183378 [info ] [MainThread]: 
12:41:02.184072 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
12:41:02.185559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738988947df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7389883228b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738988322970>]}


============================== 2025-08-02 12:41:22.156078 | 4f092f83-b7bc-4949-bfd4-78a3accfc4a1 ==============================
12:41:22.156078 [info ] [MainThread]: Running with dbt=1.0.0
12:41:22.156836 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['staging'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
12:41:22.159504 [debug] [MainThread]: Tracking: tracking
12:41:22.163568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b50faac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b50faa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b50faa00>]}
12:41:22.285691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:41:22.286400 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:41:22.291753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f092f83-b7bc-4949-bfd4-78a3accfc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b3fe30d0>]}
12:41:22.311332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f092f83-b7bc-4949-bfd4-78a3accfc4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b50abd90>]}
12:41:22.312232 [info ] [MainThread]: Found 6 models, 15 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:41:22.314631 [info ] [MainThread]: 
12:41:22.315869 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:41:22.317421 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:41:22.327904 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:41:22.328828 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:41:22.329559 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:41:23.253932 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.92 seconds
12:41:23.258282 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:41:23.329877 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:41:23.332413 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:41:23.333170 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:41:23.333728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:41:24.006553 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19b9-0001-63bc-0001-5712000393e6
12:41:24.007429 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:41:24.008112 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:41:24.008944 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:41:24.009514 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:41:24.073701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:41:24.074565 [info ] [MainThread]: 
12:41:24.086385 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:41:24.087221 [info ] [Thread-1  ]: 1 of 15 START test not_null_stg_item_categories_item_category_id................ [RUN]
12:41:24.088121 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:41:24.088800 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:41:24.089367 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:41:24.096790 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:41:24.107416 [debug] [Thread-1  ]: finished collecting timing info
12:41:24.108396 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:41:24.119013 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:41:24.129846 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:41:24.130445 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_item_categories
where item_category_id is null



      
    ) dbt_internal_test
12:41:24.130945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:25.178953 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
12:41:25.185388 [debug] [Thread-1  ]: finished collecting timing info
12:41:25.185897 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: Close
12:41:25.260600 [info ] [Thread-1  ]: 1 of 15 PASS not_null_stg_item_categories_item_category_id...................... [[32mPASS[0m in 1.17s]
12:41:25.264643 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:41:25.268226 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:41:25.270637 [info ] [Thread-1  ]: 2 of 15 START test not_null_stg_item_categories_item_category_name.............. [RUN]
12:41:25.272238 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:41:25.273419 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:41:25.274053 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:41:25.279580 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:41:25.288288 [debug] [Thread-1  ]: finished collecting timing info
12:41:25.291216 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:41:25.295354 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:41:25.304803 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:41:25.305797 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_item_categories
where item_category_name is null



      
    ) dbt_internal_test
12:41:25.306390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:25.874406 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
12:41:25.880409 [debug] [Thread-1  ]: finished collecting timing info
12:41:25.881089 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: Close
12:41:25.951681 [info ] [Thread-1  ]: 2 of 15 PASS not_null_stg_item_categories_item_category_name.................... [[32mPASS[0m in 0.68s]
12:41:25.953483 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:41:25.954544 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:41:25.955916 [info ] [Thread-1  ]: 3 of 15 START test not_null_stg_items_item_id................................... [RUN]
12:41:25.956784 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:41:25.957894 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:41:25.960494 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:41:25.967955 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:41:25.979053 [debug] [Thread-1  ]: finished collecting timing info
12:41:25.979627 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:41:25.981758 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:41:25.994216 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:41:25.994792 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_items
where item_id is null



      
    ) dbt_internal_test
12:41:25.995526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:26.589818 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
12:41:26.591749 [debug] [Thread-1  ]: finished collecting timing info
12:41:26.592850 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: Close
12:41:26.658093 [info ] [Thread-1  ]: 3 of 15 PASS not_null_stg_items_item_id......................................... [[32mPASS[0m in 0.70s]
12:41:26.658980 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:41:26.659679 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:41:26.660388 [info ] [Thread-1  ]: 4 of 15 START test not_null_stg_items_item_name................................. [RUN]
12:41:26.661217 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:41:26.661870 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:41:26.662427 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:41:26.665076 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:41:26.672509 [debug] [Thread-1  ]: finished collecting timing info
12:41:26.673705 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:41:26.675790 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:41:26.690938 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:41:26.694733 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_items
where item_name is null



      
    ) dbt_internal_test
12:41:26.695715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:27.449657 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.75 seconds
12:41:27.451655 [debug] [Thread-1  ]: finished collecting timing info
12:41:27.452451 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: Close
12:41:27.522370 [info ] [Thread-1  ]: 4 of 15 PASS not_null_stg_items_item_name....................................... [[32mPASS[0m in 0.86s]
12:41:27.523148 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:41:27.523754 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
12:41:27.524323 [info ] [Thread-1  ]: 5 of 15 START test not_null_stg_sales_train_date................................ [RUN]
12:41:27.525156 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
12:41:27.525616 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
12:41:27.526369 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
12:41:27.529354 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
12:41:27.542128 [debug] [Thread-1  ]: finished collecting timing info
12:41:27.544130 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
12:41:27.547674 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
12:41:27.564748 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
12:41:27.568955 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_sales_train
where date is null



      
    ) dbt_internal_test
12:41:27.572991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:28.161658 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
12:41:28.165746 [debug] [Thread-1  ]: finished collecting timing info
12:41:28.166470 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9: Close
12:41:28.240933 [info ] [Thread-1  ]: 5 of 15 PASS not_null_stg_sales_train_date...................................... [[32mPASS[0m in 0.72s]
12:41:28.241839 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
12:41:28.242407 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
12:41:28.242961 [info ] [Thread-1  ]: 6 of 15 START test not_null_stg_sales_train_date_block_num...................... [RUN]
12:41:28.243646 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
12:41:28.244146 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
12:41:28.244587 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
12:41:28.247270 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
12:41:28.257083 [debug] [Thread-1  ]: finished collecting timing info
12:41:28.261237 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
12:41:28.264552 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
12:41:28.273724 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
12:41:28.274425 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_sales_train
where date_block_num is null



      
    ) dbt_internal_test
12:41:28.274917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:28.823700 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
12:41:28.825497 [debug] [Thread-1  ]: finished collecting timing info
12:41:28.826197 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d: Close
12:41:28.900536 [info ] [Thread-1  ]: 6 of 15 PASS not_null_stg_sales_train_date_block_num............................ [[32mPASS[0m in 0.66s]
12:41:28.902766 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
12:41:28.903434 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
12:41:28.903938 [info ] [Thread-1  ]: 7 of 15 START test not_null_stg_sales_train_item_cnt_day........................ [RUN]
12:41:28.904627 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
12:41:28.905097 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
12:41:28.905509 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
12:41:28.907834 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
12:41:28.919458 [debug] [Thread-1  ]: finished collecting timing info
12:41:28.921401 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
12:41:28.924776 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
12:41:28.963329 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
12:41:28.964462 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_sales_train
where item_cnt_day is null



      
    ) dbt_internal_test
12:41:28.968323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:29.504238 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.54 seconds
12:41:29.510758 [debug] [Thread-1  ]: finished collecting timing info
12:41:29.511473 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7: Close
12:41:29.576741 [info ] [Thread-1  ]: 7 of 15 PASS not_null_stg_sales_train_item_cnt_day.............................. [[32mPASS[0m in 0.67s]
12:41:29.580571 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
12:41:29.581293 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
12:41:29.582030 [info ] [Thread-1  ]: 8 of 15 START test not_null_stg_sales_train_item_id............................. [RUN]
12:41:29.582748 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
12:41:29.583189 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
12:41:29.583580 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
12:41:29.586261 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
12:41:29.606138 [debug] [Thread-1  ]: finished collecting timing info
12:41:29.606877 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
12:41:29.611678 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
12:41:29.633364 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
12:41:29.635644 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_sales_train
where item_id is null



      
    ) dbt_internal_test
12:41:29.636113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:30.203578 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
12:41:30.208734 [debug] [Thread-1  ]: finished collecting timing info
12:41:30.209606 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8: Close
12:41:30.270402 [info ] [Thread-1  ]: 8 of 15 PASS not_null_stg_sales_train_item_id................................... [[32mPASS[0m in 0.69s]
12:41:30.271217 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
12:41:30.277380 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
12:41:30.279327 [info ] [Thread-1  ]: 9 of 15 START test not_null_stg_sales_train_item_price.......................... [RUN]
12:41:30.283634 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
12:41:30.286193 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
12:41:30.291460 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
12:41:30.294443 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
12:41:30.312880 [debug] [Thread-1  ]: finished collecting timing info
12:41:30.317083 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
12:41:30.322298 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
12:41:30.335078 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
12:41:30.338341 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_sales_train
where item_price is null



      
    ) dbt_internal_test
12:41:30.340081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:30.895113 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
12:41:30.897450 [debug] [Thread-1  ]: finished collecting timing info
12:41:30.898270 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da: Close
12:41:30.961385 [info ] [Thread-1  ]: 9 of 15 PASS not_null_stg_sales_train_item_price................................ [[32mPASS[0m in 0.68s]
12:41:30.963328 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
12:41:30.964404 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
12:41:30.965142 [info ] [Thread-1  ]: 10 of 15 START test not_null_stg_sales_train_shop_id............................ [RUN]
12:41:30.966241 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
12:41:30.968394 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
12:41:30.969052 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
12:41:30.971849 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
12:41:30.980956 [debug] [Thread-1  ]: finished collecting timing info
12:41:30.981832 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
12:41:30.983685 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
12:41:30.993912 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
12:41:30.994710 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_sales_train
where shop_id is null



      
    ) dbt_internal_test
12:41:30.995230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:31.586696 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
12:41:31.588218 [debug] [Thread-1  ]: finished collecting timing info
12:41:31.588809 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831: Close
12:41:31.654082 [info ] [Thread-1  ]: 10 of 15 PASS not_null_stg_sales_train_shop_id.................................. [[32mPASS[0m in 0.69s]
12:41:31.657083 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
12:41:31.658300 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:41:31.662033 [info ] [Thread-1  ]: 11 of 15 START test not_null_stg_shops_shop_id.................................. [RUN]
12:41:31.662688 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:41:31.663360 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:41:31.663972 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:41:31.666354 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:41:31.704479 [debug] [Thread-1  ]: finished collecting timing info
12:41:31.708290 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:41:31.713470 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:41:31.729741 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:41:31.731614 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_shops
where shop_id is null



      
    ) dbt_internal_test
12:41:31.732729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:32.381328 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
12:41:32.383957 [debug] [Thread-1  ]: finished collecting timing info
12:41:32.385598 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: Close
12:41:32.456752 [info ] [Thread-1  ]: 11 of 15 PASS not_null_stg_shops_shop_id........................................ [[32mPASS[0m in 0.79s]
12:41:32.457816 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:41:32.458756 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:41:32.459606 [info ] [Thread-1  ]: 12 of 15 START test not_null_stg_shops_shop_name................................ [RUN]
12:41:32.460611 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:41:32.461232 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:41:32.461745 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:41:32.464359 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:41:32.472492 [debug] [Thread-1  ]: finished collecting timing info
12:41:32.473606 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:41:32.475482 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:41:32.482039 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:41:32.483259 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_shops
where shop_name is null



      
    ) dbt_internal_test
12:41:32.483877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:33.167743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
12:41:33.169415 [debug] [Thread-1  ]: finished collecting timing info
12:41:33.169930 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: Close
12:41:33.236123 [info ] [Thread-1  ]: 12 of 15 PASS not_null_stg_shops_shop_name...................................... [[32mPASS[0m in 0.78s]
12:41:33.242760 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:41:33.244479 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:41:33.248890 [info ] [Thread-1  ]: 13 of 15 START test unique_stg_item_categories_item_category_id................. [RUN]
12:41:33.255238 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:41:33.256153 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:41:33.256922 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:41:33.289075 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:41:33.307526 [debug] [Thread-1  ]: finished collecting timing info
12:41:33.309795 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:41:33.313025 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:41:33.370954 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:41:33.373550 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_category_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.STAGING_staging.stg_item_categories
where item_category_id is not null
group by item_category_id
having count(*) > 1



      
    ) dbt_internal_test
12:41:33.376838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:34.027207 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
12:41:34.028847 [debug] [Thread-1  ]: finished collecting timing info
12:41:34.029317 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: Close
12:41:34.093455 [info ] [Thread-1  ]: 13 of 15 PASS unique_stg_item_categories_item_category_id....................... [[32mPASS[0m in 0.84s]
12:41:34.098908 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:41:34.101319 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:41:34.103829 [info ] [Thread-1  ]: 14 of 15 START test unique_stg_items_item_id.................................... [RUN]
12:41:34.106723 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:41:34.114114 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:41:34.117178 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:41:34.120602 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:41:34.130529 [debug] [Thread-1  ]: finished collecting timing info
12:41:34.134556 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:41:34.137493 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:41:34.158279 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:41:34.161841 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.STAGING_staging.stg_items
where item_id is not null
group by item_id
having count(*) > 1



      
    ) dbt_internal_test
12:41:34.164867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:34.989579 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
12:41:34.991228 [debug] [Thread-1  ]: finished collecting timing info
12:41:34.992027 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: Close
12:41:35.057319 [info ] [Thread-1  ]: 14 of 15 PASS unique_stg_items_item_id.......................................... [[32mPASS[0m in 0.95s]
12:41:35.058225 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:41:35.059105 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:41:35.063837 [info ] [Thread-1  ]: 15 of 15 START test unique_stg_shops_shop_id.................................... [RUN]
12:41:35.064962 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:41:35.067388 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:41:35.072525 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:41:35.083059 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:41:35.089812 [debug] [Thread-1  ]: finished collecting timing info
12:41:35.090395 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:41:35.092091 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:41:35.099446 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:41:35.103529 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    shop_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.STAGING_staging.stg_shops
where shop_id is not null
group by shop_id
having count(*) > 1



      
    ) dbt_internal_test
12:41:35.107108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:41:35.760556 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
12:41:35.768886 [debug] [Thread-1  ]: finished collecting timing info
12:41:35.770121 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: Close
12:41:35.842068 [info ] [Thread-1  ]: 15 of 15 PASS unique_stg_shops_shop_id.......................................... [[32mPASS[0m in 0.78s]
12:41:35.852358 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:41:35.855975 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:41:35.858795 [info ] [MainThread]: 
12:41:35.863263 [info ] [MainThread]: Finished running 15 tests in 13.54s.
12:41:35.868815 [debug] [MainThread]: Connection 'master' was properly closed.
12:41:35.870438 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3' was properly closed.
12:41:35.914840 [info ] [MainThread]: 
12:41:35.919023 [info ] [MainThread]: [32mCompleted successfully[0m
12:41:35.925367 [info ] [MainThread]: 
12:41:35.927325 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 TOTAL=15
12:41:35.929908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b3078d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b30780d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3b2b54910>]}


============================== 2025-08-02 12:48:48.377332 | 97718412-548a-49c5-b97e-68c3ba21513e ==============================
12:48:48.377332 [info ] [MainThread]: Running with dbt=1.0.0
12:48:48.379356 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_items'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:48:48.380150 [debug] [MainThread]: Tracking: tracking
12:48:48.380863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae7e837ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae7e837a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae7e837a00>]}
12:48:48.512124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:48:48.513303 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_items.sql
12:48:48.522625 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
12:48:48.561514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97718412-548a-49c5-b97e-68c3ba21513e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae7c0adf10>]}
12:48:48.575602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97718412-548a-49c5-b97e-68c3ba21513e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae7e869d60>]}
12:48:48.576315 [info ] [MainThread]: Found 6 models, 15 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:48:48.578068 [info ] [MainThread]: 
12:48:48.579200 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:48:48.580506 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:48:48.589257 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:48:48.590027 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:48:48.590505 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:48:53.789668 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.2 seconds
12:48:53.795334 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:48:53.867157 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:48:53.872536 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:48:53.873216 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:48:53.873755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:48:54.369090 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19c0-0001-63bc-0001-57120003941a
12:48:54.374515 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:48:54.375704 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:48:54.382612 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:48:54.388523 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:48:54.459977 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:48:54.462538 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:48:54.467500 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:48:54.470562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:48:54.975411 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.5 seconds
12:48:54.977361 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:48:55.040455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:48:55.046658 [info ] [MainThread]: 
12:48:55.066545 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_items
12:48:55.067946 [info ] [Thread-1  ]: 1 of 1 START view model STAGING_staging.stg_items............................... [RUN]
12:48:55.073925 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_items"
12:48:55.079183 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_items
12:48:55.082972 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_items
12:48:55.092264 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_items"
12:48:55.141702 [debug] [Thread-1  ]: finished collecting timing info
12:48:55.144322 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_items
12:48:55.161149 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_items"
12:48:55.214089 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_items"
12:48:55.215660 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_items"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_items 
  
   as (
    -- models/staging/stg_items.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.items
),

renamed as (
    select
        item_id::int as item_id,
        item_name::string as item_name,
        item_category_id::int as item_category_id
    from source
)

select * from renamed
  );
12:48:55.218568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:48:56.022687 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.8 seconds
12:48:56.031584 [debug] [Thread-1  ]: finished collecting timing info
12:48:56.037180 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: Close
12:48:56.101312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97718412-548a-49c5-b97e-68c3ba21513e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae4e22d280>]}
12:48:56.107180 [info ] [Thread-1  ]: 1 of 1 OK created view model STAGING_staging.stg_items.......................... [[32mSUCCESS 1[0m in 1.03s]
12:48:56.113481 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_items
12:48:56.115494 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:48:56.117914 [info ] [MainThread]: 
12:48:56.122633 [info ] [MainThread]: Finished running 1 view model in 7.54s.
12:48:56.125197 [debug] [MainThread]: Connection 'master' was properly closed.
12:48:56.129622 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.stg_items' was properly closed.
12:48:56.166364 [info ] [MainThread]: 
12:48:56.169028 [info ] [MainThread]: [32mCompleted successfully[0m
12:48:56.169979 [info ] [MainThread]: 
12:48:56.170835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
12:48:56.173462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae7e86fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae4e85ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aae7d726130>]}


============================== 2025-08-02 12:49:05.433027 | 41673b47-f758-4f67-b93b-e4756097cd22 ==============================
12:49:05.433027 [info ] [MainThread]: Running with dbt=1.0.0
12:49:05.435373 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_items'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
12:49:05.436158 [debug] [MainThread]: Tracking: tracking
12:49:05.436797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee79942ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee79942a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee79942a00>]}
12:49:05.554567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:49:05.555130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:49:05.560346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41673b47-f758-4f67-b93b-e4756097cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee798540d0>]}
12:49:05.574693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41673b47-f758-4f67-b93b-e4756097cd22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee798efdc0>]}
12:49:05.576010 [info ] [MainThread]: Found 6 models, 15 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:49:05.577697 [info ] [MainThread]: 
12:49:05.578485 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:49:05.580017 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:49:05.589889 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:49:05.590662 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:49:05.591264 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:49:06.569684 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19c1-0001-63bc-0001-571200039426
12:49:06.574539 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:49:06.580785 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:49:06.581214 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:49:06.581705 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:49:06.649180 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:49:06.653183 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:49:06.655722 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:49:06.659178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:49:07.169409 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.51 seconds
12:49:07.176055 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:49:07.244947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:49:07.246338 [info ] [MainThread]: 
12:49:07.262081 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:49:07.263766 [info ] [Thread-1  ]: 1 of 3 START test not_null_stg_items_item_id.................................... [RUN]
12:49:07.267902 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:49:07.283820 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:49:07.287184 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:49:07.297779 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:49:07.308676 [debug] [Thread-1  ]: finished collecting timing info
12:49:07.310985 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:49:07.324473 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:49:07.332175 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
12:49:07.333861 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_items
where item_id is null



      
    ) dbt_internal_test
12:49:07.334706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:49:08.089271 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.75 seconds
12:49:08.098889 [debug] [Thread-1  ]: finished collecting timing info
12:49:08.100946 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: Close
12:49:08.166936 [info ] [Thread-1  ]: 1 of 3 PASS not_null_stg_items_item_id.......................................... [[32mPASS[0m in 0.90s]
12:49:08.169818 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
12:49:08.170671 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:49:08.171478 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_items_item_name.................................. [RUN]
12:49:08.172265 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:49:08.173045 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:49:08.173541 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:49:08.176331 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:49:08.184997 [debug] [Thread-1  ]: finished collecting timing info
12:49:08.186108 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:49:08.187529 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:49:08.226357 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
12:49:08.226977 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_items
where item_name is null



      
    ) dbt_internal_test
12:49:08.228047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:49:08.820918 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
12:49:08.824703 [debug] [Thread-1  ]: finished collecting timing info
12:49:08.828281 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: Close
12:49:08.894777 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_items_item_name........................................ [[32mPASS[0m in 0.72s]
12:49:08.897689 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
12:49:08.898557 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:49:08.900697 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_items_item_id...................................... [RUN]
12:49:08.901965 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:49:08.904058 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:49:08.906642 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:49:08.912359 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:49:08.947535 [debug] [Thread-1  ]: finished collecting timing info
12:49:08.948936 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:49:08.950551 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:49:08.971357 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
12:49:08.973766 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.STAGING_staging.stg_items
where item_id is not null
group by item_id
having count(*) > 1



      
    ) dbt_internal_test
12:49:08.976876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:49:09.582964 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
12:49:09.586521 [debug] [Thread-1  ]: finished collecting timing info
12:49:09.589352 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: Close
12:49:09.656283 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_items_item_id............................................ [[32mPASS[0m in 0.75s]
12:49:09.658637 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
12:49:09.660635 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:49:09.663554 [info ] [MainThread]: 
12:49:09.667361 [info ] [MainThread]: Finished running 3 tests in 4.09s.
12:49:09.669301 [debug] [MainThread]: Connection 'master' was properly closed.
12:49:09.670136 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757' was properly closed.
12:49:09.701451 [info ] [MainThread]: 
12:49:09.702569 [info ] [MainThread]: [32mCompleted successfully[0m
12:49:09.705847 [info ] [MainThread]: 
12:49:09.707412 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
12:49:09.710191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee78169070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee78169040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cee71aeeca0>]}


============================== 2025-08-02 12:50:50.859414 | 5fa42856-4bbc-4d12-aa21-bb385a8b3c7f ==============================
12:50:50.859414 [info ] [MainThread]: Running with dbt=1.0.0
12:50:50.863310 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_item_categories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:50:50.864420 [debug] [MainThread]: Tracking: tracking
12:50:50.865073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7372a314dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7372a314da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7372a314da00>]}
12:50:51.142050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:50:51.142895 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_item_categories.sql
12:50:51.151907 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
12:50:51.190750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa42856-4bbc-4d12-aa21-bb385a8b3c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7372a0fe8f10>]}
12:50:51.228792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa42856-4bbc-4d12-aa21-bb385a8b3c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7372a317f1f0>]}
12:50:51.231054 [info ] [MainThread]: Found 6 models, 15 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:50:51.236502 [info ] [MainThread]: 
12:50:51.242006 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:50:51.244541 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:50:51.256619 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:50:51.257208 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:50:51.257619 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:50:52.336426 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.08 seconds
12:50:52.338639 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:50:52.401643 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:50:52.406485 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:50:52.407284 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:50:52.408035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:50:53.050489 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.64 seconds
12:50:53.052737 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:50:53.119671 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:50:53.121526 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:50:53.122780 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:50:53.123438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:50:53.646605 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19c2-0001-63bb-0001-57120003844a
12:50:53.650542 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:50:53.653256 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:50:53.653886 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:50:53.654416 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:50:53.723553 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:50:53.724382 [info ] [MainThread]: 
12:50:53.736441 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_item_categories
12:50:53.742336 [info ] [Thread-1  ]: 1 of 1 START view model STAGING_staging.stg_item_categories..................... [RUN]
12:50:53.746729 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
12:50:53.750955 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_item_categories
12:50:53.752554 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_item_categories
12:50:53.755703 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_item_categories"
12:50:53.766414 [debug] [Thread-1  ]: finished collecting timing info
12:50:53.769377 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_item_categories
12:50:53.792543 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_item_categories"
12:50:53.809057 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
12:50:53.812946 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_item_categories"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_item_categories 
  
   as (
    -- models/staging/stg_item_categories.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.item_categories
),

renamed as (
    select
        item_category_id::int as item_category_id,
        item_category_name::string as item_category_name
    from source
)

select * from renamed
  );
12:50:53.815180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:50:54.425773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
12:50:54.430531 [debug] [Thread-1  ]: finished collecting timing info
12:50:54.431442 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: Close
12:50:54.497646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fa42856-4bbc-4d12-aa21-bb385a8b3c7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7372a0037400>]}
12:50:54.498555 [info ] [Thread-1  ]: 1 of 1 OK created view model STAGING_staging.stg_item_categories................ [[32mSUCCESS 1[0m in 0.75s]
12:50:54.499199 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_item_categories
12:50:54.500863 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:50:54.501570 [info ] [MainThread]: 
12:50:54.502150 [info ] [MainThread]: Finished running 1 view model in 3.26s.
12:50:54.504090 [debug] [MainThread]: Connection 'master' was properly closed.
12:50:54.504835 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.stg_item_categories' was properly closed.
12:50:54.524737 [info ] [MainThread]: 
12:50:54.525773 [info ] [MainThread]: [32mCompleted successfully[0m
12:50:54.527889 [info ] [MainThread]: 
12:50:54.529955 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
12:50:54.531178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73725bb36730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7372a019eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73725bb0ba60>]}


============================== 2025-08-02 12:51:04.488090 | 5e212478-0db2-4873-aea8-8216e89721b8 ==============================
12:51:04.488090 [info ] [MainThread]: Running with dbt=1.0.0
12:51:04.488768 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_item_categories'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
12:51:04.489362 [debug] [MainThread]: Tracking: tracking
12:51:04.490239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b78d7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b78d7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b78d7a30>]}
12:51:04.599505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
12:51:04.600059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
12:51:04.605393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e212478-0db2-4873-aea8-8216e89721b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b67e50d0>]}
12:51:04.626153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e212478-0db2-4873-aea8-8216e89721b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b7886df0>]}
12:51:04.627052 [info ] [MainThread]: Found 6 models, 15 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:51:04.630816 [info ] [MainThread]: 
12:51:04.633620 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:51:04.639417 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:51:04.648504 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:51:04.649185 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:51:04.649683 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:51:07.614178 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.96 seconds
12:51:07.616028 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:51:07.680494 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:51:07.683190 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:51:07.685051 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:51:07.685577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:51:08.363444 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19c3-0001-63bb-0001-57120003844e
12:51:08.368325 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:51:08.369376 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:51:08.370266 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:51:08.370980 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:51:08.438825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:51:08.442332 [info ] [MainThread]: 
12:51:08.454859 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:51:08.456176 [info ] [Thread-1  ]: 1 of 3 START test not_null_stg_item_categories_item_category_id................. [RUN]
12:51:08.456934 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:51:08.463162 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:51:08.469033 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:51:08.481806 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:51:08.497307 [debug] [Thread-1  ]: finished collecting timing info
12:51:08.499705 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:51:08.511216 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:51:08.522309 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
12:51:08.523016 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_item_categories
where item_category_id is null



      
    ) dbt_internal_test
12:51:08.523689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:51:09.115785 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
12:51:09.122250 [debug] [Thread-1  ]: finished collecting timing info
12:51:09.122986 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: Close
12:51:09.195563 [info ] [Thread-1  ]: 1 of 3 PASS not_null_stg_item_categories_item_category_id....................... [[32mPASS[0m in 0.74s]
12:51:09.196516 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
12:51:09.197485 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:51:09.198176 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_item_categories_item_category_name............... [RUN]
12:51:09.198907 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:51:09.199383 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:51:09.199912 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:51:09.202658 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:51:09.210616 [debug] [Thread-1  ]: finished collecting timing info
12:51:09.213901 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:51:09.221295 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:51:09.273139 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
12:51:09.275869 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_item_categories
where item_category_name is null



      
    ) dbt_internal_test
12:51:09.278857 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:51:09.858873 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
12:51:09.860990 [debug] [Thread-1  ]: finished collecting timing info
12:51:09.861983 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: Close
12:51:09.923644 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_item_categories_item_category_name..................... [[32mPASS[0m in 0.72s]
12:51:09.924492 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
12:51:09.925763 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:51:09.929992 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_item_categories_item_category_id................... [RUN]
12:51:09.934692 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:51:09.935450 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:51:09.936017 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:51:09.940458 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:51:09.951264 [debug] [Thread-1  ]: finished collecting timing info
12:51:09.952471 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:51:09.954549 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:51:10.012391 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
12:51:10.015032 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_category_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.STAGING_staging.stg_item_categories
where item_category_id is not null
group by item_category_id
having count(*) > 1



      
    ) dbt_internal_test
12:51:10.018856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:51:10.594204 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
12:51:10.596892 [debug] [Thread-1  ]: finished collecting timing info
12:51:10.601617 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: Close
12:51:10.664271 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_item_categories_item_category_id......................... [[32mPASS[0m in 0.73s]
12:51:10.673365 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
12:51:10.675805 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:51:10.678831 [info ] [MainThread]: 
12:51:10.679746 [info ] [MainThread]: Finished running 3 tests in 6.05s.
12:51:10.680744 [debug] [MainThread]: Connection 'master' was properly closed.
12:51:10.683478 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96' was properly closed.
12:51:10.724988 [info ] [MainThread]: 
12:51:10.728220 [info ] [MainThread]: [32mCompleted successfully[0m
12:51:10.731451 [info ] [MainThread]: 
12:51:10.736193 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
12:51:10.737256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b7838ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b7838fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e17b53eca30>]}


============================== 2025-08-02 12:53:23.592449 | ba732438-9526-4768-8e77-30fd181e406a ==============================
12:53:23.592449 [info ] [MainThread]: Running with dbt=1.0.0
12:53:23.593193 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['stg_shops'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
12:53:23.593889 [debug] [MainThread]: Tracking: tracking
12:53:23.594618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e44141af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e44141a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e44141a30>]}
12:53:23.797202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:53:23.797943 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_shops.sql
12:53:23.805954 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
12:53:23.839785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba732438-9526-4768-8e77-30fd181e406a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e40fa8f10>]}
12:53:23.873050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba732438-9526-4768-8e77-30fd181e406a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e440f1d90>]}
12:53:23.873778 [info ] [MainThread]: Found 6 models, 15 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:53:23.877984 [info ] [MainThread]: 
12:53:23.879169 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:53:23.882964 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:53:23.893905 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:53:23.899359 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:53:23.900613 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:53:25.110094 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.21 seconds
12:53:25.112730 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:53:25.187796 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:53:25.198345 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:53:25.200508 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:53:25.202484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:53:25.922546 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be19c5-0001-63bc-0001-571200039442
12:53:25.926148 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:53:25.933894 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:53:25.938264 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:53:25.941061 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:53:26.032054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:53:26.037784 [info ] [MainThread]: 
12:53:26.065935 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:53:26.067006 [info ] [Thread-1  ]: 1 of 3 START test not_null_stg_shops_shop_id.................................... [RUN]
12:53:26.067891 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:53:26.068647 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:53:26.069536 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:53:26.076761 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:53:26.084284 [debug] [Thread-1  ]: finished collecting timing info
12:53:26.084842 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:53:26.095633 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:53:26.103024 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
12:53:26.103726 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_shops
where shop_id is null



      
    ) dbt_internal_test
12:53:26.104308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:53:26.856758 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.75 seconds
12:53:26.874034 [debug] [Thread-1  ]: finished collecting timing info
12:53:26.880398 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: Close
12:53:26.954268 [info ] [Thread-1  ]: 1 of 3 PASS not_null_stg_shops_shop_id.......................................... [[32mPASS[0m in 0.89s]
12:53:26.960473 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
12:53:26.961811 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:53:26.964612 [info ] [Thread-1  ]: 2 of 3 START test not_null_stg_shops_shop_name.................................. [RUN]
12:53:26.975323 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:53:26.980476 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:53:26.982082 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:53:26.990789 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:53:27.041800 [debug] [Thread-1  ]: finished collecting timing info
12:53:27.043954 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:53:27.049570 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:53:27.092349 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
12:53:27.093868 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_staging.stg_shops
where shop_name is null



      
    ) dbt_internal_test
12:53:27.094237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:53:27.684866 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
12:53:27.694860 [debug] [Thread-1  ]: finished collecting timing info
12:53:27.697950 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: Close
12:53:27.775923 [info ] [Thread-1  ]: 2 of 3 PASS not_null_stg_shops_shop_name........................................ [[32mPASS[0m in 0.80s]
12:53:27.780181 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
12:53:27.783930 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:53:27.789485 [info ] [Thread-1  ]: 3 of 3 START test unique_stg_shops_shop_id...................................... [RUN]
12:53:27.794127 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:53:27.801605 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:53:27.807537 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:53:27.817456 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:53:27.883649 [debug] [Thread-1  ]: finished collecting timing info
12:53:27.889654 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:53:27.896523 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:53:27.952117 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
12:53:27.956670 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    shop_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.STAGING_staging.stg_shops
where shop_id is not null
group by shop_id
having count(*) > 1



      
    ) dbt_internal_test
12:53:27.962027 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:53:28.491593 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
12:53:28.493584 [debug] [Thread-1  ]: finished collecting timing info
12:53:28.497889 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: Close
12:53:28.564856 [info ] [Thread-1  ]: 3 of 3 PASS unique_stg_shops_shop_id............................................ [[32mPASS[0m in 0.77s]
12:53:28.568950 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
12:53:28.573888 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:53:28.578945 [info ] [MainThread]: 
12:53:28.584718 [info ] [MainThread]: Finished running 3 tests in 4.70s.
12:53:28.587434 [debug] [MainThread]: Connection 'master' was properly closed.
12:53:28.589994 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3' was properly closed.
12:53:28.635295 [info ] [MainThread]: 
12:53:28.638396 [info ] [MainThread]: [32mCompleted successfully[0m
12:53:28.639936 [info ] [MainThread]: 
12:53:28.643803 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
12:53:28.644877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e440a3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e49dcc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e401b38b0>]}


============================== 2025-08-02 13:00:08.534980 | 387743ff-a6bd-46a2-8eba-3ee26a4bbedc ==============================
13:00:08.534980 [info ] [MainThread]: Running with dbt=1.0.0
13:00:08.535664 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_daily_sales'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:00:08.538951 [debug] [MainThread]: Tracking: tracking
13:00:08.542734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a632ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a632a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a632a00>]}
13:00:08.713311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
13:00:08.714503 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/schema.yml
13:00:08.715086 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_daily_sales.sql
13:00:08.723769 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
13:00:08.766799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '387743ff-a6bd-46a2-8eba-3ee26a4bbedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f180ceaf0>]}
13:00:08.791481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '387743ff-a6bd-46a2-8eba-3ee26a4bbedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1956bac0>]}
13:00:08.794717 [info ] [MainThread]: Found 7 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:00:08.796823 [info ] [MainThread]: 
13:00:08.797981 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:00:08.799296 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:00:08.808123 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:00:08.812386 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:00:08.813058 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:00:09.833729 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.02 seconds
13:00:09.845210 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:00:09.918780 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_STAGING_marts"
13:00:09.919727 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_STAGING_marts"
13:00:09.920408 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='sales_pipeline', schema='staging_marts', identifier=None)"
13:00:09.924297 [debug] [ThreadPool]: Using snowflake connection "create_SALES_PIPELINE_STAGING_marts"
13:00:09.926386 [debug] [ThreadPool]: On create_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "create_SALES_PIPELINE_STAGING_marts"} */
create schema if not exists SALES_PIPELINE.STAGING_marts
13:00:09.932339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:00:10.603028 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.67 seconds
13:00:10.604491 [debug] [ThreadPool]: On create_SALES_PIPELINE_STAGING_marts: Close
13:00:10.670781 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:00:10.679682 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:00:10.684112 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:00:10.688632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:00:11.200599 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.51 seconds
13:00:11.207450 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:00:11.276449 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:00:11.278022 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:00:11.278439 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:00:11.278786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:00:11.808024 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.53 seconds
13:00:11.812830 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:00:11.878989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:00:11.890650 [info ] [MainThread]: 
13:00:11.903512 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
13:00:11.904262 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_daily_sales......................... [RUN]
13:00:11.905649 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
13:00:11.906884 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
13:00:11.909266 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
13:00:11.916072 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
13:00:11.959453 [debug] [Thread-1  ]: finished collecting timing info
13:00:11.962186 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
13:00:11.989492 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
13:00:12.002614 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
13:00:12.003366 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
13:00:12.003990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:00:15.386010 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.38 seconds
13:00:15.392213 [debug] [Thread-1  ]: finished collecting timing info
13:00:15.392791 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
13:00:15.463541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387743ff-a6bd-46a2-8eba-3ee26a4bbedc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ef21110d0>]}
13:00:15.464481 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 3.56s]
13:00:15.465172 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
13:00:15.468594 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:00:15.471088 [info ] [MainThread]: 
13:00:15.472923 [info ] [MainThread]: Finished running 1 table model in 6.67s.
13:00:15.475618 [debug] [MainThread]: Connection 'master' was properly closed.
13:00:15.478239 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_daily_sales' was properly closed.
13:00:15.504923 [info ] [MainThread]: 
13:00:15.510316 [info ] [MainThread]: [32mCompleted successfully[0m
13:00:15.514789 [info ] [MainThread]: 
13:00:15.520267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
13:00:15.523753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ef2563cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f180cef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5f1a66ecd0>]}


============================== 2025-08-02 13:00:26.188089 | 98c7d088-6818-44e3-84c5-f939d7f3abc4 ==============================
13:00:26.188089 [info ] [MainThread]: Running with dbt=1.0.0
13:00:26.192288 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['mart_daily_sales'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
13:00:26.194562 [debug] [MainThread]: Tracking: tracking
13:00:26.202289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06b80fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06b80fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06b80f9d0>]}
13:00:26.336176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:00:26.336816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:00:26.341814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98c7d088-6818-44e3-84c5-f939d7f3abc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06a72d0d0>]}
13:00:26.362795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98c7d088-6818-44e3-84c5-f939d7f3abc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06a7c2970>]}
13:00:26.366188 [info ] [MainThread]: Found 7 models, 18 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:00:26.370220 [info ] [MainThread]: 
13:00:26.375835 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:00:26.377920 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:00:26.386470 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:00:26.387101 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:00:26.387484 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:00:27.391119 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
13:00:27.392906 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:00:27.461409 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:00:27.463687 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:00:27.464276 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:00:27.464687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:00:28.146412 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.68 seconds
13:00:28.148423 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:00:28.217234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:00:28.218076 [info ] [MainThread]: 
13:00:28.230044 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:00:28.230601 [info ] [Thread-1  ]: 1 of 3 START test not_null_mart_daily_sales_date................................ [RUN]
13:00:28.231538 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:00:28.232120 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:00:28.232515 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:00:28.239542 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:00:28.250908 [debug] [Thread-1  ]: finished collecting timing info
13:00:28.253947 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:00:28.266553 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:00:28.277035 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:00:28.282104 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_marts.mart_daily_sales
where date is null



      
    ) dbt_internal_test
13:00:28.282684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:00:28.947826 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
13:00:28.954129 [debug] [Thread-1  ]: finished collecting timing info
13:00:28.954661 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861: Close
13:00:29.023744 [info ] [Thread-1  ]: 1 of 3 PASS not_null_mart_daily_sales_date...................................... [[32mPASS[0m in 0.79s]
13:00:29.024578 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:00:29.025176 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:00:29.025761 [info ] [Thread-1  ]: 2 of 3 START test not_null_mart_daily_sales_item_id............................. [RUN]
13:00:29.026765 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:00:29.030839 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:00:29.036588 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:00:29.039922 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:00:29.093965 [debug] [Thread-1  ]: finished collecting timing info
13:00:29.098111 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:00:29.105952 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:00:29.131002 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:00:29.132184 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_marts.mart_daily_sales
where item_id is null



      
    ) dbt_internal_test
13:00:29.133564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:00:29.706447 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
13:00:29.708347 [debug] [Thread-1  ]: finished collecting timing info
13:00:29.709380 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f: Close
13:00:29.783657 [info ] [Thread-1  ]: 2 of 3 PASS not_null_mart_daily_sales_item_id................................... [[32mPASS[0m in 0.76s]
13:00:29.784441 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:00:29.786134 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:00:29.791941 [info ] [Thread-1  ]: 3 of 3 START test not_null_mart_daily_sales_shop_id............................. [RUN]
13:00:29.796799 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:00:29.800865 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:00:29.804323 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:00:29.810881 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:00:29.821756 [debug] [Thread-1  ]: finished collecting timing info
13:00:29.823790 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:00:29.828298 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:00:29.870908 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:00:29.872890 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_marts.mart_daily_sales
where shop_id is null



      
    ) dbt_internal_test
13:00:29.873463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:00:30.441865 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
13:00:30.444470 [debug] [Thread-1  ]: finished collecting timing info
13:00:30.445463 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50: Close
13:00:30.510176 [info ] [Thread-1  ]: 3 of 3 PASS not_null_mart_daily_sales_shop_id................................... [[32mPASS[0m in 0.71s]
13:00:30.511093 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:00:30.512906 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:00:30.513709 [info ] [MainThread]: 
13:00:30.514511 [info ] [MainThread]: Finished running 3 tests in 4.14s.
13:00:30.515333 [debug] [MainThread]: Connection 'master' was properly closed.
13:00:30.516273 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50' was properly closed.
13:00:30.535183 [info ] [MainThread]: 
13:00:30.540223 [info ] [MainThread]: [32mCompleted successfully[0m
13:00:30.541201 [info ] [MainThread]: 
13:00:30.541977 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
13:00:30.543018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06a7c2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06a7c24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74a06931eb80>]}


============================== 2025-08-02 14:03:45.297709 | 38d3ef79-1106-41c8-af8d-dea524e66719 ==============================
14:03:45.297709 [info ] [MainThread]: Running with dbt=1.0.0
14:03:45.298820 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_monthly_sales'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:03:45.299415 [debug] [MainThread]: Tracking: tracking
14:03:45.300144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7398b8026ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7398b8026a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7398b8026a00>]}
14:03:45.457255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
14:03:45.458066 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_monthly_sales.sql
14:03:45.458685 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/marts/schema.yml
14:03:45.467817 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
14:03:45.527171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38d3ef79-1106-41c8-af8d-dea524e66719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7398b4e72250>]}
14:03:45.551031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38d3ef79-1106-41c8-af8d-dea524e66719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7398b8059190>]}
14:03:45.551961 [info ] [MainThread]: Found 8 models, 21 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:03:45.553685 [info ] [MainThread]: 
14:03:45.554572 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:03:45.556025 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
14:03:45.565176 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
14:03:45.566072 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
14:03:45.566507 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:03:47.021948 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.46 seconds
14:03:47.024214 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
14:03:47.099027 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:03:47.104123 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:03:47.104888 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
14:03:47.105590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:03:47.835257 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.73 seconds
14:03:47.838361 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
14:03:47.904209 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:03:47.906225 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:03:47.907025 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
14:03:47.907962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:03:48.434434 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.53 seconds
14:03:48.436455 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
14:03:48.506038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:03:48.510319 [info ] [MainThread]: 
14:03:48.525194 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
14:03:48.526960 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
14:03:48.530295 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
14:03:48.535560 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
14:03:48.538209 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
14:03:48.541198 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
14:03:48.552281 [debug] [Thread-1  ]: finished collecting timing info
14:03:48.553065 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
14:03:48.568702 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
14:03:48.581208 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
14:03:48.584678 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        date_block_num,
        shop_id,
        item_id,
        SUM(item_price * item_cnt_day) AS monthly_revenue,
        SUM(item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num, shop_id, item_id
)

SELECT *
FROM base
      );
14:03:48.587313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:03:50.798955 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.21 seconds
14:03:50.813023 [debug] [Thread-1  ]: finished collecting timing info
14:03:50.813896 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
14:03:50.879249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38d3ef79-1106-41c8-af8d-dea524e66719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73986fa6ba90>]}
14:03:50.880148 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_monthly_sales.................. [[32mSUCCESS 1[0m in 2.35s]
14:03:50.881023 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
14:03:50.882454 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:03:50.883184 [info ] [MainThread]: 
14:03:50.883664 [info ] [MainThread]: Finished running 1 table model in 5.33s.
14:03:50.884181 [debug] [MainThread]: Connection 'master' was properly closed.
14:03:50.884702 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_monthly_sales' was properly closed.
14:03:50.895574 [info ] [MainThread]: 
14:03:50.896296 [info ] [MainThread]: [32mCompleted successfully[0m
14:03:50.898098 [info ] [MainThread]: 
14:03:50.898967 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:03:50.899990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73986faac220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73986faac850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73986faac130>]}


============================== 2025-08-02 14:03:59.646800 | bf8a3c65-f3f0-4755-9bb9-a68030e3ba5e ==============================
14:03:59.646800 [info ] [MainThread]: Running with dbt=1.0.0
14:03:59.649567 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=['mart_monthly_sales'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
14:03:59.655850 [debug] [MainThread]: Tracking: tracking
14:03:59.659452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f494eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f494ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f494ea30>]}
14:03:59.853870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:03:59.854433 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:03:59.860077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf8a3c65-f3f0-4755-9bb9-a68030e3ba5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f487d0d0>]}
14:03:59.894583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf8a3c65-f3f0-4755-9bb9-a68030e3ba5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f484d460>]}
14:03:59.897897 [info ] [MainThread]: Found 8 models, 21 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:03:59.899568 [info ] [MainThread]: 
14:03:59.900604 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:03:59.902165 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:03:59.913905 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:03:59.916000 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
14:03:59.926110 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:04:02.996468 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.07 seconds
14:04:02.998451 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
14:04:03.066413 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:04:03.068519 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:04:03.069123 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
14:04:03.069551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:04:03.720701 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.65 seconds
14:04:03.722667 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
14:04:03.794473 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:04:03.795322 [info ] [MainThread]: 
14:04:03.809282 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:03.809961 [info ] [Thread-1  ]: 1 of 3 START test not_null_mart_monthly_sales_date_block_num.................... [RUN]
14:04:03.810903 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:04:03.816833 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:03.819627 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:03.833619 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:04:03.846464 [debug] [Thread-1  ]: finished collecting timing info
14:04:03.847781 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:03.859726 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:04:03.881710 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:04:03.882856 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_marts.mart_monthly_sales
where date_block_num is null



      
    ) dbt_internal_test
14:04:03.884506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:04.722399 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.84 seconds
14:04:04.730743 [debug] [Thread-1  ]: finished collecting timing info
14:04:04.731553 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562: Close
14:04:04.796907 [info ] [Thread-1  ]: 1 of 3 PASS not_null_mart_monthly_sales_date_block_num.......................... [[32mPASS[0m in 0.99s]
14:04:04.798053 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:04.799015 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:04.801711 [info ] [Thread-1  ]: 2 of 3 START test not_null_mart_monthly_sales_item_id........................... [RUN]
14:04:04.806373 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:04:04.811293 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:04.815906 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:04.826677 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:04:04.890838 [debug] [Thread-1  ]: finished collecting timing info
14:04:04.897312 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:04.904231 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:04:04.914404 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:04:04.915737 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_marts.mart_monthly_sales
where item_id is null



      
    ) dbt_internal_test
14:04:04.916535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:05.465320 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:04:05.466954 [debug] [Thread-1  ]: finished collecting timing info
14:04:05.467383 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8: Close
14:04:05.533515 [info ] [Thread-1  ]: 2 of 3 PASS not_null_mart_monthly_sales_item_id................................. [[32mPASS[0m in 0.73s]
14:04:05.534729 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:05.535462 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:05.536000 [info ] [Thread-1  ]: 3 of 3 START test not_null_mart_monthly_sales_shop_id........................... [RUN]
14:04:05.536768 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:04:05.537446 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:05.537966 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:05.540831 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:04:05.563329 [debug] [Thread-1  ]: finished collecting timing info
14:04:05.565451 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:05.567288 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:04:05.587879 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:04:05.589486 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.STAGING_marts.mart_monthly_sales
where shop_id is null



      
    ) dbt_internal_test
14:04:05.590653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:04:06.230827 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
14:04:06.233742 [debug] [Thread-1  ]: finished collecting timing info
14:04:06.234438 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a: Close
14:04:06.300805 [info ] [Thread-1  ]: 3 of 3 PASS not_null_mart_monthly_sales_shop_id................................. [[32mPASS[0m in 0.76s]
14:04:06.302143 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:06.304590 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:04:06.305633 [info ] [MainThread]: 
14:04:06.306421 [info ] [MainThread]: Finished running 3 tests in 6.41s.
14:04:06.307257 [debug] [MainThread]: Connection 'master' was properly closed.
14:04:06.308074 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a' was properly closed.
14:04:06.326691 [info ] [MainThread]: 
14:04:06.329256 [info ] [MainThread]: [32mCompleted successfully[0m
14:04:06.330923 [info ] [MainThread]: 
14:04:06.332971 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:04:06.333991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f4835970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f4051a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb6f408b7f0>]}


============================== 2025-08-02 15:57:21.106890 | 5dbc1c75-3319-4aeb-a6fe-6f7f16b1b199 ==============================
15:57:21.106890 [info ] [MainThread]: Running with dbt=1.0.0
15:57:21.107616 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_total_revenue'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:57:21.110539 [debug] [MainThread]: Tracking: tracking
15:57:21.112774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea9928ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea9928ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea9928e9d0>]}
15:57:21.331198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
15:57:21.331879 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_total_revenue.sql
15:57:21.332414 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/marts/schema.yml
15:57:21.341519 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
15:57:21.376584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbc1c75-3319-4aeb-a6fe-6f7f16b1b199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea9816e370>]}
15:57:21.398732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dbc1c75-3319-4aeb-a6fe-6f7f16b1b199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea992c41f0>]}
15:57:21.399926 [info ] [MainThread]: Found 9 models, 22 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
15:57:21.403824 [info ] [MainThread]: 
15:57:21.404895 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:57:21.406601 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
15:57:21.415989 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
15:57:21.416664 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
15:57:21.417213 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:57:22.788700 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.37 seconds
15:57:22.790754 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
15:57:22.857010 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
15:57:22.862160 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
15:57:22.862844 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
15:57:22.864123 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:57:23.391534 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.53 seconds
15:57:23.393251 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
15:57:23.460775 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
15:57:23.462372 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
15:57:23.462786 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
15:57:23.463095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:57:24.162037 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.7 seconds
15:57:24.163735 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
15:57:24.225123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:57:24.226153 [info ] [MainThread]: 
15:57:24.239603 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
15:57:24.240392 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_total_revenue....................... [RUN]
15:57:24.241679 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
15:57:24.242603 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
15:57:24.243121 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
15:57:24.245438 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
15:57:24.259521 [debug] [Thread-1  ]: finished collecting timing info
15:57:24.261225 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
15:57:24.283547 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
15:57:24.295503 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
15:57:24.296021 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
15:57:24.296453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:57:26.051746 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.76 seconds
15:57:26.058345 [debug] [Thread-1  ]: finished collecting timing info
15:57:26.062084 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
15:57:26.213334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbc1c75-3319-4aeb-a6fe-6f7f16b1b199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea90d22fa0>]}
15:57:26.221495 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.97s]
15:57:26.222773 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
15:57:26.224712 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:57:26.225967 [info ] [MainThread]: 
15:57:26.227322 [info ] [MainThread]: Finished running 1 table model in 4.82s.
15:57:26.228408 [debug] [MainThread]: Connection 'master' was properly closed.
15:57:26.229218 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
15:57:26.255720 [info ] [MainThread]: 
15:57:26.258259 [info ] [MainThread]: [32mCompleted successfully[0m
15:57:26.259980 [info ] [MainThread]: 
15:57:26.261037 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:57:26.262218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea90cb4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea90cb4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aea980810a0>]}


============================== 2025-08-02 16:00:54.609966 | 2ba868b8-a7b8-4208-b80e-4df181e5662f ==============================
16:00:54.609966 [info ] [MainThread]: Running with dbt=1.0.0
16:00:54.610739 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
16:00:54.611432 [debug] [MainThread]: Tracking: tracking
16:00:54.612404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4fc8cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4fc8cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4fc8ca60>]}
16:00:54.965443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:00:54.966958 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
16:00:54.972749 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/marts/schema.yml
16:00:54.984676 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
16:00:55.038662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ba868b8-a7b8-4208-b80e-4df181e5662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4eb2c0d0>]}
16:00:55.069651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ba868b8-a7b8-4208-b80e-4df181e5662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4fccf160>]}
16:00:55.071338 [info ] [MainThread]: Found 10 models, 24 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
16:00:55.073307 [info ] [MainThread]: 
16:00:55.074315 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:00:55.075704 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
16:00:55.084480 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
16:00:55.085179 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
16:00:55.085661 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:00:58.363065 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.28 seconds
16:00:58.366736 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
16:00:58.439102 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:00:58.447713 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:00:58.450977 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
16:00:58.454854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:00:59.808791 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.35 seconds
16:00:59.815174 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
16:00:59.899910 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:00:59.902718 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:00:59.905534 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
16:00:59.908084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:01:00.609447 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.7 seconds
16:01:00.614995 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
16:01:00.683294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:01:00.686565 [info ] [MainThread]: 
16:01:00.703001 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
16:01:00.705725 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
16:01:00.709383 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
16:01:00.713447 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
16:01:00.715501 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
16:01:00.719065 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
16:01:00.752370 [debug] [Thread-1  ]: finished collecting timing info
16:01:00.755012 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
16:01:00.773867 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
16:01:00.782816 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
16:01:00.785734 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        date_block_num,
        SUM(item_cnt_day * item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num
)

SELECT
    date_block_num,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
16:01:00.787503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:01:02.063358 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.28 seconds
16:01:02.071820 [debug] [Thread-1  ]: finished collecting timing info
16:01:02.074093 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
16:01:02.144469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ba868b8-a7b8-4208-b80e-4df181e5662f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea0770eeb0>]}
16:01:02.148260 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_revenue_by_month............... [[32mSUCCESS 1[0m in 1.44s]
16:01:02.150965 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
16:01:02.153238 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:01:02.154975 [info ] [MainThread]: 
16:01:02.156184 [info ] [MainThread]: Finished running 1 table model in 7.08s.
16:01:02.157453 [debug] [MainThread]: Connection 'master' was properly closed.
16:01:02.159827 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
16:01:02.188433 [info ] [MainThread]: 
16:01:02.189605 [info ] [MainThread]: [32mCompleted successfully[0m
16:01:02.190378 [info ] [MainThread]: 
16:01:02.191125 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:01:02.191989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4fccfe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4c08c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bea4c0adac0>]}


============================== 2025-08-02 16:06:10.408309 | 182b2a08-d3df-4862-b3f3-4b2cdcfa227c ==============================
16:06:10.408309 [info ] [MainThread]: Running with dbt=1.0.0
16:06:10.409255 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_top_shops'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
16:06:10.410187 [debug] [MainThread]: Tracking: tracking
16:06:10.411271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e26723ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e26723a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e26723a00>]}
16:06:10.564043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:06:10.564895 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_top_shops.sql
16:06:10.565591 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/marts/schema.yml
16:06:10.574396 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
16:06:10.610722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '182b2a08-d3df-4862-b3f3-4b2cdcfa227c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e26642b20>]}
16:06:10.656310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '182b2a08-d3df-4862-b3f3-4b2cdcfa227c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e267604f0>]}
16:06:10.657015 [info ] [MainThread]: Found 11 models, 26 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
16:06:10.659101 [info ] [MainThread]: 
16:06:10.665124 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:06:10.669833 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
16:06:10.685192 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
16:06:10.686110 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
16:06:10.686876 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:06:11.739747 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.05 seconds
16:06:11.741503 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
16:06:11.808193 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:06:11.814176 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:06:11.814634 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
16:06:11.814924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:06:12.492673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.68 seconds
16:06:12.498978 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
16:06:12.568934 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:06:12.570541 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:06:12.571133 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
16:06:12.571499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:06:13.116017 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.54 seconds
16:06:13.117788 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
16:06:13.184795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:06:13.185638 [info ] [MainThread]: 
16:06:13.198637 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
16:06:13.199507 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_top_shops........................... [RUN]
16:06:13.202492 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
16:06:13.203211 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
16:06:13.203798 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
16:06:13.206099 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
16:06:13.214952 [debug] [Thread-1  ]: finished collecting timing info
16:06:13.215623 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
16:06:13.232135 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
16:06:13.240608 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
16:06:13.241386 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
16:06:13.241961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:06:14.654102 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.41 seconds
16:06:14.661548 [debug] [Thread-1  ]: finished collecting timing info
16:06:14.662313 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
16:06:14.724711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '182b2a08-d3df-4862-b3f3-4b2cdcfa227c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e26642f10>]}
16:06:14.725605 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.52s]
16:06:14.726204 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
16:06:14.728334 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:06:14.729386 [info ] [MainThread]: 
16:06:14.730054 [info ] [MainThread]: Finished running 1 table model in 4.06s.
16:06:14.730589 [debug] [MainThread]: Connection 'master' was properly closed.
16:06:14.731060 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_top_shops' was properly closed.
16:06:14.754946 [info ] [MainThread]: 
16:06:14.755645 [info ] [MainThread]: [32mCompleted successfully[0m
16:06:14.757975 [info ] [MainThread]: 
16:06:14.761001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:06:14.764270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e240bed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700e267608e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700dfe1a2d60>]}


============================== 2025-08-02 16:09:08.402470 | 365eac55-554d-4436-92b4-330066e1735b ==============================
16:09:08.402470 [info ] [MainThread]: Running with dbt=1.0.0
16:09:08.403312 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_top_item_categories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
16:09:08.404072 [debug] [MainThread]: Tracking: tracking
16:09:08.404766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741168820ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741168820a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741168820a00>]}
16:09:08.770130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:09:08.771049 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_top_item_categories.sql
16:09:08.771813 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/marts/schema.yml
16:09:08.780873 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
16:09:08.822560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '365eac55-554d-4436-92b4-330066e1735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7411676f5f70>]}
16:09:08.853434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '365eac55-554d-4436-92b4-330066e1735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741168853e20>]}
16:09:08.855178 [info ] [MainThread]: Found 12 models, 28 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
16:09:08.859297 [info ] [MainThread]: 
16:09:08.862765 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:09:08.869448 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
16:09:08.879030 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
16:09:08.879601 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
16:09:08.880070 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:09:09.949040 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.07 seconds
16:09:09.951038 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
16:09:10.017019 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:09:10.022740 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:09:10.023458 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
16:09:10.024017 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:09:10.545724 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.52 seconds
16:09:10.547647 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
16:09:10.613001 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:09:10.614895 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:09:10.615560 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
16:09:10.616144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:09:11.144687 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.53 seconds
16:09:11.146282 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
16:09:11.217683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:09:11.219542 [info ] [MainThread]: 
16:09:11.233423 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
16:09:11.234325 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_top_item_categories................. [RUN]
16:09:11.235449 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
16:09:11.236069 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
16:09:11.236572 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
16:09:11.238986 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
16:09:11.249457 [debug] [Thread-1  ]: finished collecting timing info
16:09:11.252529 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
16:09:11.270511 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
16:09:11.295086 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
16:09:11.298731 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
16:09:11.301904 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:09:12.985900 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.68 seconds
16:09:12.995025 [debug] [Thread-1  ]: finished collecting timing info
16:09:12.995904 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
16:09:13.067009 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '365eac55-554d-4436-92b4-330066e1735b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74116427d670>]}
16:09:13.067862 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.83s]
16:09:13.068609 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
16:09:13.069935 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:09:13.070564 [info ] [MainThread]: 
16:09:13.071093 [info ] [MainThread]: Finished running 1 table model in 4.21s.
16:09:13.071684 [debug] [MainThread]: Connection 'master' was properly closed.
16:09:13.072268 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_top_item_categories' was properly closed.
16:09:13.087059 [info ] [MainThread]: 
16:09:13.087740 [info ] [MainThread]: [32mCompleted successfully[0m
16:09:13.088721 [info ] [MainThread]: 
16:09:13.091034 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:09:13.092914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74116425e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74116425ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74116425e130>]}


============================== 2025-08-02 16:11:20.338457 | 896dfefc-bfbd-4f62-a5c4-18aeea31f1ad ==============================
16:11:20.338457 [info ] [MainThread]: Running with dbt=1.0.0
16:11:20.339508 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_category_matrix'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
16:11:20.340649 [debug] [MainThread]: Tracking: tracking
16:11:20.342111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dab40a8ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dab40a8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dab40a8a00>]}
16:11:20.773629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:11:20.776627 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_shop_category_matrix.sql
16:11:20.778376 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/marts/schema.yml
16:11:20.789520 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
16:11:20.837589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '896dfefc-bfbd-4f62-a5c4-18aeea31f1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dab0f0d0d0>]}
16:11:20.863979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '896dfefc-bfbd-4f62-a5c4-18aeea31f1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dab40dcd30>]}
16:11:20.865250 [info ] [MainThread]: Found 13 models, 30 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
16:11:20.868931 [info ] [MainThread]: 
16:11:20.870950 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:11:20.873061 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
16:11:20.882924 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
16:11:20.883758 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
16:11:20.884282 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:11:21.874841 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.99 seconds
16:11:21.876787 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
16:11:21.943797 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:11:21.948687 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:11:21.949383 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
16:11:21.953185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:11:22.481503 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.53 seconds
16:11:22.483892 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
16:11:22.550680 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:11:22.553165 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:11:22.553796 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
16:11:22.554348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:11:23.231276 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.68 seconds
16:11:23.236922 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
16:11:23.300615 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:11:23.302298 [info ] [MainThread]: 
16:11:23.316154 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
16:11:23.316862 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
16:11:23.317857 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
16:11:23.318410 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
16:11:23.318971 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
16:11:23.321831 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
16:11:23.334594 [debug] [Thread-1  ]: finished collecting timing info
16:11:23.336695 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
16:11:23.354245 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
16:11:23.370812 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
16:11:23.375656 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
16:11:23.376625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:11:24.831947 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.46 seconds
16:11:24.839189 [debug] [Thread-1  ]: finished collecting timing info
16:11:24.840334 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
16:11:24.903305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896dfefc-bfbd-4f62-a5c4-18aeea31f1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76da6bb0f940>]}
16:11:24.904431 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 1.59s]
16:11:24.905325 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
16:11:24.907163 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:11:24.908282 [info ] [MainThread]: 
16:11:24.910720 [info ] [MainThread]: Finished running 1 table model in 4.04s.
16:11:24.911606 [debug] [MainThread]: Connection 'master' was properly closed.
16:11:24.912226 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_category_matrix' was properly closed.
16:11:24.933908 [info ] [MainThread]: 
16:11:24.937808 [info ] [MainThread]: [32mCompleted successfully[0m
16:11:24.940204 [info ] [MainThread]: 
16:11:24.941174 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:11:24.942061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dab0eca490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dab2f9de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76da6baff0a0>]}


============================== 2025-08-03 07:06:21.095844 | 49ed630e-c079-41d2-83e4-4d0c445b3054 ==============================
07:06:21.095844 [info ] [MainThread]: Running with dbt=1.0.0
07:06:21.096748 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_item_categories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
07:06:21.097551 [debug] [MainThread]: Tracking: tracking
07:06:21.098438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701b8aa42af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701b8aa42a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701b8aa42a30>]}


============================== 2025-08-03 07:08:24.537621 | 45618475-048c-4663-8e07-8b773ba060e2 ==============================
07:08:24.537621 [info ] [MainThread]: Running with dbt=1.0.0
07:08:24.539885 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_item_categories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
07:08:24.540642 [debug] [MainThread]: Tracking: tracking
07:08:24.541439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73699494fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73699494fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73699494fa60>]}
07:15:58.848592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 4 files changed.
07:15:58.851391 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/idna-3.10.dist-info/LICENSE.md
07:15:58.854263 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/soupsieve-2.7.dist-info/licenses/LICENSE.md
07:15:58.858908 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/numpy/random/LICENSE.md
07:15:58.860409 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.sales_train
07:15:58.861124 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.items
07:15:58.861708 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.shops
07:15:58.862143 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.item_categories
07:15:58.862553 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/schema.yml
07:15:58.863258 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_shops.sql
07:15:58.865184 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_item_categories.sql
07:15:58.865613 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_items.sql
07:15:58.878276 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
07:15:58.909644 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
07:15:58.912006 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
07:15:58.914883 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
07:15:58.918260 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
07:15:58.920402 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
07:15:58.922379 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
07:15:58.924298 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
07:15:58.926442 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
07:15:58.928737 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
07:15:58.933704 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
07:15:59.014818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73699480d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73699480db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73699480dee0>]}


============================== 2025-08-03 07:34:02.105504 | 22a0613c-4d0e-4460-85c9-5f9b99b36bfa ==============================
07:34:02.105504 [info ] [MainThread]: Running with dbt=1.0.0
07:34:02.106285 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
07:34:02.106882 [debug] [MainThread]: Tracking: tracking
07:34:02.115179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739581f8f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739581f8f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739581f8f3a0>]}
07:34:02.523694 [debug] [MainThread]: Executing "git --help"
07:34:02.546489 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
07:34:02.547490 [debug] [MainThread]: STDERR: "b''"
07:34:02.553870 [debug] [MainThread]: Acquiring new snowflake connection "debug"
07:34:02.555916 [debug] [MainThread]: Using snowflake connection "debug"
07:34:02.557094 [debug] [MainThread]: On debug: select 1 as id
07:34:02.557618 [debug] [MainThread]: Opening a new connection, currently in state init
07:34:03.804701 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.25 seconds
07:34:03.806435 [debug] [MainThread]: On debug: Close
07:34:03.874235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739581fdebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73957c350640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73957c31f130>]}
07:34:04.323450 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2025-08-03 07:34:08.917284 | 1b3c8dea-562f-4b2e-a5f2-301f8d399890 ==============================
07:34:08.917284 [info ] [MainThread]: Running with dbt=1.0.0
07:34:08.918047 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_item_categories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
07:34:08.918807 [debug] [MainThread]: Tracking: tracking
07:34:08.919585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7868f9b4dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7868f9b4da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7868f9b4da00>]}
07:40:23.543534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 4 files changed.
07:40:23.547830 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/soupsieve-2.7.dist-info/licenses/LICENSE.md
07:40:23.551306 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/idna-3.10.dist-info/LICENSE.md
07:40:23.556163 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/numpy/random/LICENSE.md
07:40:23.559474 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.sales_train
07:40:23.565098 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.items
07:40:23.567676 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.shops
07:40:23.570658 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.item_categories
07:40:23.573292 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/schema.yml
07:40:23.576425 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_items.sql
07:40:23.582106 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_shops.sql
07:40:23.584341 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_item_categories.sql
07:40:23.596513 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
07:40:23.619705 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
07:40:23.625768 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
07:40:23.631477 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
07:40:23.634825 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
07:40:23.641176 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
07:40:23.646031 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
07:40:23.649837 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
07:40:23.652005 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
07:40:23.659328 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
07:40:23.662462 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
07:40:23.756331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7868f9a202e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7868f9a0f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7868f9a0fd30>]}


============================== 2025-08-03 08:02:22.087205 | 17002d29-a2e3-4e93-a6d4-38fc5c6ce0da ==============================
08:02:22.087205 [info ] [MainThread]: Running with dbt=1.0.0
08:02:22.088481 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_item_categories'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
08:02:22.089193 [debug] [MainThread]: Tracking: tracking
08:02:22.090443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee12163caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee12163ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee12163ca30>]}
08:07:27.501139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 4 files changed.
08:07:27.513719 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/numpy/random/LICENSE.md
08:07:27.514726 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/idna-3.10.dist-info/LICENSE.md
08:07:27.515213 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/staging/.venv/lib/python3.12/site-packages/soupsieve-2.7.dist-info/licenses/LICENSE.md
08:07:27.518403 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.sales_train
08:07:27.519612 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.items
08:07:27.520338 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.shops
08:07:27.521038 [debug] [MainThread]: Partial parsing: deleted source source.dbt_sales_pipeline.raw.item_categories
08:07:27.521848 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/schema.yml
08:07:27.522428 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_item_categories.sql
08:07:27.522975 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_items.sql
08:07:27.523366 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/staging/stg_shops.sql
08:07:27.569380 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
08:07:27.614850 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
08:07:27.617637 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
08:07:27.621784 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
08:07:27.624737 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
08:07:27.627278 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
08:07:27.630065 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
08:07:27.632736 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
08:07:27.634956 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
08:07:27.637643 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
08:07:27.639872 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
08:07:27.750475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17002d29-a2e3-4e93-a6d4-38fc5c6ce0da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee11a3d00d0>]}
08:07:27.800035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17002d29-a2e3-4e93-a6d4-38fc5c6ce0da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee12056e2b0>]}
08:07:27.800811 [info ] [MainThread]: Found 13 models, 30 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:07:27.804496 [info ] [MainThread]: 
08:07:27.806050 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:07:27.810884 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
08:07:27.820997 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
08:07:27.821906 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
08:07:27.822679 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:07:29.305846 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.48 seconds
08:07:29.310518 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
08:07:29.378529 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
08:07:29.384374 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
08:07:29.385885 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
08:07:29.387183 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:07:29.987934 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.6 seconds
08:07:29.990525 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
08:07:30.064124 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
08:07:30.068921 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
08:07:30.071877 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
08:07:30.072869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:07:30.831274 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.76 seconds
08:07:30.834330 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
08:07:30.908373 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:07:30.910050 [info ] [MainThread]: 
08:07:30.934208 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_item_categories
08:07:30.935176 [info ] [Thread-1  ]: 1 of 1 START view model STAGING_staging.stg_item_categories..................... [RUN]
08:07:30.936936 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
08:07:30.937953 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_item_categories
08:07:30.938809 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_item_categories
08:07:30.941709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_item_categories"
08:07:30.967189 [debug] [Thread-1  ]: finished collecting timing info
08:07:30.970382 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_item_categories
08:07:30.991233 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_item_categories"
08:07:31.012004 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
08:07:31.016567 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_item_categories"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_item_categories 
  
   as (
    -- models/staging/stg_item_categories.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.translated_item_categories
),

renamed as (
    select
        item_category_id::int as item_category_id,
        item_category_name::string as item_category_name
    from source
)

select * from renamed
  );
08:07:31.018496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:07:31.652608 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
08:07:31.658874 [debug] [Thread-1  ]: finished collecting timing info
08:07:31.659655 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: Close
08:07:31.724152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17002d29-a2e3-4e93-a6d4-38fc5c6ce0da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee11883aa30>]}
08:07:31.725202 [info ] [Thread-1  ]: 1 of 1 OK created view model STAGING_staging.stg_item_categories................ [[32mSUCCESS 1[0m in 0.79s]
08:07:31.725904 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_item_categories
08:07:31.727990 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:07:31.728904 [info ] [MainThread]: 
08:07:31.729627 [info ] [MainThread]: Finished running 1 view model in 3.92s.
08:07:31.730550 [debug] [MainThread]: Connection 'master' was properly closed.
08:07:31.731509 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
08:07:31.732039 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.stg_item_categories' was properly closed.
08:07:31.765858 [info ] [MainThread]: 
08:07:31.766683 [info ] [MainThread]: [32mCompleted successfully[0m
08:07:31.767390 [info ] [MainThread]: 
08:07:31.768069 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:07:31.768984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1200587f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee12056e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee1188a1f40>]}


============================== 2025-08-03 08:08:29.652384 | b3fe10e9-69e1-4527-9c10-bedc16bbd0d3 ==============================
08:08:29.652384 [info ] [MainThread]: Running with dbt=1.0.0
08:08:29.653975 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_items'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
08:08:29.654658 [debug] [MainThread]: Tracking: tracking
08:08:29.656745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a81f8eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a81f8ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a81f8ea00>]}
08:12:13.719081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:12:13.720106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:12:13.728714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3fe10e9-69e1-4527-9c10-bedc16bbd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a81e620d0>]}
08:12:13.796222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3fe10e9-69e1-4527-9c10-bedc16bbd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a81f60eb0>]}
08:12:13.822867 [info ] [MainThread]: Found 13 models, 30 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:12:13.825373 [info ] [MainThread]: 
08:12:13.826650 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:12:13.853358 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
08:12:13.863082 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
08:12:13.863955 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
08:12:13.864625 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:12:16.939362 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.07 seconds
08:12:16.941725 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
08:12:17.008078 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
08:12:17.014298 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
08:12:17.015318 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
08:12:17.016167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:12:17.715938 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.7 seconds
08:12:17.720149 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
08:12:18.279953 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
08:12:18.281784 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
08:12:18.282478 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
08:12:18.283261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:12:18.858954 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.58 seconds
08:12:18.861091 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
08:12:18.928585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:12:18.929784 [info ] [MainThread]: 
08:12:18.945680 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_items
08:12:18.946652 [info ] [Thread-1  ]: 1 of 1 START view model STAGING_staging.stg_items............................... [RUN]
08:12:18.947928 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_items"
08:12:18.948814 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_items
08:12:18.949502 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_items
08:12:18.952102 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_items"
08:12:18.989844 [debug] [Thread-1  ]: finished collecting timing info
08:12:19.003607 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_items
08:12:19.022040 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_items"
08:12:19.041462 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_items"
08:12:19.064645 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_items"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_items 
  
   as (
    -- models/staging/stg_items.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.translated_items
),

renamed as (
    select
        item_id::int as item_id,
        item_name::string as item_name,
        item_category_id::int as item_category_id
    from source
)

select * from renamed
  );
08:12:19.080309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:12:19.767890 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
08:12:19.773260 [debug] [Thread-1  ]: finished collecting timing info
08:12:19.774080 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: Close
08:12:19.846643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3fe10e9-69e1-4527-9c10-bedc16bbd0d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a80a421c0>]}
08:12:19.847857 [info ] [Thread-1  ]: 1 of 1 OK created view model STAGING_staging.stg_items.......................... [[32mSUCCESS 1[0m in 0.90s]
08:12:19.848653 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_items
08:12:19.850447 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:12:19.872749 [info ] [MainThread]: 
08:12:19.873854 [info ] [MainThread]: Finished running 1 view model in 6.05s.
08:12:19.874628 [debug] [MainThread]: Connection 'master' was properly closed.
08:12:19.875483 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.stg_items' was properly closed.
08:12:19.893072 [info ] [MainThread]: 
08:12:19.894656 [info ] [MainThread]: [32mCompleted successfully[0m
08:12:19.896709 [info ] [MainThread]: 
08:12:19.898610 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:12:19.900406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a81da74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a80a32f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a81fc72e0>]}


============================== 2025-08-03 08:32:02.071574 | 8c16897f-70ca-435b-9217-a53c4c172932 ==============================
08:32:02.071574 [info ] [MainThread]: Running with dbt=1.0.0
08:32:02.072830 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_shop'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
08:32:02.074602 [debug] [MainThread]: Tracking: tracking
08:32:02.075519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b270272ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b270272a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b270272a00>]}
08:35:41.638632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:35:41.641201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:35:41.654648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c16897f-70ca-435b-9217-a53c4c172932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b26f1210d0>]}
08:35:41.746106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c16897f-70ca-435b-9217-a53c4c172932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b270240e50>]}
08:35:41.747140 [info ] [MainThread]: Found 13 models, 30 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:35:41.748726 [warn ] [MainThread]: The selection criterion 'stg_shop' does not match any nodes
08:35:41.775642 [info ] [MainThread]: 
08:35:41.776842 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
08:35:41.792540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b26f171160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b26f1711f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b2702403a0>]}


============================== 2025-08-03 08:38:16.226000 | 66529b4f-b4fc-4468-977e-0e622d89e170 ==============================
08:38:16.226000 [info ] [MainThread]: Running with dbt=1.0.0
08:38:16.232326 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['stg_shops'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
08:38:16.233077 [debug] [MainThread]: Tracking: tracking
08:38:16.233910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f53675b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f53675ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f53675a60>]}
08:43:16.932348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:43:16.933475 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:43:16.943622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66529b4f-b4fc-4468-977e-0e622d89e170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f525210d0>]}
08:43:16.962878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66529b4f-b4fc-4468-977e-0e622d89e170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f53643df0>]}
08:43:16.963745 [info ] [MainThread]: Found 13 models, 30 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:43:16.966106 [info ] [MainThread]: 
08:43:16.967181 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:43:16.968685 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
08:43:16.978469 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
08:43:16.979220 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
08:43:16.979734 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:43:18.280403 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.3 seconds
08:43:18.282946 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
08:43:18.352022 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
08:43:18.357743 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
08:43:18.359332 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
08:43:18.360396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:43:19.057038 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.7 seconds
08:43:19.059007 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
08:43:19.171508 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
08:43:19.174740 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
08:43:19.175410 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
08:43:19.175885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:43:19.749861 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.57 seconds
08:43:19.751869 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
08:43:19.816530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:43:19.817380 [info ] [MainThread]: 
08:43:19.831794 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_shops
08:43:19.832823 [info ] [Thread-1  ]: 1 of 1 START view model STAGING_staging.stg_shops............................... [RUN]
08:43:19.834027 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_shops"
08:43:19.834581 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_shops
08:43:19.835075 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_shops
08:43:19.837262 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_shops"
08:43:19.857363 [debug] [Thread-1  ]: finished collecting timing info
08:43:19.859421 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_shops
08:43:19.876660 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_shops"
08:43:19.891440 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_shops"
08:43:19.892057 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_shops"} */

  create or replace  view SALES_PIPELINE.STAGING_staging.stg_shops 
  
   as (
    -- models/staging/stg_shops.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.translated_shops
),

renamed as (
    select
        shop_id::int as shop_id,
        shop_name::string as shop_name
    from source
)

select * from renamed
  );
08:43:19.892502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:43:20.567529 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
08:43:20.572549 [debug] [Thread-1  ]: finished collecting timing info
08:43:20.573464 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_shops: Close
08:43:20.639732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66529b4f-b4fc-4468-977e-0e622d89e170', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f510f2040>]}
08:43:20.640833 [info ] [Thread-1  ]: 1 of 1 OK created view model STAGING_staging.stg_shops.......................... [[32mSUCCESS 1[0m in 0.81s]
08:43:20.641567 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_shops
08:43:20.643558 [debug] [MainThread]: Acquiring new snowflake connection "master"
08:43:20.644374 [info ] [MainThread]: 
08:43:20.644899 [info ] [MainThread]: Finished running 1 view model in 3.68s.
08:43:20.645477 [debug] [MainThread]: Connection 'master' was properly closed.
08:43:20.646036 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.stg_shops' was properly closed.
08:43:20.665920 [info ] [MainThread]: 
08:43:20.668149 [info ] [MainThread]: [32mCompleted successfully[0m
08:43:20.670604 [info ] [MainThread]: 
08:43:20.671295 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
08:43:20.672023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f515ee9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f52466b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731f53643100>]}


============================== 2025-08-03 09:15:01.611550 | 779415df-75f7-4821-8d95-9ada7e14c523 ==============================
09:15:01.611550 [info ] [MainThread]: Running with dbt=1.0.0
09:15:01.613276 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
09:15:01.614476 [debug] [MainThread]: Tracking: tracking
09:15:01.615785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbef46ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbef46a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbef46a00>]}
09:20:25.367907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
09:20:25.369356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
09:20:25.380751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbdde20d0>]}
09:20:25.407409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbef14e20>]}
09:20:25.410257 [info ] [MainThread]: Found 13 models, 30 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:20:25.420954 [info ] [MainThread]: 
09:20:25.421912 [debug] [MainThread]: Acquiring new snowflake connection "master"
09:20:25.423568 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
09:20:25.432950 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
09:20:25.433604 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
09:20:25.434042 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:20:26.629473 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.2 seconds
09:20:26.632706 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
09:20:26.704260 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
09:20:26.712761 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
09:20:26.713779 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
09:20:26.719185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:20:27.279588 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.56 seconds
09:20:27.283200 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
09:20:27.352179 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
09:20:27.354851 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
09:20:27.355646 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
09:20:27.356689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:20:28.105403 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.75 seconds
09:20:28.107586 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
09:20:28.174887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:20:28.177052 [info ] [MainThread]: 
09:20:28.192787 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
09:20:28.195526 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_marts.mart_daily_sales......................... [RUN]
09:20:28.197866 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
09:20:28.199306 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
09:20:28.201239 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
09:20:28.204592 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
09:20:28.226866 [debug] [Thread-1  ]: finished collecting timing info
09:20:28.228580 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
09:20:28.249655 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
09:20:28.267916 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
09:20:28.270106 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
09:20:28.271024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:32.090735 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.82 seconds
09:20:32.099548 [debug] [Thread-1  ]: finished collecting timing info
09:20:32.100400 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
09:20:32.172328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbef14190>]}
09:20:32.173883 [info ] [Thread-1  ]: 1 of 9 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 3.97s]
09:20:32.176619 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
09:20:32.177610 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
09:20:32.179080 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
09:20:32.181035 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
09:20:32.181747 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
09:20:32.182975 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
09:20:32.185610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
09:20:32.204017 [debug] [Thread-1  ]: finished collecting timing info
09:20:32.205550 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
09:20:32.207514 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
09:20:32.228821 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
09:20:32.230619 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        date_block_num,
        shop_id,
        item_id,
        SUM(item_price * item_cnt_day) AS monthly_revenue,
        SUM(item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num, shop_id, item_id
)

SELECT *
FROM base
      );
09:20:32.231179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:34.202416 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.97 seconds
09:20:34.204363 [debug] [Thread-1  ]: finished collecting timing info
09:20:34.205225 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
09:20:34.269090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbc9f98e0>]}
09:20:34.272084 [info ] [Thread-1  ]: 2 of 9 OK created table model STAGING_marts.mart_monthly_sales.................. [[32mSUCCESS 1[0m in 2.09s]
09:20:34.272702 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
09:20:34.276393 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
09:20:34.278998 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
09:20:34.282408 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
09:20:34.283735 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
09:20:34.284458 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
09:20:34.286542 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
09:20:34.316465 [debug] [Thread-1  ]: finished collecting timing info
09:20:34.317553 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
09:20:34.320565 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
09:20:34.343223 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
09:20:34.347101 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        date_block_num,
        SUM(item_cnt_day * item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num
)

SELECT
    date_block_num,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
09:20:34.347802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:35.305642 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.96 seconds
09:20:35.308305 [debug] [Thread-1  ]: finished collecting timing info
09:20:35.310950 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
09:20:35.380654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbcf01fa0>]}
09:20:35.381568 [info ] [Thread-1  ]: 3 of 9 OK created table model STAGING_marts.mart_revenue_by_month............... [[32mSUCCESS 1[0m in 1.10s]
09:20:35.382280 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
09:20:35.382994 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
09:20:35.383967 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_marts.mart_revenue_by_store.................... [RUN]
09:20:35.384639 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
09:20:35.385186 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
09:20:35.385777 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
09:20:35.386910 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
09:20:35.397382 [debug] [Thread-1  ]: finished collecting timing info
09:20:35.398168 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
09:20:35.400201 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
09:20:35.414351 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
09:20:35.415273 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id;
09:20:35.415961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:35.964844 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1e90-0001-63bb-0001-57120004fc32
09:20:35.967180 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 16 unexpected ';'.
09:20:35.968335 [debug] [Thread-1  ]: finished collecting timing info
09:20:35.968966 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
09:20:36.029742 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_store (models/marts/mart_revenue_by_store.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 16 unexpected ';'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_store.sql
09:20:36.031854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbc9b8970>]}
09:20:36.033293 [error] [Thread-1  ]: 4 of 9 ERROR creating table model STAGING_marts.mart_revenue_by_store........... [[31mERROR[0m in 0.65s]
09:20:36.036001 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
09:20:36.037257 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
09:20:36.038669 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
09:20:36.040868 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:20:36.042324 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
09:20:36.043620 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
09:20:36.047176 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:20:36.084323 [debug] [Thread-1  ]: finished collecting timing info
09:20:36.085431 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
09:20:36.088413 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:20:36.124665 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:20:36.125940 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
09:20:36.127479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:38.145387 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.02 seconds
09:20:38.146983 [debug] [Thread-1  ]: finished collecting timing info
09:20:38.147552 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
09:20:38.212396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbc9f9040>]}
09:20:38.213279 [info ] [Thread-1  ]: 5 of 9 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 2.17s]
09:20:38.213872 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
09:20:38.214628 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
09:20:38.215257 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_marts.mart_top_item_categories................. [RUN]
09:20:38.216011 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
09:20:38.217346 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
09:20:38.219225 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
09:20:38.221586 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
09:20:38.240352 [debug] [Thread-1  ]: finished collecting timing info
09:20:38.242171 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
09:20:38.246291 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
09:20:38.267128 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
09:20:38.268045 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
09:20:38.269250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:39.934949 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.67 seconds
09:20:39.936863 [debug] [Thread-1  ]: finished collecting timing info
09:20:39.937602 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
09:20:39.993391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbc9f9310>]}
09:20:39.995166 [info ] [Thread-1  ]: 6 of 9 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.78s]
09:20:39.996028 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
09:20:39.997269 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
09:20:40.000334 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_marts.mart_top_products........................ [RUN]
09:20:40.001955 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
09:20:40.002611 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
09:20:40.003203 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
09:20:40.004374 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
09:20:40.019530 [debug] [Thread-1  ]: finished collecting timing info
09:20:40.021816 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
09:20:40.024713 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
09:20:40.044375 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
09:20:40.046091 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10;
09:20:40.046683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:40.560259 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1e90-0001-63bc-0001-57120004ec82
09:20:40.562210 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 8 unexpected ';'.
09:20:40.565431 [debug] [Thread-1  ]: finished collecting timing info
09:20:40.567153 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
09:20:40.633274 [debug] [Thread-1  ]: Database Error in model mart_top_products (models/marts/mart_top_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 8 unexpected ';'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_top_products.sql
09:20:40.634811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbcfd3730>]}
09:20:40.638045 [error] [Thread-1  ]: 7 of 9 ERROR creating table model STAGING_marts.mart_top_products............... [[31mERROR[0m in 0.63s]
09:20:40.638954 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
09:20:40.640124 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
09:20:40.641504 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_marts.mart_top_shops........................... [RUN]
09:20:40.643512 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
09:20:40.644847 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
09:20:40.648242 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
09:20:40.651741 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
09:20:40.683449 [debug] [Thread-1  ]: finished collecting timing info
09:20:40.685003 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
09:20:40.688412 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
09:20:40.711464 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
09:20:40.714752 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
09:20:40.716896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:41.916864 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.2 seconds
09:20:41.918940 [debug] [Thread-1  ]: finished collecting timing info
09:20:41.920106 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
09:20:41.982558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbc01c1f0>]}
09:20:41.983361 [info ] [Thread-1  ]: 8 of 9 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.34s]
09:20:41.984014 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
09:20:41.984965 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
09:20:41.985965 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_marts.mart_total_revenue....................... [RUN]
09:20:41.986651 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
09:20:41.987172 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
09:20:41.987627 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
09:20:41.989431 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
09:20:42.007158 [debug] [Thread-1  ]: finished collecting timing info
09:20:42.008869 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
09:20:42.011464 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
09:20:42.027519 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
09:20:42.028148 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
09:20:42.030141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:20:43.096019 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.07 seconds
09:20:43.097754 [debug] [Thread-1  ]: finished collecting timing info
09:20:43.098487 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
09:20:43.168698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779415df-75f7-4821-8d95-9ada7e14c523', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbc02a7c0>]}
09:20:43.171521 [info ] [Thread-1  ]: 9 of 9 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.18s]
09:20:43.172607 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
09:20:43.174895 [debug] [MainThread]: Acquiring new snowflake connection "master"
09:20:43.177426 [info ] [MainThread]: 
09:20:43.179862 [info ] [MainThread]: Finished running 9 table models in 17.76s.
09:20:43.180974 [debug] [MainThread]: Connection 'master' was properly closed.
09:20:43.183441 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
09:20:43.210832 [info ] [MainThread]: 
09:20:43.212631 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
09:20:43.213891 [info ] [MainThread]: 
09:20:43.215481 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_store (models/marts/mart_revenue_by_store.sql)[0m
09:20:43.217115 [error] [MainThread]:   001003 (42000): SQL compilation error:
09:20:43.218505 [error] [MainThread]:   syntax error line 6 at position 16 unexpected ';'.
09:20:43.220122 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_store.sql
09:20:43.220828 [info ] [MainThread]: 
09:20:43.221888 [error] [MainThread]: [33mDatabase Error in model mart_top_products (models/marts/mart_top_products.sql)[0m
09:20:43.224397 [error] [MainThread]:   001003 (42000): SQL compilation error:
09:20:43.225860 [error] [MainThread]:   syntax error line 8 at position 8 unexpected ';'.
09:20:43.227561 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_top_products.sql
09:20:43.228239 [info ] [MainThread]: 
09:20:43.228902 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
09:20:43.229715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbef7da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbdd2bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74dbbcfed3d0>]}


============================== 2025-08-03 09:25:32.580343 | c67ea925-9ec0-449a-96d2-7d27e65aa416 ==============================
09:25:32.580343 [info ] [MainThread]: Running with dbt=1.0.0
09:25:32.581592 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
09:25:32.582353 [debug] [MainThread]: Tracking: tracking
09:25:32.584350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f884bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f884ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f884ba00>]}
09:29:45.028999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
09:29:45.030439 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_top_products.sql
09:29:45.034997 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_store.sql
09:29:45.048585 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
09:29:45.062990 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
09:29:45.084102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f56a50d0>]}
09:29:45.115964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f77e5dc0>]}
09:29:45.116960 [info ] [MainThread]: Found 13 models, 30 tests, 0 snapshots, 0 analyses, 179 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:29:45.122164 [info ] [MainThread]: 
09:29:45.124808 [debug] [MainThread]: Acquiring new snowflake connection "master"
09:29:45.126792 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
09:29:45.137326 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
09:29:45.138017 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
09:29:45.138446 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:29:48.364743 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.23 seconds
09:29:48.368251 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
09:29:48.430954 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
09:29:48.437176 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
09:29:48.438113 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
09:29:48.438659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:29:49.129311 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.69 seconds
09:29:49.130813 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
09:29:49.194805 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
09:29:49.196435 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
09:29:49.197045 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
09:29:49.197794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:29:49.777258 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.58 seconds
09:29:49.780465 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
09:29:49.845450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:29:49.846590 [info ] [MainThread]: 
09:29:49.861834 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
09:29:49.862678 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_marts.mart_daily_sales......................... [RUN]
09:29:49.863501 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
09:29:49.864107 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
09:29:49.865227 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
09:29:49.867796 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
09:29:49.878315 [debug] [Thread-1  ]: finished collecting timing info
09:29:49.879024 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
09:29:49.895535 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
09:29:49.904235 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
09:29:49.906959 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
09:29:49.908232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:29:53.011009 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.1 seconds
09:29:53.017942 [debug] [Thread-1  ]: finished collecting timing info
09:29:53.018748 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
09:29:53.084951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f48c5e20>]}
09:29:53.086269 [info ] [Thread-1  ]: 1 of 9 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 3.22s]
09:29:53.087390 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
09:29:53.088141 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
09:29:53.088843 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
09:29:53.089985 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
09:29:53.090867 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
09:29:53.091503 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
09:29:53.093679 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
09:29:53.102519 [debug] [Thread-1  ]: finished collecting timing info
09:29:53.103222 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
09:29:53.104830 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
09:29:53.115460 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
09:29:53.116562 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        date_block_num,
        shop_id,
        item_id,
        SUM(item_price * item_cnt_day) AS monthly_revenue,
        SUM(item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num, shop_id, item_id
)

SELECT *
FROM base
      );
09:29:53.117035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:29:54.836277 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.72 seconds
09:29:54.839785 [debug] [Thread-1  ]: finished collecting timing info
09:29:54.842506 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
09:29:54.907540 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f43266d0>]}
09:29:54.908493 [info ] [Thread-1  ]: 2 of 9 OK created table model STAGING_marts.mart_monthly_sales.................. [[32mSUCCESS 1[0m in 1.82s]
09:29:54.909548 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
09:29:54.910457 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
09:29:54.911463 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
09:29:54.912365 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
09:29:54.912960 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
09:29:54.913581 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
09:29:54.916057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
09:29:54.927135 [debug] [Thread-1  ]: finished collecting timing info
09:29:54.927854 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
09:29:54.930535 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
09:29:54.941959 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
09:29:54.942846 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        date_block_num,
        SUM(item_cnt_day * item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num
)

SELECT
    date_block_num,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
09:29:54.943308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:29:56.041610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.1 seconds
09:29:56.043583 [debug] [Thread-1  ]: finished collecting timing info
09:29:56.044364 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
09:29:56.111522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f43267f0>]}
09:29:56.112476 [info ] [Thread-1  ]: 3 of 9 OK created table model STAGING_marts.mart_revenue_by_month............... [[32mSUCCESS 1[0m in 1.20s]
09:29:56.113090 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
09:29:56.113939 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
09:29:56.115323 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_marts.mart_revenue_by_store.................... [RUN]
09:29:56.116623 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
09:29:56.117186 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
09:29:56.117643 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
09:29:56.118841 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
09:29:56.126564 [debug] [Thread-1  ]: finished collecting timing info
09:29:56.128048 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
09:29:56.130145 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
09:29:56.143756 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
09:29:56.144469 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
09:29:56.148824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:29:57.157170 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.01 seconds
09:29:57.159903 [debug] [Thread-1  ]: finished collecting timing info
09:29:57.161794 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
09:29:57.230975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f48900d0>]}
09:29:57.234928 [info ] [Thread-1  ]: 4 of 9 OK created table model STAGING_marts.mart_revenue_by_store............... [[32mSUCCESS 1[0m in 1.11s]
09:29:57.235632 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
09:29:57.236980 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
09:29:57.237985 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
09:29:57.238698 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:29:57.239246 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
09:29:57.239709 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
09:29:57.242006 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:29:57.249509 [debug] [Thread-1  ]: finished collecting timing info
09:29:57.252718 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
09:29:57.255137 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:29:57.266639 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:29:57.267685 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
09:29:57.268167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:29:58.575893 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.31 seconds
09:29:58.577564 [debug] [Thread-1  ]: finished collecting timing info
09:29:58.578176 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
09:29:58.643254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f42e27f0>]}
09:29:58.646240 [info ] [Thread-1  ]: 5 of 9 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 1.40s]
09:29:58.648719 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
09:29:58.650503 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
09:29:58.651785 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_marts.mart_top_item_categories................. [RUN]
09:29:58.653418 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
09:29:58.654241 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
09:29:58.655323 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
09:29:58.658080 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
09:29:58.667803 [debug] [Thread-1  ]: finished collecting timing info
09:29:58.669373 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
09:29:58.672518 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
09:29:58.682116 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
09:29:58.682678 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
09:29:58.683213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:30:00.287987 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.6 seconds
09:30:00.289819 [debug] [Thread-1  ]: finished collecting timing info
09:30:00.290382 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
09:30:00.360057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f8886430>]}
09:30:00.361117 [info ] [Thread-1  ]: 6 of 9 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.71s]
09:30:00.361969 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
09:30:00.362753 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
09:30:00.363943 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_marts.mart_top_products........................ [RUN]
09:30:00.365511 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
09:30:00.366260 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
09:30:00.366954 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
09:30:00.368882 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
09:30:00.378821 [debug] [Thread-1  ]: finished collecting timing info
09:30:00.379682 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
09:30:00.383029 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
09:30:00.393520 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
09:30:00.395581 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
09:30:00.396741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:30:01.526485 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.13 seconds
09:30:01.528233 [debug] [Thread-1  ]: finished collecting timing info
09:30:01.529162 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
09:30:01.592953 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f43265b0>]}
09:30:01.594733 [info ] [Thread-1  ]: 7 of 9 OK created table model STAGING_marts.mart_top_products................... [[32mSUCCESS 1[0m in 1.23s]
09:30:01.595706 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
09:30:01.596538 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
09:30:01.598130 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_marts.mart_top_shops........................... [RUN]
09:30:01.600813 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
09:30:01.601690 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
09:30:01.602626 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
09:30:01.605929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
09:30:01.616143 [debug] [Thread-1  ]: finished collecting timing info
09:30:01.617133 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
09:30:01.619569 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
09:30:01.628864 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
09:30:01.630550 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
09:30:01.631108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:30:02.825530 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.19 seconds
09:30:02.827732 [debug] [Thread-1  ]: finished collecting timing info
09:30:02.828358 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
09:30:02.893949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f4326cd0>]}
09:30:02.895055 [info ] [Thread-1  ]: 8 of 9 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.29s]
09:30:02.895823 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
09:30:02.896441 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
09:30:02.897028 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_marts.mart_total_revenue....................... [RUN]
09:30:02.897877 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
09:30:02.898441 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
09:30:02.898952 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
09:30:02.901281 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
09:30:02.911960 [debug] [Thread-1  ]: finished collecting timing info
09:30:02.912802 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
09:30:02.914941 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
09:30:02.924697 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
09:30:02.925354 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
09:30:02.925872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:30:03.860564 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
09:30:03.862756 [debug] [Thread-1  ]: finished collecting timing info
09:30:03.863748 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
09:30:03.932533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c67ea925-9ec0-449a-96d2-7d27e65aa416', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f4326c70>]}
09:30:03.934105 [info ] [Thread-1  ]: 9 of 9 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.03s]
09:30:03.934937 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
09:30:03.938193 [debug] [MainThread]: Acquiring new snowflake connection "master"
09:30:03.940151 [info ] [MainThread]: 
09:30:03.940833 [info ] [MainThread]: Finished running 9 table models in 18.82s.
09:30:03.941463 [debug] [MainThread]: Connection 'master' was properly closed.
09:30:03.942013 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
09:30:03.965656 [info ] [MainThread]: 
09:30:03.970022 [info ] [MainThread]: [32mCompleted successfully[0m
09:30:03.973328 [info ] [MainThread]: 
09:30:03.975435 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
09:30:03.976373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f4213670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f42139a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7083f42138e0>]}


============================== 2025-08-03 09:50:06.830988 | c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475 ==============================
09:50:06.830988 [info ] [MainThread]: Running with dbt=1.0.0
09:50:06.833501 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
09:50:06.834584 [debug] [MainThread]: Tracking: tracking
09:50:06.836063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c112a1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c112a1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c112a1a30>]}
09:54:07.996863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
09:54:07.999347 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/utils/base_date.sql
09:54:08.003117 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://macros/date_utils.sql
09:54:08.004063 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_monthly_sales.sql
09:54:08.005643 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
09:54:08.006227 [debug] [MainThread]: Parsing macros/date_utils.sql
09:54:08.024469 [debug] [MainThread]: 1699: static parser successfully parsed utils/base_date.sql
09:54:08.035547 [debug] [MainThread]: 1603: static parser failed on marts/mart_monthly_sales.sql
09:54:08.041157 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/mart_monthly_sales.sql
09:54:08.042526 [debug] [MainThread]: 1603: static parser failed on marts/mart_revenue_by_month.sql
09:54:08.045551 [debug] [MainThread]: 1602: parser fallback to jinja rendering on marts/mart_revenue_by_month.sql
09:54:08.088455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c100e40d0>]}
09:54:08.118634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c101e29d0>]}
09:54:08.119908 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:54:08.125128 [info ] [MainThread]: 
09:54:08.126129 [debug] [MainThread]: Acquiring new snowflake connection "master"
09:54:08.127948 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
09:54:08.137030 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
09:54:08.137777 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
09:54:08.138301 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:54:13.230751 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 5.09 seconds
09:54:13.233524 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
09:54:13.301260 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
09:54:13.306523 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
09:54:13.307706 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
09:54:13.308945 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:54:14.025498 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.72 seconds
09:54:14.027282 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
09:54:14.107622 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
09:54:14.109463 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
09:54:14.110655 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
09:54:14.111453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:54:14.639344 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
09:54:14.642303 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
09:54:14.717344 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
09:54:14.720681 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
09:54:14.723774 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
09:54:14.724384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:54:15.220633 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1eb2-0001-63bb-0001-57120004fcbe
09:54:15.222909 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
09:54:15.225156 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
09:54:15.225669 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
09:54:15.226287 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
09:54:15.294523 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:54:15.295313 [info ] [MainThread]: 
09:54:15.310301 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
09:54:15.311259 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_marts.mart_daily_sales......................... [RUN]
09:54:15.311994 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
09:54:15.312643 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
09:54:15.313365 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
09:54:15.315824 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
09:54:15.325164 [debug] [Thread-1  ]: finished collecting timing info
09:54:15.325994 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
09:54:15.342590 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
09:54:15.352456 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
09:54:15.353080 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
09:54:15.353630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:18.835143 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.48 seconds
09:54:18.842738 [debug] [Thread-1  ]: finished collecting timing info
09:54:18.845674 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
09:54:18.913351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c101bd880>]}
09:54:18.917109 [info ] [Thread-1  ]: 1 of 9 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 3.60s]
09:54:18.917765 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
09:54:18.918372 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
09:54:18.918973 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
09:54:18.919612 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
09:54:18.920073 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
09:54:18.920536 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
09:54:18.923018 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
09:54:18.954047 [debug] [Thread-1  ]: finished collecting timing info
09:54:18.954615 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
09:54:18.956575 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
09:54:18.969590 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
09:54:18.971454 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        date_block_num,
        
    TO_CHAR(DATEADD(
        month,
        date_block_num,
        (SELECT BASE_DATE FROM SALES_PIPELINE.STAGING.base_date)
    ), 'YYYY-MM')
 AS date_month,
        shop_id,
        item_id,
        SUM(item_price * item_cnt_day) AS monthly_revenue,
        SUM(item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num, shop_id, item_id
)

SELECT *
FROM base
      );
09:54:18.973934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:19.546268 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1eb2-0001-63bc-0001-57120004ed26
09:54:19.546999 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
09:54:19.547645 [debug] [Thread-1  ]: finished collecting timing info
09:54:19.548114 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
09:54:19.611500 [debug] [Thread-1  ]: Database Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
09:54:19.612501 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c084fb970>]}
09:54:19.613184 [error] [Thread-1  ]: 2 of 9 ERROR creating table model STAGING_marts.mart_monthly_sales.............. [[31mERROR[0m in 0.69s]
09:54:19.613944 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
09:54:19.614628 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
09:54:19.615385 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
09:54:19.616315 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
09:54:19.616906 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
09:54:19.617421 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
09:54:19.619665 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
09:54:19.628855 [debug] [Thread-1  ]: finished collecting timing info
09:54:19.629545 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
09:54:19.631689 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
09:54:19.641622 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
09:54:19.642266 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        date_block_num,
        
    TO_CHAR(DATEADD(
        month,
        date_block_num,
        (SELECT BASE_DATE FROM SALES_PIPELINE.STAGING.base_date)
    ), 'YYYY-MM')
 AS date_month,
        SUM(item_cnt_day * item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num
)

SELECT
    date_block_num,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
09:54:19.642751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:20.193649 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1eb2-0001-63bb-0001-57120004fcc6
09:54:20.196676 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
09:54:20.198358 [debug] [Thread-1  ]: finished collecting timing info
09:54:20.199283 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
09:54:20.263921 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
09:54:20.265195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c08414790>]}
09:54:20.266038 [error] [Thread-1  ]: 3 of 9 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.65s]
09:54:20.266839 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
09:54:20.267790 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
09:54:20.268458 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_marts.mart_revenue_by_store.................... [RUN]
09:54:20.269436 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
09:54:20.270065 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
09:54:20.270824 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
09:54:20.272428 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
09:54:20.290808 [debug] [Thread-1  ]: finished collecting timing info
09:54:20.291578 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
09:54:20.293712 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
09:54:20.311381 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
09:54:20.312591 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
09:54:20.313923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:21.254084 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.94 seconds
09:54:21.255822 [debug] [Thread-1  ]: finished collecting timing info
09:54:21.257065 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
09:54:21.318361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c083fc9a0>]}
09:54:21.319439 [info ] [Thread-1  ]: 4 of 9 OK created table model STAGING_marts.mart_revenue_by_store............... [[32mSUCCESS 1[0m in 1.05s]
09:54:21.320145 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
09:54:21.320874 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
09:54:21.321436 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
09:54:21.322108 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:54:21.322755 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
09:54:21.323228 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
09:54:21.325619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:54:21.335310 [debug] [Thread-1  ]: finished collecting timing info
09:54:21.335987 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
09:54:21.339516 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:54:21.348401 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
09:54:21.349408 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
09:54:21.349927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:22.768958 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.42 seconds
09:54:22.774633 [debug] [Thread-1  ]: finished collecting timing info
09:54:22.776009 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
09:54:22.840559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c083fc880>]}
09:54:22.842773 [info ] [Thread-1  ]: 5 of 9 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 1.52s]
09:54:22.843436 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
09:54:22.844127 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
09:54:22.844922 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_marts.mart_top_item_categories................. [RUN]
09:54:22.845774 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
09:54:22.847214 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
09:54:22.847794 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
09:54:22.850057 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
09:54:22.861282 [debug] [Thread-1  ]: finished collecting timing info
09:54:22.861929 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
09:54:22.863895 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
09:54:22.876977 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
09:54:22.878046 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
09:54:22.878561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:24.414367 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.54 seconds
09:54:24.418701 [debug] [Thread-1  ]: finished collecting timing info
09:54:24.419394 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
09:54:24.484535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c083fc760>]}
09:54:24.487024 [info ] [Thread-1  ]: 6 of 9 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.64s]
09:54:24.490382 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
09:54:24.491128 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
09:54:24.491713 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_marts.mart_top_products........................ [RUN]
09:54:24.492577 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
09:54:24.493269 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
09:54:24.493731 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
09:54:24.494921 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
09:54:24.505613 [debug] [Thread-1  ]: finished collecting timing info
09:54:24.506430 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
09:54:24.508283 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
09:54:24.517743 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
09:54:24.518441 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
09:54:24.519013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:25.726385 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.21 seconds
09:54:25.729407 [debug] [Thread-1  ]: finished collecting timing info
09:54:25.730180 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
09:54:25.794342 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c083fc640>]}
09:54:25.798027 [info ] [Thread-1  ]: 7 of 9 OK created table model STAGING_marts.mart_top_products................... [[32mSUCCESS 1[0m in 1.30s]
09:54:25.798637 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
09:54:25.799191 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
09:54:25.799731 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_marts.mart_top_shops........................... [RUN]
09:54:25.800417 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
09:54:25.800868 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
09:54:25.801283 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
09:54:25.803363 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
09:54:25.816560 [debug] [Thread-1  ]: finished collecting timing info
09:54:25.819328 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
09:54:25.822952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
09:54:25.834135 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
09:54:25.836666 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
09:54:25.837349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:27.145752 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.31 seconds
09:54:27.149818 [debug] [Thread-1  ]: finished collecting timing info
09:54:27.150637 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
09:54:27.216246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c08394970>]}
09:54:27.217296 [info ] [Thread-1  ]: 8 of 9 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.42s]
09:54:27.218075 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
09:54:27.218600 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
09:54:27.219108 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_marts.mart_total_revenue....................... [RUN]
09:54:27.219918 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
09:54:27.220477 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
09:54:27.220902 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
09:54:27.222956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
09:54:27.230374 [debug] [Thread-1  ]: finished collecting timing info
09:54:27.231903 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
09:54:27.234156 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
09:54:27.241972 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
09:54:27.242504 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
09:54:27.242929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:54:28.313587 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.07 seconds
09:54:28.317817 [debug] [Thread-1  ]: finished collecting timing info
09:54:28.319854 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
09:54:28.388185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1bdfaa4-6d1c-4c7a-8f23-123c07f3a475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c112e4df0>]}
09:54:28.392128 [info ] [Thread-1  ]: 9 of 9 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.17s]
09:54:28.395019 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
09:54:28.397068 [debug] [MainThread]: Acquiring new snowflake connection "master"
09:54:28.398563 [info ] [MainThread]: 
09:54:28.401230 [info ] [MainThread]: Finished running 9 table models in 20.27s.
09:54:28.404940 [debug] [MainThread]: Connection 'master' was properly closed.
09:54:28.407012 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
09:54:28.409033 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
09:54:28.429055 [info ] [MainThread]: 
09:54:28.430002 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
09:54:28.432631 [info ] [MainThread]: 
09:54:28.434250 [error] [MainThread]: [33mDatabase Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)[0m
09:54:28.435100 [error] [MainThread]:   002003 (02000): SQL compilation error:
09:54:28.435751 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
09:54:28.436968 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
09:54:28.437950 [info ] [MainThread]: 
09:54:28.438635 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
09:54:28.439287 [error] [MainThread]:   002003 (02000): SQL compilation error:
09:54:28.441152 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
09:54:28.442501 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
09:54:28.443293 [info ] [MainThread]: 
09:54:28.444167 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
09:54:28.445032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c084ed1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c084ed820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761c09fc8520>]}


============================== 2025-08-03 10:01:17.854829 | 51e7d82f-9674-4e57-853b-9fa718597ed4 ==============================
10:01:17.854829 [info ] [MainThread]: Running with dbt=1.0.0
10:01:17.856094 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
10:01:17.856891 [debug] [MainThread]: Tracking: tracking
10:01:17.857557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3415c54ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3415c54a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3415c54a00>]}
10:05:46.940029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:05:46.949972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:05:46.964328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3414b260d0>]}
10:05:47.042984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3414b76340>]}
10:05:47.043996 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:05:47.071253 [info ] [MainThread]: 
10:05:47.082985 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:05:47.097849 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
10:05:47.107974 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
10:05:47.127374 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
10:05:47.128255 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:05:48.412453 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.28 seconds
10:05:48.415646 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
10:05:48.482668 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
10:05:48.488419 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
10:05:48.489461 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
10:05:48.490159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:05:49.211653 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1ebd-0001-63bc-0001-57120004ed6a
10:05:49.226122 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
10:05:49.227209 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
10:05:49.227998 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
10:05:49.228900 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
10:05:49.307165 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
10:05:49.309057 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
10:05:49.309697 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
10:05:49.310204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:05:49.870882 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.56 seconds
10:05:49.873497 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
10:05:49.944003 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
10:05:49.946100 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
10:05:49.947027 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
10:05:49.947670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:05:50.495935 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.55 seconds
10:05:50.498236 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
10:05:50.568613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:05:50.570171 [info ] [MainThread]: 
10:05:50.589348 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
10:05:50.590427 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_marts.mart_daily_sales......................... [RUN]
10:05:50.591503 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
10:05:50.592327 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
10:05:50.593030 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
10:05:50.596590 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
10:05:50.605424 [debug] [Thread-1  ]: finished collecting timing info
10:05:50.606338 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
10:05:50.624791 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
10:05:50.633722 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
10:05:50.634558 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
10:05:50.635244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:53.778759 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.14 seconds
10:05:53.786658 [debug] [Thread-1  ]: finished collecting timing info
10:05:53.940416 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
10:05:54.010370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3414b76670>]}
10:05:54.011549 [info ] [Thread-1  ]: 1 of 9 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 3.42s]
10:05:54.012447 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
10:05:54.013878 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
10:05:54.014682 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
10:05:54.015924 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
10:05:54.016994 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
10:05:54.017788 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
10:05:54.021212 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
10:05:54.028043 [debug] [Thread-1  ]: finished collecting timing info
10:05:54.028796 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
10:05:54.030786 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
10:05:54.063353 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
10:05:54.064238 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        date_block_num,
        
    TO_CHAR(DATEADD(
        month,
        date_block_num,
        (SELECT BASE_DATE FROM SALES_PIPELINE.STAGING.base_date)
    ), 'YYYY-MM')
 AS date_month,
        shop_id,
        item_id,
        SUM(item_price * item_cnt_day) AS monthly_revenue,
        SUM(item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num, shop_id, item_id
)

SELECT *
FROM base
      );
10:05:54.064850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:54.643920 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1ebd-0001-63bc-0001-57120004ed76
10:05:54.664371 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:05:54.665392 [debug] [Thread-1  ]: finished collecting timing info
10:05:54.666298 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
10:05:54.734006 [debug] [Thread-1  ]: Database Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
10:05:54.735333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f5e8c40>]}
10:05:54.736228 [error] [Thread-1  ]: 2 of 9 ERROR creating table model STAGING_marts.mart_monthly_sales.............. [[31mERROR[0m in 0.72s]
10:05:54.737224 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
10:05:54.738112 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
10:05:54.739025 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
10:05:54.740098 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
10:05:54.740725 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
10:05:54.741378 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
10:05:54.743928 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
10:05:54.752164 [debug] [Thread-1  ]: finished collecting timing info
10:05:54.752890 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
10:05:54.755320 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
10:05:54.763224 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
10:05:54.764108 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        date_block_num,
        
    TO_CHAR(DATEADD(
        month,
        date_block_num,
        (SELECT BASE_DATE FROM SALES_PIPELINE.STAGING.base_date)
    ), 'YYYY-MM')
 AS date_month,
        SUM(item_cnt_day * item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY date_block_num
)

SELECT
    date_block_num,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
10:05:54.764802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:55.350893 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1ebd-0001-63bb-0001-57120004fd2a
10:05:55.352221 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:05:55.353145 [debug] [Thread-1  ]: finished collecting timing info
10:05:55.353824 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
10:05:55.427895 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
10:05:55.429330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340fb651f0>]}
10:05:55.431032 [error] [Thread-1  ]: 3 of 9 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.69s]
10:05:55.432120 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
10:05:55.433045 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
10:05:55.434245 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_marts.mart_revenue_by_store.................... [RUN]
10:05:55.435312 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
10:05:55.436467 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
10:05:55.437352 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
10:05:55.439234 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
10:05:55.449494 [debug] [Thread-1  ]: finished collecting timing info
10:05:55.450511 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
10:05:55.453640 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
10:05:55.477158 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
10:05:55.477992 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
10:05:55.478642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:56.526522 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.05 seconds
10:05:56.528461 [debug] [Thread-1  ]: finished collecting timing info
10:05:56.529208 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
10:05:56.601635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f5d57c0>]}
10:05:56.603437 [info ] [Thread-1  ]: 4 of 9 OK created table model STAGING_marts.mart_revenue_by_store............... [[32mSUCCESS 1[0m in 1.17s]
10:05:56.604404 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
10:05:56.605380 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
10:05:56.606199 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
10:05:56.607296 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:05:56.608097 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
10:05:56.608985 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
10:05:56.611596 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:05:56.619517 [debug] [Thread-1  ]: finished collecting timing info
10:05:56.620294 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
10:05:56.622733 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:05:56.630371 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:05:56.631214 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
10:05:56.631933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:58.249271 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.62 seconds
10:05:58.251580 [debug] [Thread-1  ]: finished collecting timing info
10:05:58.252462 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
10:05:58.320954 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f5d58e0>]}
10:05:58.322586 [info ] [Thread-1  ]: 5 of 9 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 1.71s]
10:05:58.323835 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
10:05:58.324731 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
10:05:58.325495 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_marts.mart_top_item_categories................. [RUN]
10:05:58.326372 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
10:05:58.327062 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
10:05:58.327710 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
10:05:58.330721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
10:05:58.337984 [debug] [Thread-1  ]: finished collecting timing info
10:05:58.338831 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
10:05:58.340955 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
10:05:58.349017 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
10:05:58.350011 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
10:05:58.350744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:05:59.732871 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.38 seconds
10:05:59.735148 [debug] [Thread-1  ]: finished collecting timing info
10:05:59.736360 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
10:05:59.807314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f5d5a00>]}
10:05:59.823860 [info ] [Thread-1  ]: 6 of 9 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.48s]
10:05:59.825170 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
10:05:59.826225 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
10:05:59.827494 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_marts.mart_top_products........................ [RUN]
10:05:59.828417 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
10:05:59.829173 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
10:05:59.829752 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
10:05:59.831313 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
10:05:59.839460 [debug] [Thread-1  ]: finished collecting timing info
10:05:59.840310 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
10:05:59.842871 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
10:05:59.850318 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
10:05:59.851469 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
10:05:59.852275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:06:00.973915 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.12 seconds
10:06:00.976071 [debug] [Thread-1  ]: finished collecting timing info
10:06:00.976854 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
10:06:01.056680 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f5d5b50>]}
10:06:01.057929 [info ] [Thread-1  ]: 7 of 9 OK created table model STAGING_marts.mart_top_products................... [[32mSUCCESS 1[0m in 1.23s]
10:06:01.058941 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
10:06:01.059806 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
10:06:01.060933 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_marts.mart_top_shops........................... [RUN]
10:06:01.061841 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
10:06:01.062631 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
10:06:01.063373 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
10:06:01.065930 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
10:06:01.073643 [debug] [Thread-1  ]: finished collecting timing info
10:06:01.074605 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
10:06:01.077880 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
10:06:01.088565 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
10:06:01.100645 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
10:06:01.104891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:06:02.443366 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.34 seconds
10:06:02.445383 [debug] [Thread-1  ]: finished collecting timing info
10:06:02.446460 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
10:06:02.510125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f5d5c40>]}
10:06:02.511516 [info ] [Thread-1  ]: 8 of 9 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.45s]
10:06:02.512532 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
10:06:02.513432 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
10:06:02.514368 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_marts.mart_total_revenue....................... [RUN]
10:06:02.515431 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
10:06:02.516164 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
10:06:02.516756 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
10:06:02.518925 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
10:06:02.526119 [debug] [Thread-1  ]: finished collecting timing info
10:06:02.527110 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
10:06:02.529265 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
10:06:02.537475 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
10:06:02.538511 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
10:06:02.539509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:06:03.492875 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.95 seconds
10:06:03.494938 [debug] [Thread-1  ]: finished collecting timing info
10:06:03.495799 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
10:06:03.569117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e7d82f-9674-4e57-853b-9fa718597ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f5d5d30>]}
10:06:03.570354 [info ] [Thread-1  ]: 9 of 9 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.05s]
10:06:03.571181 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
10:06:03.573276 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:06:03.574492 [info ] [MainThread]: 
10:06:03.575537 [info ] [MainThread]: Finished running 9 table models in 16.49s.
10:06:03.576302 [debug] [MainThread]: Connection 'master' was properly closed.
10:06:03.576921 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
10:06:03.600563 [info ] [MainThread]: 
10:06:03.601799 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
10:06:03.603000 [info ] [MainThread]: 
10:06:03.603945 [error] [MainThread]: [33mDatabase Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)[0m
10:06:03.604960 [error] [MainThread]:   002003 (02000): SQL compilation error:
10:06:03.606049 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:06:03.606945 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
10:06:03.607679 [info ] [MainThread]: 
10:06:03.608671 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
10:06:03.609562 [error] [MainThread]:   002003 (02000): SQL compilation error:
10:06:03.610265 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:06:03.610911 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
10:06:03.611589 [info ] [MainThread]: 
10:06:03.612385 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
10:06:03.613564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340dd576a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3414b766d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a340f637af0>]}


============================== 2025-08-03 10:43:29.965090 | d2d95731-c95e-4aaa-bcf3-56e58c651a47 ==============================
10:43:29.965090 [info ] [MainThread]: Running with dbt=1.0.0
10:43:29.966239 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
10:43:29.967655 [debug] [MainThread]: Tracking: tracking
10:43:29.968343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c8a864af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c8a864a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c8a864a30>]}
10:47:51.838635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
10:47:51.840013 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_monthly_sales.sql
10:47:51.840601 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
10:47:51.855122 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
10:47:51.871169 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
10:47:51.910387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c8808bf40>]}
10:47:51.945273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c897a9760>]}
10:47:51.946360 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:47:51.951509 [info ] [MainThread]: 
10:47:51.953305 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:47:51.956156 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
10:47:51.966470 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
10:47:51.967328 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
10:47:51.967871 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:47:55.240855 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.27 seconds
10:47:55.246147 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
10:47:55.315635 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
10:47:55.320795 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
10:47:55.321568 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
10:47:55.322122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:47:56.014822 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.69 seconds
10:47:56.017588 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
10:47:56.082959 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
10:47:56.084598 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
10:47:56.085232 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
10:47:56.085758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:47:56.616552 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.53 seconds
10:47:56.618387 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
10:47:56.681771 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
10:47:56.684034 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
10:47:56.684855 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
10:47:56.685576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:47:57.229262 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1ee7-0001-63bb-0001-57120004fd4e
10:47:57.230296 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
10:47:57.233026 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
10:47:57.233640 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
10:47:57.234364 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
10:47:57.299285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:47:57.300402 [info ] [MainThread]: 
10:47:57.316149 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
10:47:57.316978 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_marts.mart_daily_sales......................... [RUN]
10:47:57.317852 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
10:47:57.318443 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
10:47:57.318970 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
10:47:57.321848 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
10:47:57.329712 [debug] [Thread-1  ]: finished collecting timing info
10:47:57.330418 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
10:47:57.347039 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
10:47:57.354564 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
10:47:57.355382 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
10:47:57.356032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:02.299843 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.94 seconds
10:48:02.307828 [debug] [Thread-1  ]: finished collecting timing info
10:48:02.308649 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
10:48:02.370736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5a2e9dc0>]}
10:48:02.371789 [info ] [Thread-1  ]: 1 of 9 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 5.05s]
10:48:02.372513 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
10:48:02.373161 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
10:48:02.373750 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
10:48:02.374413 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
10:48:02.374958 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
10:48:02.375703 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
10:48:02.378419 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
10:48:02.389628 [debug] [Thread-1  ]: finished collecting timing info
10:48:02.390351 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
10:48:02.392095 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
10:48:02.400899 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
10:48:02.402873 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        s.shop_id,
        s.item_id,
        SUM(s.item_price * s.item_cnt_day) AS monthly_revenue,
        SUM(s.item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, date_month, s.shop_id, s.item_id
)

SELECT *
FROM base
      );
10:48:02.405030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:02.946018 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1ee8-0001-63bc-0001-57120004ed8a
10:48:02.946766 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:48:02.948356 [debug] [Thread-1  ]: finished collecting timing info
10:48:02.948978 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
10:48:03.010493 [debug] [Thread-1  ]: Database Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
10:48:03.011801 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5a2a6ac0>]}
10:48:03.012579 [error] [Thread-1  ]: 2 of 9 ERROR creating table model STAGING_marts.mart_monthly_sales.............. [[31mERROR[0m in 0.64s]
10:48:03.013242 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
10:48:03.013986 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
10:48:03.014718 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
10:48:03.015485 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
10:48:03.016507 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
10:48:03.018811 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
10:48:03.021393 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
10:48:03.032887 [debug] [Thread-1  ]: finished collecting timing info
10:48:03.035050 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
10:48:03.039496 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
10:48:03.050368 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
10:48:03.051052 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, date_month
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
10:48:03.052654 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:03.587323 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1ee8-0001-63bc-0001-57120004ed8e
10:48:03.588607 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:48:03.590333 [debug] [Thread-1  ]: finished collecting timing info
10:48:03.592867 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
10:48:03.656841 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
10:48:03.659877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5895d0d0>]}
10:48:03.660581 [error] [Thread-1  ]: 3 of 9 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.64s]
10:48:03.661158 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
10:48:03.661786 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
10:48:03.662448 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_marts.mart_revenue_by_store.................... [RUN]
10:48:03.663331 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
10:48:03.664250 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
10:48:03.664916 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
10:48:03.666679 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
10:48:03.681410 [debug] [Thread-1  ]: finished collecting timing info
10:48:03.682128 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
10:48:03.684153 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
10:48:03.696431 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
10:48:03.697158 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
10:48:03.697676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:04.855028 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.16 seconds
10:48:04.856851 [debug] [Thread-1  ]: finished collecting timing info
10:48:04.858306 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
10:48:04.918891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5a1d3ac0>]}
10:48:04.920640 [info ] [Thread-1  ]: 4 of 9 OK created table model STAGING_marts.mart_revenue_by_store............... [[32mSUCCESS 1[0m in 1.26s]
10:48:04.921858 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
10:48:04.924675 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
10:48:04.925521 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
10:48:04.926802 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:48:04.927306 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
10:48:04.927754 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
10:48:04.930721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:48:04.945402 [debug] [Thread-1  ]: finished collecting timing info
10:48:04.947577 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
10:48:04.951056 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:48:04.961828 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:48:04.963046 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
10:48:04.964058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:06.468743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.5 seconds
10:48:06.470473 [debug] [Thread-1  ]: finished collecting timing info
10:48:06.471092 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
10:48:06.531212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c58967640>]}
10:48:06.532139 [info ] [Thread-1  ]: 5 of 9 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 1.60s]
10:48:06.532825 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
10:48:06.533438 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
10:48:06.534990 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_marts.mart_top_item_categories................. [RUN]
10:48:06.535844 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
10:48:06.536487 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
10:48:06.537028 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
10:48:06.539193 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
10:48:06.548943 [debug] [Thread-1  ]: finished collecting timing info
10:48:06.549544 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
10:48:06.551494 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
10:48:06.560707 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
10:48:06.561264 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
10:48:06.561821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:07.922731 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.36 seconds
10:48:07.925744 [debug] [Thread-1  ]: finished collecting timing info
10:48:07.928782 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
10:48:07.993646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c589683d0>]}
10:48:07.996806 [info ] [Thread-1  ]: 6 of 9 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.46s]
10:48:07.997406 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
10:48:07.998065 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
10:48:07.998775 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_marts.mart_top_products........................ [RUN]
10:48:08.000509 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
10:48:08.001211 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
10:48:08.001884 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
10:48:08.003460 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
10:48:08.013998 [debug] [Thread-1  ]: finished collecting timing info
10:48:08.015010 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
10:48:08.018090 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
10:48:08.029633 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
10:48:08.030213 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
10:48:08.030713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:08.988590 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.96 seconds
10:48:08.990755 [debug] [Thread-1  ]: finished collecting timing info
10:48:08.992150 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
10:48:09.056772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5b586940>]}
10:48:09.058195 [info ] [Thread-1  ]: 7 of 9 OK created table model STAGING_marts.mart_top_products................... [[32mSUCCESS 1[0m in 1.06s]
10:48:09.059501 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
10:48:09.061106 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
10:48:09.061809 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_marts.mart_top_shops........................... [RUN]
10:48:09.062613 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
10:48:09.063192 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
10:48:09.065122 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
10:48:09.067840 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
10:48:09.079618 [debug] [Thread-1  ]: finished collecting timing info
10:48:09.080294 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
10:48:09.121668 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
10:48:09.132363 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
10:48:09.132967 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
10:48:09.133452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:10.290930 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.16 seconds
10:48:10.292820 [debug] [Thread-1  ]: finished collecting timing info
10:48:10.293383 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
10:48:10.358749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5a85b4c0>]}
10:48:10.360154 [info ] [Thread-1  ]: 8 of 9 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.30s]
10:48:10.361987 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
10:48:10.363135 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
10:48:10.364236 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_marts.mart_total_revenue....................... [RUN]
10:48:10.365120 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
10:48:10.365690 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
10:48:10.366177 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
10:48:10.368141 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
10:48:10.374853 [debug] [Thread-1  ]: finished collecting timing info
10:48:10.377343 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
10:48:10.380437 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
10:48:10.390862 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
10:48:10.391644 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
10:48:10.392108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:48:11.580269 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.19 seconds
10:48:11.583657 [debug] [Thread-1  ]: finished collecting timing info
10:48:11.584436 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
10:48:11.649154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2d95731-c95e-4aaa-bcf3-56e58c651a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5a2c28b0>]}
10:48:11.650058 [info ] [Thread-1  ]: 9 of 9 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.28s]
10:48:11.651765 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
10:48:11.654349 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:48:11.656002 [info ] [MainThread]: 
10:48:11.656656 [info ] [MainThread]: Finished running 9 table models in 19.70s.
10:48:11.658452 [debug] [MainThread]: Connection 'master' was properly closed.
10:48:11.659041 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
10:48:11.680604 [info ] [MainThread]: 
10:48:11.682231 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
10:48:11.684530 [info ] [MainThread]: 
10:48:11.685540 [error] [MainThread]: [33mDatabase Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)[0m
10:48:11.686361 [error] [MainThread]:   002003 (02000): SQL compilation error:
10:48:11.687143 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:48:11.687724 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
10:48:11.688359 [info ] [MainThread]: 
10:48:11.688959 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
10:48:11.689566 [error] [MainThread]:   002003 (02000): SQL compilation error:
10:48:11.690338 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:48:11.690999 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
10:48:11.691808 [info ] [MainThread]: 
10:48:11.692561 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
10:48:11.693305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c897b00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c897b0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c5a2e9760>]}


============================== 2025-08-03 10:50:08.691376 | 7f3f01e2-c7b8-4ede-a570-80efc68204e3 ==============================
10:50:08.691376 [info ] [MainThread]: Running with dbt=1.0.0
10:50:08.692363 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
10:50:08.693346 [debug] [MainThread]: Tracking: tracking
10:50:08.694706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725759bcdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725759bcda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725759bcda00>]}
10:55:05.178092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:55:05.179411 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
10:55:05.191886 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
10:55:05.232423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7257580380d0>]}
10:55:05.257110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725759aebf40>]}
10:55:05.259628 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:55:05.264166 [info ] [MainThread]: 
10:55:05.265024 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:55:05.266879 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
10:55:05.276311 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
10:55:05.277652 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
10:55:05.278181 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:55:06.327338 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.05 seconds
10:55:06.329646 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
10:55:06.406663 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
10:55:06.412056 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
10:55:06.418247 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
10:55:06.418831 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:55:07.105435 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1eef-0001-63bc-0001-57120004ed9a
10:55:07.106376 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
10:55:07.107625 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
10:55:07.108521 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
10:55:07.109154 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
10:55:07.174227 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
10:55:07.175908 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
10:55:07.176405 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
10:55:07.176798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:55:07.879680 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.7 seconds
10:55:07.882995 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
10:55:07.947451 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
10:55:07.949184 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
10:55:07.949997 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
10:55:07.950563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:55:08.488912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.54 seconds
10:55:08.490693 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
10:55:08.575610 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:55:08.576844 [info ] [MainThread]: 
10:55:08.596129 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
10:55:08.598165 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_marts.mart_daily_sales......................... [RUN]
10:55:08.599254 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
10:55:08.600231 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
10:55:08.601036 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
10:55:08.604116 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
10:55:08.617497 [debug] [Thread-1  ]: finished collecting timing info
10:55:08.618627 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
10:55:08.635404 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
10:55:08.647785 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
10:55:08.648547 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
10:55:08.649033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:12.758643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.11 seconds
10:55:12.767397 [debug] [Thread-1  ]: finished collecting timing info
10:55:12.768357 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
10:55:12.838385 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725759aebee0>]}
10:55:12.839478 [info ] [Thread-1  ]: 1 of 9 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 4.24s]
10:55:12.840318 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
10:55:12.842026 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
10:55:12.842774 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
10:55:12.844009 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
10:55:12.844707 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
10:55:12.845352 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
10:55:12.847874 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
10:55:12.870873 [debug] [Thread-1  ]: finished collecting timing info
10:55:12.872170 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
10:55:12.874513 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
10:55:12.881529 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
10:55:12.882934 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        s.shop_id,
        s.item_id,
        SUM(s.item_price * s.item_cnt_day) AS monthly_revenue,
        SUM(s.item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, date_month, s.shop_id, s.item_id
)

SELECT *
FROM base
      );
10:55:12.883542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:13.421665 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1eef-0001-63bc-0001-57120004eda2
10:55:13.426298 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:55:13.427106 [debug] [Thread-1  ]: finished collecting timing info
10:55:13.427668 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
10:55:13.497413 [debug] [Thread-1  ]: Database Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
10:55:13.498604 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d79280>]}
10:55:13.499937 [error] [Thread-1  ]: 2 of 9 ERROR creating table model STAGING_marts.mart_monthly_sales.............. [[31mERROR[0m in 0.65s]
10:55:13.503056 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
10:55:13.503793 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
10:55:13.504477 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
10:55:13.505370 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
10:55:13.506074 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
10:55:13.506573 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
10:55:13.508525 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
10:55:13.531258 [debug] [Thread-1  ]: finished collecting timing info
10:55:13.531956 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
10:55:13.533966 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
10:55:13.557137 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
10:55:13.560711 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM')
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
10:55:13.561941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:14.100918 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1eef-0001-63bb-0001-57120004fd6e
10:55:14.101692 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:55:14.102185 [debug] [Thread-1  ]: finished collecting timing info
10:55:14.102730 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
10:55:14.166112 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
10:55:14.167724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721da9a90>]}
10:55:14.168326 [error] [Thread-1  ]: 3 of 9 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.66s]
10:55:14.168890 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
10:55:14.169581 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
10:55:14.170181 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_marts.mart_revenue_by_store.................... [RUN]
10:55:14.170864 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
10:55:14.171427 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
10:55:14.172133 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
10:55:14.173558 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
10:55:14.181741 [debug] [Thread-1  ]: finished collecting timing info
10:55:14.182888 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
10:55:14.184756 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
10:55:14.200412 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
10:55:14.201627 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
10:55:14.202373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:15.309952 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.11 seconds
10:55:15.312007 [debug] [Thread-1  ]: finished collecting timing info
10:55:15.312916 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
10:55:15.384534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d644c0>]}
10:55:15.385528 [info ] [Thread-1  ]: 4 of 9 OK created table model STAGING_marts.mart_revenue_by_store............... [[32mSUCCESS 1[0m in 1.21s]
10:55:15.386265 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
10:55:15.387006 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
10:55:15.388042 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
10:55:15.388881 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:55:15.389482 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
10:55:15.389946 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
10:55:15.392206 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:55:15.399825 [debug] [Thread-1  ]: finished collecting timing info
10:55:15.401539 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
10:55:15.403584 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:55:15.411336 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
10:55:15.411897 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
10:55:15.412373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:16.888007 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.48 seconds
10:55:16.892268 [debug] [Thread-1  ]: finished collecting timing info
10:55:16.892957 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
10:55:16.954084 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d645e0>]}
10:55:16.955127 [info ] [Thread-1  ]: 5 of 9 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 1.57s]
10:55:16.955758 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
10:55:16.956283 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
10:55:16.956821 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_marts.mart_top_item_categories................. [RUN]
10:55:16.957454 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
10:55:16.960002 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
10:55:16.960547 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
10:55:16.963557 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
10:55:16.976825 [debug] [Thread-1  ]: finished collecting timing info
10:55:16.977443 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
10:55:16.979316 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
10:55:16.988613 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
10:55:16.989174 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
10:55:16.989670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:18.498021 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.51 seconds
10:55:18.499874 [debug] [Thread-1  ]: finished collecting timing info
10:55:18.500571 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
10:55:18.570918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d64700>]}
10:55:18.572072 [info ] [Thread-1  ]: 6 of 9 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.61s]
10:55:18.572905 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
10:55:18.573521 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
10:55:18.574234 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_marts.mart_top_products........................ [RUN]
10:55:18.574973 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
10:55:18.575560 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
10:55:18.576128 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
10:55:18.578689 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
10:55:18.591378 [debug] [Thread-1  ]: finished collecting timing info
10:55:18.591993 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
10:55:18.594562 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
10:55:18.603442 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
10:55:18.604208 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
10:55:18.604806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:19.609545 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
10:55:19.613032 [debug] [Thread-1  ]: finished collecting timing info
10:55:19.615945 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
10:55:19.678374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d64820>]}
10:55:19.679312 [info ] [Thread-1  ]: 7 of 9 OK created table model STAGING_marts.mart_top_products................... [[32mSUCCESS 1[0m in 1.10s]
10:55:19.680060 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
10:55:19.680711 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
10:55:19.681208 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_marts.mart_top_shops........................... [RUN]
10:55:19.681782 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
10:55:19.682179 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
10:55:19.682543 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
10:55:19.684547 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
10:55:19.695316 [debug] [Thread-1  ]: finished collecting timing info
10:55:19.696135 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
10:55:19.698087 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
10:55:19.707575 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
10:55:19.713028 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
10:55:19.713771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:21.229245 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.52 seconds
10:55:21.233119 [debug] [Thread-1  ]: finished collecting timing info
10:55:21.233932 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
10:55:21.298391 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d64970>]}
10:55:21.299457 [info ] [Thread-1  ]: 8 of 9 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.62s]
10:55:21.300201 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
10:55:21.300835 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
10:55:21.301329 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_marts.mart_total_revenue....................... [RUN]
10:55:21.301890 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
10:55:21.302285 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
10:55:21.302858 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
10:55:21.304607 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
10:55:21.313540 [debug] [Thread-1  ]: finished collecting timing info
10:55:21.314352 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
10:55:21.316247 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
10:55:21.328194 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
10:55:21.328822 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
10:55:21.329348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:55:22.433686 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.1 seconds
10:55:22.436423 [debug] [Thread-1  ]: finished collecting timing info
10:55:22.440906 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
10:55:22.506988 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3f01e2-c7b8-4ede-a570-80efc68204e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d64a60>]}
10:55:22.509331 [info ] [Thread-1  ]: 9 of 9 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.21s]
10:55:22.512164 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
10:55:22.515819 [debug] [MainThread]: Acquiring new snowflake connection "master"
10:55:22.519472 [info ] [MainThread]: 
10:55:22.523140 [info ] [MainThread]: Finished running 9 table models in 17.25s.
10:55:22.527138 [debug] [MainThread]: Connection 'master' was properly closed.
10:55:22.527822 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
10:55:22.529632 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
10:55:22.552264 [info ] [MainThread]: 
10:55:22.553131 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
10:55:22.553975 [info ] [MainThread]: 
10:55:22.555619 [error] [MainThread]: [33mDatabase Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)[0m
10:55:22.558238 [error] [MainThread]:   002003 (02000): SQL compilation error:
10:55:22.558846 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:55:22.559406 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
10:55:22.560062 [info ] [MainThread]: 
10:55:22.560651 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
10:55:22.561519 [error] [MainThread]:   002003 (02000): SQL compilation error:
10:55:22.562480 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
10:55:22.563080 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
10:55:22.563640 [info ] [MainThread]: 
10:55:22.564189 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
10:55:22.565051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d64040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725721d64190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725720cc29d0>]}


============================== 2025-08-03 10:57:41.620921 | db93ae24-12da-42cd-9bc2-60b294ef2710 ==============================
10:57:41.620921 [info ] [MainThread]: Running with dbt=1.0.0
10:57:41.621609 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
10:57:41.622363 [debug] [MainThread]: Tracking: tracking
10:57:41.622999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780ea64a6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780ea64a6a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780ea64a6a00>]}
10:57:41.650508 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
10:57:41.651276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db93ae24-12da-42cd-9bc2-60b294ef2710', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780ea64dcdf0>]}


============================== 2025-08-03 10:58:36.623957 | a99f1e8e-0a22-4d7f-99ec-b1a266849ff8 ==============================
10:58:36.623957 [info ] [MainThread]: Running with dbt=1.0.0
10:58:36.624660 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
10:58:36.625999 [debug] [MainThread]: Tracking: tracking
10:58:36.626726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ad2050af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ad2050a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ad2050a30>]}
10:58:36.655767 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
10:58:36.657630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a99f1e8e-0a22-4d7f-99ec-b1a266849ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722ad20936a0>]}


============================== 2025-08-03 10:58:48.006531 | 54b17630-10b9-4a44-98e0-204e408cac31 ==============================
10:58:48.006531 [info ] [MainThread]: Running with dbt=1.0.0
10:58:48.008219 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
10:58:48.008983 [debug] [MainThread]: Tracking: tracking
10:58:48.009924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4db646dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4db646da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4db646da00>]}
10:58:48.037947 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
10:58:48.039629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '54b17630-10b9-4a44-98e0-204e408cac31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4db64a4310>]}


============================== 2025-08-03 10:59:10.709946 | 600b0c66-ee2e-4a2b-a221-b40d0145070d ==============================
10:59:10.709946 [info ] [MainThread]: Running with dbt=1.0.0
10:59:10.712424 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
10:59:10.713898 [debug] [MainThread]: Tracking: tracking
10:59:10.716765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72065de0eaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72065de0ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72065de0ea30>]}


============================== 2025-08-03 11:01:28.350221 | c518b0a3-3da9-4a50-a5b0-531d7fe82d72 ==============================
11:01:28.350221 [info ] [MainThread]: Running with dbt=1.0.0
11:01:28.351115 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.clean.CleanTask'>, which='clean', rpc_method=None)
11:01:28.351993 [debug] [MainThread]: Tracking: tracking
11:01:28.352642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77512addb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77512addb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77512addbee0>]}
11:01:28.559693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77512adcfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775131a1b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775131a1b8e0>]}


============================== 2025-08-03 11:01:40.479089 | f4089309-9252-4ba6-9a94-111a13026188 ==============================
11:01:40.479089 [info ] [MainThread]: Running with dbt=1.0.0
11:01:40.480153 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:01:40.481010 [debug] [MainThread]: Tracking: tracking
11:01:40.481581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6114dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6114da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6114da00>]}
11:01:40.502799 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
11:01:40.503445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6118c790>]}
11:05:55.694739 [debug] [MainThread]: Parsing macros/date_utils.sql
11:05:55.701355 [debug] [MainThread]: Parsing macros/catalog.sql
11:05:55.703299 [debug] [MainThread]: Parsing macros/adapters.sql
11:05:55.726179 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
11:05:55.730752 [debug] [MainThread]: Parsing macros/materializations/merge.sql
11:05:55.733943 [debug] [MainThread]: Parsing macros/materializations/table.sql
11:05:55.736537 [debug] [MainThread]: Parsing macros/materializations/seed.sql
11:05:55.741066 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
11:05:55.748862 [debug] [MainThread]: Parsing macros/materializations/view.sql
11:05:55.751190 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
11:05:55.755743 [debug] [MainThread]: Parsing macros/materializations/configs.sql
11:05:55.758750 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
11:05:55.763533 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
11:05:55.774991 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
11:05:55.776964 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
11:05:55.780258 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
11:05:55.782437 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
11:05:55.789387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
11:05:55.796276 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
11:05:55.799173 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
11:05:55.802570 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
11:05:55.813991 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
11:05:55.817320 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
11:05:55.824917 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
11:05:55.827820 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
11:05:55.829355 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
11:05:55.831475 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
11:05:55.838610 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
11:05:55.846091 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
11:05:55.847983 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
11:05:55.855134 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
11:05:55.866401 [debug] [MainThread]: Parsing macros/etc/datetime.sql
11:05:55.872642 [debug] [MainThread]: Parsing macros/etc/statement.sql
11:05:55.876270 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
11:05:55.878199 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
11:05:55.880530 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
11:05:55.882307 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
11:05:55.884079 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
11:05:55.885356 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
11:05:55.886483 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
11:05:55.887622 [debug] [MainThread]: Parsing macros/adapters/columns.sql
11:05:55.894038 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
11:05:55.897493 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
11:05:55.899870 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
11:05:55.905576 [debug] [MainThread]: Parsing macros/adapters/schema.sql
11:05:55.907622 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
11:05:55.909844 [debug] [MainThread]: Parsing macros/adapters/relation.sql
11:05:55.915904 [debug] [MainThread]: Parsing tests/generic/builtin.sql
11:05:56.034492 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
11:05:56.047222 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
11:05:56.049862 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
11:05:56.052668 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
11:05:56.055541 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
11:05:56.058047 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
11:05:56.060196 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
11:05:56.062701 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
11:05:56.065002 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
11:05:56.066894 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
11:05:56.069281 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
11:05:56.071553 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
11:05:56.073511 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
11:05:56.075375 [debug] [MainThread]: 1699: static parser successfully parsed utils/base_date.sql
11:05:56.178120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f3af9d0a0>]}
11:05:56.207055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f3afbad90>]}
11:05:56.208312 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
11:05:56.216088 [info ] [MainThread]: 
11:05:56.217588 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:05:56.219021 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
11:05:56.227606 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
11:05:56.228469 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
11:05:56.229003 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:05:57.645017 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.42 seconds
11:05:57.648109 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
11:05:57.710082 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_STAGING_staging_marts"
11:05:57.713749 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_STAGING_staging_marts"
11:05:57.714539 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='sales_pipeline', schema='staging_staging_marts', identifier=None)"
11:05:57.718368 [debug] [ThreadPool]: Using snowflake connection "create_SALES_PIPELINE_STAGING_staging_marts"
11:05:57.719113 [debug] [ThreadPool]: On create_SALES_PIPELINE_STAGING_staging_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "create_SALES_PIPELINE_STAGING_staging_marts"} */
create schema if not exists SALES_PIPELINE.STAGING_staging_marts
11:05:57.719700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:05:58.263760 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.54 seconds
11:05:58.265183 [debug] [ThreadPool]: On create_SALES_PIPELINE_STAGING_staging_marts: Close
11:05:58.328639 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging_marts"
11:05:58.336712 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging_marts"
11:05:58.340443 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_staging_marts
11:05:58.341224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:05:58.887767 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.55 seconds
11:05:58.889463 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging_marts: Close
11:05:58.961822 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging_staging"
11:05:58.967241 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging_staging"
11:05:58.971373 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging_staging
11:05:58.972426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:05:59.644174 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bc-0001-57120004edba
11:05:59.648768 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
11:05:59.651903 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
11:05:59.652980 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
11:05:59.656753 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging_staging: Close
11:05:59.723314 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
11:05:59.726817 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
11:05:59.728934 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
11:05:59.731914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:06:00.376583 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bb-0001-57120004fd82
11:06:00.378376 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
11:06:00.379097 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
11:06:00.379783 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
11:06:00.380511 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
11:06:00.446953 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:06:00.447696 [info ] [MainThread]: 
11:06:00.460697 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
11:06:00.461609 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_staging_marts.mart_daily_sales................. [RUN]
11:06:00.462437 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
11:06:00.463112 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
11:06:00.463687 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
11:06:00.465761 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
11:06:00.493279 [debug] [Thread-1  ]: finished collecting timing info
11:06:00.493915 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
11:06:00.510025 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
11:06:00.534923 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
11:06:00.538200 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
11:06:00.540797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:01.059773 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bc-0001-57120004edbe
11:06:01.060711 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:01.061798 [debug] [Thread-1  ]: finished collecting timing info
11:06:01.062329 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
11:06:01.127554 [debug] [Thread-1  ]: Database Error in model mart_daily_sales (models/marts/mart_daily_sales.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_daily_sales.sql
11:06:01.128868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f3a13ba30>]}
11:06:01.129948 [error] [Thread-1  ]: 1 of 9 ERROR creating table model STAGING_staging_marts.mart_daily_sales........ [[31mERROR[0m in 0.67s]
11:06:01.132437 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
11:06:01.133552 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
11:06:01.134650 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_staging_marts.mart_monthly_sales............... [RUN]
11:06:01.137079 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
11:06:01.137962 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
11:06:01.138605 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
11:06:01.141194 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
11:06:01.154064 [debug] [Thread-1  ]: finished collecting timing info
11:06:01.154912 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
11:06:01.156806 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
11:06:01.178585 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
11:06:01.179324 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        s.shop_id,
        s.item_id,
        SUM(s.item_price * s.item_cnt_day) AS monthly_revenue,
        SUM(s.item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, date_month, s.shop_id, s.item_id
)

SELECT *
FROM base
      );
11:06:01.179867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:01.703049 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bb-0001-57120004fd86
11:06:01.704207 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:01.705689 [debug] [Thread-1  ]: finished collecting timing info
11:06:01.706440 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
11:06:01.767748 [debug] [Thread-1  ]: Database Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
11:06:01.771350 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f3a10eca0>]}
11:06:01.772163 [error] [Thread-1  ]: 2 of 9 ERROR creating table model STAGING_staging_marts.mart_monthly_sales...... [[31mERROR[0m in 0.63s]
11:06:01.772881 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
11:06:01.773707 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
11:06:01.774484 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_staging_marts.mart_revenue_by_month............ [RUN]
11:06:01.775241 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
11:06:01.775707 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
11:06:01.776131 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
11:06:01.778093 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
11:06:01.796734 [debug] [Thread-1  ]: finished collecting timing info
11:06:01.798372 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
11:06:01.802987 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
11:06:01.813468 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
11:06:01.816726 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM')
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
11:06:01.818322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:02.322800 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bc-0001-57120004edc2
11:06:02.325165 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:02.328618 [debug] [Thread-1  ]: finished collecting timing info
11:06:02.329862 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
11:06:02.399254 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
11:06:02.402819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f3827d760>]}
11:06:02.403915 [error] [Thread-1  ]: 3 of 9 ERROR creating table model STAGING_staging_marts.mart_revenue_by_month... [[31mERROR[0m in 0.63s]
11:06:02.405724 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
11:06:02.406707 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
11:06:02.409818 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_staging_marts.mart_revenue_by_store............ [RUN]
11:06:02.411347 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
11:06:02.412652 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
11:06:02.413580 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
11:06:02.415044 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
11:06:02.425748 [debug] [Thread-1  ]: finished collecting timing info
11:06:02.426646 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
11:06:02.428532 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
11:06:02.437576 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
11:06:02.438510 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
11:06:02.439135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:04.090176 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.65 seconds
11:06:04.097246 [debug] [Thread-1  ]: finished collecting timing info
11:06:04.099192 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
11:06:04.158646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6006ceb0>]}
11:06:04.159698 [info ] [Thread-1  ]: 4 of 9 OK created table model STAGING_staging_marts.mart_revenue_by_store....... [[32mSUCCESS 1[0m in 1.75s]
11:06:04.161944 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
11:06:04.164679 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
11:06:04.165862 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_staging_marts.mart_shop_category_matrix........ [RUN]
11:06:04.167615 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:06:04.170005 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
11:06:04.172608 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
11:06:04.176806 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:06:04.192392 [debug] [Thread-1  ]: finished collecting timing info
11:06:04.193328 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
11:06:04.195703 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:06:04.204563 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:06:04.205428 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
11:06:04.206028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:04.744696 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bb-0001-57120004fd8a
11:06:04.746526 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:04.748119 [debug] [Thread-1  ]: finished collecting timing info
11:06:04.750254 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
11:06:04.814733 [debug] [Thread-1  ]: Database Error in model mart_shop_category_matrix (models/marts/mart_shop_category_matrix.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_category_matrix.sql
11:06:04.817872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f38224250>]}
11:06:04.820106 [error] [Thread-1  ]: 5 of 9 ERROR creating table model STAGING_staging_marts.mart_shop_category_matrix [[31mERROR[0m in 0.65s]
11:06:04.822159 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
11:06:04.823431 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
11:06:04.824378 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_staging_marts.mart_top_item_categories......... [RUN]
11:06:04.825217 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
11:06:04.825913 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
11:06:04.826651 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
11:06:04.828996 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
11:06:04.844748 [debug] [Thread-1  ]: finished collecting timing info
11:06:04.846746 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
11:06:04.849413 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
11:06:04.862206 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
11:06:04.862859 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
11:06:04.864168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:05.384072 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bc-0001-57120004edca
11:06:05.385050 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:05.385741 [debug] [Thread-1  ]: finished collecting timing info
11:06:05.386352 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
11:06:05.453823 [debug] [Thread-1  ]: Database Error in model mart_top_item_categories (models/marts/mart_top_item_categories.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_top_item_categories.sql
11:06:05.454707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f38248820>]}
11:06:05.455342 [error] [Thread-1  ]: 6 of 9 ERROR creating table model STAGING_staging_marts.mart_top_item_categories [[31mERROR[0m in 0.63s]
11:06:05.455942 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
11:06:05.456569 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
11:06:05.457143 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_staging_marts.mart_top_products................ [RUN]
11:06:05.458032 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
11:06:05.458968 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
11:06:05.459482 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
11:06:05.461142 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
11:06:05.478074 [debug] [Thread-1  ]: finished collecting timing info
11:06:05.478741 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
11:06:05.481147 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
11:06:05.493060 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
11:06:05.493855 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
11:06:05.494309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:06.728876 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.23 seconds
11:06:06.731540 [debug] [Thread-1  ]: finished collecting timing info
11:06:06.734735 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
11:06:06.805705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f39aab280>]}
11:06:06.807316 [info ] [Thread-1  ]: 7 of 9 OK created table model STAGING_staging_marts.mart_top_products........... [[32mSUCCESS 1[0m in 1.35s]
11:06:06.808307 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
11:06:06.808894 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
11:06:06.809477 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_staging_marts.mart_top_shops................... [RUN]
11:06:06.810161 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
11:06:06.810642 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
11:06:06.811092 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
11:06:06.813564 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
11:06:06.824786 [debug] [Thread-1  ]: finished collecting timing info
11:06:06.827599 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
11:06:06.831508 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
11:06:06.842319 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
11:06:06.842944 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
11:06:06.843454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:07.378150 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bc-0001-57120004edd2
11:06:07.378949 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:07.379721 [debug] [Thread-1  ]: finished collecting timing info
11:06:07.381148 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
11:06:07.449760 [debug] [Thread-1  ]: Database Error in model mart_top_shops (models/marts/mart_top_shops.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_top_shops.sql
11:06:07.450691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f38248250>]}
11:06:07.451299 [error] [Thread-1  ]: 8 of 9 ERROR creating table model STAGING_staging_marts.mart_top_shops.......... [[31mERROR[0m in 0.64s]
11:06:07.451879 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
11:06:07.452362 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
11:06:07.452885 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_staging_marts.mart_total_revenue............... [RUN]
11:06:07.453698 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
11:06:07.454487 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
11:06:07.455091 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
11:06:07.457158 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
11:06:07.464940 [debug] [Thread-1  ]: finished collecting timing info
11:06:07.465564 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
11:06:07.467828 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
11:06:07.483627 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
11:06:07.487114 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_staging_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
11:06:07.487852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:06:08.161371 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1efa-0001-63bb-0001-57120004fd8e
11:06:08.164366 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.166682 [debug] [Thread-1  ]: finished collecting timing info
11:06:08.169378 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
11:06:08.240662 [debug] [Thread-1  ]: Database Error in model mart_total_revenue (models/marts/mart_total_revenue.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_total_revenue.sql
11:06:08.241833 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4089309-9252-4ba6-9a94-111a13026188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f381e69a0>]}
11:06:08.242783 [error] [Thread-1  ]: 9 of 9 ERROR creating table model STAGING_staging_marts.mart_total_revenue...... [[31mERROR[0m in 0.79s]
11:06:08.243642 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
11:06:08.245336 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:06:08.248714 [info ] [MainThread]: 
11:06:08.251443 [info ] [MainThread]: Finished running 9 table models in 12.03s.
11:06:08.252478 [debug] [MainThread]: Connection 'master' was properly closed.
11:06:08.252964 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
11:06:08.275059 [info ] [MainThread]: 
11:06:08.276013 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
11:06:08.276896 [info ] [MainThread]: 
11:06:08.279209 [error] [MainThread]: [33mDatabase Error in model mart_daily_sales (models/marts/mart_daily_sales.sql)[0m
11:06:08.280671 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:06:08.281393 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.282130 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_daily_sales.sql
11:06:08.282823 [info ] [MainThread]: 
11:06:08.284711 [error] [MainThread]: [33mDatabase Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)[0m
11:06:08.285450 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:06:08.286184 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.286884 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
11:06:08.287915 [info ] [MainThread]: 
11:06:08.288579 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
11:06:08.289189 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:06:08.289675 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.290151 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
11:06:08.290836 [info ] [MainThread]: 
11:06:08.291398 [error] [MainThread]: [33mDatabase Error in model mart_shop_category_matrix (models/marts/mart_shop_category_matrix.sql)[0m
11:06:08.292006 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:06:08.292509 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.292998 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_category_matrix.sql
11:06:08.293492 [info ] [MainThread]: 
11:06:08.293977 [error] [MainThread]: [33mDatabase Error in model mart_top_item_categories (models/marts/mart_top_item_categories.sql)[0m
11:06:08.294524 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:06:08.295057 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.295499 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_top_item_categories.sql
11:06:08.296079 [info ] [MainThread]: 
11:06:08.296909 [error] [MainThread]: [33mDatabase Error in model mart_top_shops (models/marts/mart_top_shops.sql)[0m
11:06:08.297910 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:06:08.298545 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.299104 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_top_shops.sql
11:06:08.299726 [info ] [MainThread]: 
11:06:08.300285 [error] [MainThread]: [33mDatabase Error in model mart_total_revenue (models/marts/mart_total_revenue.sql)[0m
11:06:08.301043 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:06:08.301597 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING_STAGING_STAGING' does not exist or not authorized.
11:06:08.303543 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_total_revenue.sql
11:06:08.304437 [info ] [MainThread]: 
11:06:08.305197 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=7 SKIP=0 TOTAL=9
11:06:08.305834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6006cbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f6006cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705f381e1a90>]}


============================== 2025-08-03 11:07:06.013878 | 01f08a58-1dcc-4f7e-8312-0b3f8bc6cefa ==============================
11:07:06.013878 [info ] [MainThread]: Running with dbt=1.0.0
11:07:06.014759 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.clean.CleanTask'>, which='clean', rpc_method=None)
11:07:06.015453 [debug] [MainThread]: Tracking: tracking
11:07:06.016264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb4a0fc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb4a0fcc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb4a0fc790>]}
11:07:06.087803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb4a0e2df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb4a0e2eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71fb4fd3bb80>]}


============================== 2025-08-03 11:07:10.692006 | 72ab4c08-cbe1-4d58-b170-51322018213b ==============================
11:07:10.692006 [info ] [MainThread]: Running with dbt=1.0.0
11:07:10.692812 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['path:models/marts'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:07:10.693473 [debug] [MainThread]: Tracking: tracking
11:07:10.694072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3b0613a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3b0613a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3b06139d0>]}
11:07:10.710990 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
11:07:10.711565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3b064efa0>]}
11:12:21.640950 [debug] [MainThread]: Parsing macros/date_utils.sql
11:12:21.648008 [debug] [MainThread]: Parsing macros/catalog.sql
11:12:21.650285 [debug] [MainThread]: Parsing macros/adapters.sql
11:12:21.673138 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
11:12:21.674588 [debug] [MainThread]: Parsing macros/materializations/merge.sql
11:12:21.677217 [debug] [MainThread]: Parsing macros/materializations/table.sql
11:12:21.679536 [debug] [MainThread]: Parsing macros/materializations/seed.sql
11:12:21.683098 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
11:12:21.689610 [debug] [MainThread]: Parsing macros/materializations/view.sql
11:12:21.691844 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
11:12:21.697303 [debug] [MainThread]: Parsing macros/materializations/configs.sql
11:12:21.699538 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
11:12:21.704084 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
11:12:21.714732 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
11:12:21.716913 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
11:12:21.720317 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
11:12:21.721957 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
11:12:21.728682 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
11:12:21.735527 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
11:12:21.737566 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
11:12:21.743214 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
11:12:21.755147 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
11:12:21.757830 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
11:12:21.763356 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
11:12:21.766207 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
11:12:21.768186 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
11:12:21.770586 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
11:12:21.775638 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
11:12:21.782975 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
11:12:21.784566 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
11:12:21.791216 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
11:12:21.801415 [debug] [MainThread]: Parsing macros/etc/datetime.sql
11:12:21.806938 [debug] [MainThread]: Parsing macros/etc/statement.sql
11:12:21.810171 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
11:12:21.811637 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
11:12:21.813504 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
11:12:21.815100 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
11:12:21.816356 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
11:12:21.817212 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
11:12:21.818084 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
11:12:21.818772 [debug] [MainThread]: Parsing macros/adapters/columns.sql
11:12:21.824841 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
11:12:21.828266 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
11:12:21.830666 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
11:12:21.835214 [debug] [MainThread]: Parsing macros/adapters/schema.sql
11:12:21.836986 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
11:12:21.839223 [debug] [MainThread]: Parsing macros/adapters/relation.sql
11:12:21.845347 [debug] [MainThread]: Parsing tests/generic/builtin.sql
11:12:21.963661 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
11:12:21.978212 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
11:12:21.980645 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
11:12:21.983483 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
11:12:21.988678 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
11:12:21.993823 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
11:12:21.995778 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
11:12:21.997980 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
11:12:22.004463 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
11:12:22.006454 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
11:12:22.008581 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
11:12:22.015529 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
11:12:22.017636 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
11:12:22.019414 [debug] [MainThread]: 1699: static parser successfully parsed utils/base_date.sql
11:12:22.125664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ad494fa0>]}
11:12:22.158776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ad52a580>]}
11:12:22.159494 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
11:12:22.169228 [info ] [MainThread]: 
11:12:22.170383 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:12:22.172196 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
11:12:22.184299 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
11:12:22.185070 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
11:12:22.185621 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:12:23.515862 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.33 seconds
11:12:23.517957 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
11:12:23.585151 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
11:12:23.590244 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
11:12:23.590804 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
11:12:23.591219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:12:24.137413 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.55 seconds
11:12:24.141690 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
11:12:24.210293 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
11:12:24.212594 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
11:12:24.215862 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
11:12:24.216418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:12:24.761703 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.55 seconds
11:12:24.763522 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
11:12:24.830282 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
11:12:24.834156 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
11:12:24.836512 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
11:12:24.838189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:12:25.471956 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1f00-0001-63bb-0001-57120004fd9e
11:12:25.473950 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
11:12:25.475282 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
11:12:25.479267 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
11:12:25.481674 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
11:12:25.548548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:12:25.549702 [info ] [MainThread]: 
11:12:25.564363 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
11:12:25.565775 [info ] [Thread-1  ]: 1 of 9 START table model STAGING_marts.mart_daily_sales......................... [RUN]
11:12:25.566740 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
11:12:25.567320 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
11:12:25.567862 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
11:12:25.569915 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
11:12:25.588070 [debug] [Thread-1  ]: finished collecting timing info
11:12:25.588688 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
11:12:25.604570 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
11:12:25.623512 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
11:12:25.624075 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.STAGING_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
11:12:25.624536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:28.828301 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.2 seconds
11:12:28.835889 [debug] [Thread-1  ]: finished collecting timing info
11:12:28.838834 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
11:12:28.913164 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ac104dc0>]}
11:12:28.916150 [info ] [Thread-1  ]: 1 of 9 OK created table model STAGING_marts.mart_daily_sales.................... [[32mSUCCESS 1[0m in 3.35s]
11:12:28.918094 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
11:12:28.920506 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
11:12:28.921871 [info ] [Thread-1  ]: 2 of 9 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
11:12:28.923766 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
11:12:28.925223 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
11:12:28.925839 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
11:12:28.928117 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
11:12:28.944510 [debug] [Thread-1  ]: finished collecting timing info
11:12:28.946026 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
11:12:28.947818 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
11:12:28.960941 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
11:12:28.961699 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        s.shop_id,
        s.item_id,
        SUM(s.item_price * s.item_cnt_day) AS monthly_revenue,
        SUM(s.item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, date_month, s.shop_id, s.item_id
)

SELECT *
FROM base
      );
11:12:28.962192 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:29.488881 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f00-0001-63bc-0001-57120004edda
11:12:29.489962 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
11:12:29.493244 [debug] [Thread-1  ]: finished collecting timing info
11:12:29.495810 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
11:12:29.565600 [debug] [Thread-1  ]: Database Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
11:12:29.567695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ac046df0>]}
11:12:29.568525 [error] [Thread-1  ]: 2 of 9 ERROR creating table model STAGING_marts.mart_monthly_sales.............. [[31mERROR[0m in 0.64s]
11:12:29.569222 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
11:12:29.569890 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
11:12:29.572241 [info ] [Thread-1  ]: 3 of 9 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
11:12:29.573134 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
11:12:29.573776 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
11:12:29.575330 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
11:12:29.577344 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
11:12:29.592121 [debug] [Thread-1  ]: finished collecting timing info
11:12:29.593335 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
11:12:29.595403 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
11:12:29.609604 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
11:12:29.610680 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM')
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
11:12:29.611155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:30.141435 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f00-0001-63bb-0001-57120004fda2
11:12:30.142389 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
11:12:30.144043 [debug] [Thread-1  ]: finished collecting timing info
11:12:30.144544 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
11:12:30.205972 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
11:12:30.207650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ac046f10>]}
11:12:30.210302 [error] [Thread-1  ]: 3 of 9 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.63s]
11:12:30.212344 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
11:12:30.215232 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
11:12:30.217223 [info ] [Thread-1  ]: 4 of 9 START table model STAGING_marts.mart_revenue_by_store.................... [RUN]
11:12:30.219352 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
11:12:30.221483 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
11:12:30.224434 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
11:12:30.227319 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
11:12:30.251175 [debug] [Thread-1  ]: finished collecting timing info
11:12:30.253871 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
11:12:30.255888 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
11:12:30.275719 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
11:12:30.276380 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
11:12:30.277031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:31.301512 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.02 seconds
11:12:31.303338 [debug] [Thread-1  ]: finished collecting timing info
11:12:31.304776 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
11:12:31.370974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf362706760>]}
11:12:31.374403 [info ] [Thread-1  ]: 4 of 9 OK created table model STAGING_marts.mart_revenue_by_store............... [[32mSUCCESS 1[0m in 1.15s]
11:12:31.375143 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
11:12:31.375757 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
11:12:31.376911 [info ] [Thread-1  ]: 5 of 9 START table model STAGING_marts.mart_shop_category_matrix................ [RUN]
11:12:31.379349 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:12:31.380696 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
11:12:31.382865 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
11:12:31.385250 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:12:31.400653 [debug] [Thread-1  ]: finished collecting timing info
11:12:31.402508 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
11:12:31.406157 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:12:31.423409 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
11:12:31.424562 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
11:12:31.425125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:33.875854 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.45 seconds
11:12:33.877591 [debug] [Thread-1  ]: finished collecting timing info
11:12:33.878191 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
11:12:33.947004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ac1048b0>]}
11:12:33.949099 [info ] [Thread-1  ]: 5 of 9 OK created table model STAGING_marts.mart_shop_category_matrix........... [[32mSUCCESS 1[0m in 2.57s]
11:12:33.949870 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
11:12:33.950436 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
11:12:33.950984 [info ] [Thread-1  ]: 6 of 9 START table model STAGING_marts.mart_top_item_categories................. [RUN]
11:12:33.951672 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
11:12:33.952421 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
11:12:33.953365 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
11:12:33.956948 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
11:12:33.974843 [debug] [Thread-1  ]: finished collecting timing info
11:12:33.975958 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
11:12:33.977975 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
11:12:33.991401 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
11:12:33.992012 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
11:12:33.992593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:35.360376 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.37 seconds
11:12:35.362418 [debug] [Thread-1  ]: finished collecting timing info
11:12:35.363236 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
11:12:35.428508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ac104130>]}
11:12:35.432584 [info ] [Thread-1  ]: 6 of 9 OK created table model STAGING_marts.mart_top_item_categories............ [[32mSUCCESS 1[0m in 1.48s]
11:12:35.434195 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
11:12:35.435007 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
11:12:35.436494 [info ] [Thread-1  ]: 7 of 9 START table model STAGING_marts.mart_top_products........................ [RUN]
11:12:35.438411 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
11:12:35.438945 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
11:12:35.440063 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
11:12:35.441334 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
11:12:35.460991 [debug] [Thread-1  ]: finished collecting timing info
11:12:35.461594 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
11:12:35.464071 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
11:12:35.487343 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
11:12:35.488040 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
11:12:35.489257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:36.607638 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.12 seconds
11:12:36.609760 [debug] [Thread-1  ]: finished collecting timing info
11:12:36.610416 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
11:12:36.676083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ac104d90>]}
11:12:36.677499 [info ] [Thread-1  ]: 7 of 9 OK created table model STAGING_marts.mart_top_products................... [[32mSUCCESS 1[0m in 1.24s]
11:12:36.678161 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
11:12:36.678923 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
11:12:36.679871 [info ] [Thread-1  ]: 8 of 9 START table model STAGING_marts.mart_top_shops........................... [RUN]
11:12:36.681234 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
11:12:36.681881 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
11:12:36.682324 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
11:12:36.684366 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
11:12:36.696840 [debug] [Thread-1  ]: finished collecting timing info
11:12:36.697594 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
11:12:36.701335 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
11:12:36.715100 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
11:12:36.716366 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
11:12:36.718584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:37.950811 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.23 seconds
11:12:37.953407 [debug] [Thread-1  ]: finished collecting timing info
11:12:37.954530 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
11:12:38.020718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3626c45e0>]}
11:12:38.021974 [info ] [Thread-1  ]: 8 of 9 OK created table model STAGING_marts.mart_top_shops...................... [[32mSUCCESS 1[0m in 1.34s]
11:12:38.022621 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
11:12:38.023705 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
11:12:38.024384 [info ] [Thread-1  ]: 9 of 9 START table model STAGING_marts.mart_total_revenue....................... [RUN]
11:12:38.025314 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
11:12:38.025864 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
11:12:38.026354 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
11:12:38.028943 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
11:12:38.042048 [debug] [Thread-1  ]: finished collecting timing info
11:12:38.043551 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
11:12:38.046634 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
11:12:38.069585 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
11:12:38.071052 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
11:12:38.071644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:12:39.410192 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.34 seconds
11:12:39.412572 [debug] [Thread-1  ]: finished collecting timing info
11:12:39.415988 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
11:12:39.484255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72ab4c08-cbe1-4d58-b170-51322018213b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3626d2040>]}
11:12:39.485595 [info ] [Thread-1  ]: 9 of 9 OK created table model STAGING_marts.mart_total_revenue.................. [[32mSUCCESS 1[0m in 1.46s]
11:12:39.487218 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
11:12:39.491157 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:12:39.491968 [info ] [MainThread]: 
11:12:39.492815 [info ] [MainThread]: Finished running 9 table models in 17.32s.
11:12:39.493534 [debug] [MainThread]: Connection 'master' was properly closed.
11:12:39.494281 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_total_revenue' was properly closed.
11:12:39.514717 [info ] [MainThread]: 
11:12:39.517412 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
11:12:39.519816 [info ] [MainThread]: 
11:12:39.520559 [error] [MainThread]: [33mDatabase Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)[0m
11:12:39.521168 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:12:39.522560 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
11:12:39.523150 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
11:12:39.525349 [info ] [MainThread]: 
11:12:39.526988 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
11:12:39.528139 [error] [MainThread]:   002003 (02000): SQL compilation error:
11:12:39.530330 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
11:12:39.530957 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
11:12:39.531546 [info ] [MainThread]: 
11:12:39.533049 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
11:12:39.534094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3af593b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3af593fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bf3ac104550>]}


============================== 2025-08-03 11:59:34.541981 | 210023e8-6504-459b-868e-6ecee77d4fbe ==============================
11:59:34.541981 [info ] [MainThread]: Running with dbt=1.0.0
11:59:34.543012 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:59:34.543632 [debug] [MainThread]: Tracking: tracking
11:59:34.544442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990b2f05af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990b2f05a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990b2f05a30>]}
12:04:29.227989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:04:29.229378 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
12:04:29.243869 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
12:04:29.309541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '210023e8-6504-459b-868e-6ecee77d4fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990b01400d0>]}
12:04:29.346579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '210023e8-6504-459b-868e-6ecee77d4fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990b2f49070>]}
12:04:29.348005 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:04:29.351328 [info ] [MainThread]: 
12:04:29.352543 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:04:29.353870 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:04:29.362777 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:04:29.363519 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:04:29.364071 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:04:30.495639 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.13 seconds
12:04:30.498757 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:04:30.572629 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
12:04:30.578491 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
12:04:30.579676 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
12:04:30.581915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:04:31.267471 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1f34-0001-63bb-0001-57120004fdde
12:04:31.269189 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:04:31.269931 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:04:31.271606 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:04:31.272205 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
12:04:31.337890 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:04:31.340397 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:04:31.343455 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:04:31.344458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:04:31.885465 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.54 seconds
12:04:31.887399 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:04:31.954549 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:04:31.956169 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:04:31.956778 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:04:31.957693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:04:32.485246 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.53 seconds
12:04:32.489271 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:04:32.561691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:04:32.564753 [info ] [MainThread]: 
12:04:32.581026 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
12:04:32.584040 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
12:04:32.585474 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:04:32.587361 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
12:04:32.592477 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
12:04:32.596791 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:04:32.617736 [debug] [Thread-1  ]: finished collecting timing info
12:04:32.619684 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
12:04:32.635346 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:04:32.656902 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:04:32.657519 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num;
12:04:32.658021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:04:33.192662 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f34-0001-63bb-0001-57120004fdea
12:04:33.195714 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 23 unexpected ';'.
12:04:33.198284 [debug] [Thread-1  ]: finished collecting timing info
12:04:33.198891 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
12:04:33.265363 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 23 unexpected ';'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:04:33.268237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '210023e8-6504-459b-868e-6ecee77d4fbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990aa88d6d0>]}
12:04:33.270758 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.68s]
12:04:33.271537 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
12:04:33.273101 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:04:33.274154 [info ] [MainThread]: 
12:04:33.275066 [info ] [MainThread]: Finished running 1 table model in 3.92s.
12:04:33.276910 [debug] [MainThread]: Connection 'master' was properly closed.
12:04:33.278735 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
12:04:33.309500 [info ] [MainThread]: 
12:04:33.311281 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:04:33.312589 [info ] [MainThread]: 
12:04:33.313719 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
12:04:33.314453 [error] [MainThread]:   001003 (42000): SQL compilation error:
12:04:33.316304 [error] [MainThread]:   syntax error line 17 at position 23 unexpected ';'.
12:04:33.317635 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:04:33.321267 [info ] [MainThread]: 
12:04:33.323612 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:04:33.324935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990b0111dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990b2f05a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7990aa85bc10>]}


============================== 2025-08-03 12:05:01.469622 | 1f391421-ff58-4ffc-9d01-97e8dc166221 ==============================
12:05:01.469622 [info ] [MainThread]: Running with dbt=1.0.0
12:05:01.471972 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.clean.CleanTask'>, which='clean', rpc_method=None)
12:05:01.474050 [debug] [MainThread]: Tracking: tracking
12:05:01.475821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876025627c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876025621f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787602562820>]}
12:05:01.580108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787602558880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7876025581f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78760819fac0>]}


============================== 2025-08-03 12:05:06.216037 | b676499d-a66d-4a27-8b9d-b3b4fbf4f9ae ==============================
12:05:06.216037 [info ] [MainThread]: Running with dbt=1.0.0
12:05:06.218474 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:05:06.221013 [debug] [MainThread]: Tracking: tracking
12:05:06.221660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79667b7cfaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79667b7cfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79667b7cfa30>]}
12:05:06.241302 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:05:06.242074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b676499d-a66d-4a27-8b9d-b3b4fbf4f9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79667c823610>]}
12:09:41.392164 [debug] [MainThread]: Parsing macros/date_utils.sql
12:09:41.399185 [debug] [MainThread]: Parsing macros/catalog.sql
12:09:41.401272 [debug] [MainThread]: Parsing macros/adapters.sql
12:09:41.425946 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:09:41.427484 [debug] [MainThread]: Parsing macros/materializations/merge.sql
12:09:41.430368 [debug] [MainThread]: Parsing macros/materializations/table.sql
12:09:41.433098 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:09:41.437043 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:09:41.443764 [debug] [MainThread]: Parsing macros/materializations/view.sql
12:09:41.445527 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:09:41.448508 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:09:41.450965 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:09:41.455571 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:09:41.466117 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:09:41.468287 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:09:41.471873 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:09:41.474113 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:09:41.482447 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:09:41.489476 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:09:41.491214 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:09:41.494439 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:09:41.504986 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:09:41.507385 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:09:41.511903 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:09:41.513878 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:09:41.515085 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:09:41.517413 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:09:41.523451 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:09:41.530918 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:09:41.532664 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:09:41.541545 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:09:41.553021 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:09:41.558764 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:09:41.562124 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:09:41.563647 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:09:41.566578 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:09:41.568215 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:09:41.569581 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:09:41.570890 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:09:41.572057 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:09:41.572913 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:09:41.579397 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:09:41.583035 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:09:41.585386 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:09:41.590328 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:09:41.592311 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:09:41.594348 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:09:41.600638 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:09:41.727772 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
12:09:41.740705 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
12:09:41.743628 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
12:09:41.746092 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
12:09:41.749252 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
12:09:41.751750 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
12:09:41.754464 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
12:09:41.756781 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
12:09:41.758956 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
12:09:41.761507 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
12:09:41.763472 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
12:09:41.765790 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
12:09:41.767846 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
12:09:41.770397 [debug] [MainThread]: 1699: static parser successfully parsed utils/base_date.sql
12:09:41.875585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils
- models.dbt_sales_pipeline.marts.utils

12:09:41.880815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b676499d-a66d-4a27-8b9d-b3b4fbf4f9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79667964f0a0>]}
12:09:41.903529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b676499d-a66d-4a27-8b9d-b3b4fbf4f9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7966796e5c70>]}
12:09:41.904429 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:09:41.907065 [info ] [MainThread]: 
12:09:41.908033 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:09:41.909979 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:09:41.919185 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:09:41.920007 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:09:41.920548 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:09:43.246755 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.33 seconds
12:09:43.248734 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:09:43.322552 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:09:43.328467 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:09:43.329884 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:09:43.330424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:09:44.054536 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.72 seconds
12:09:44.056337 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:09:44.122736 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:09:44.124389 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:09:44.124855 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:09:44.125228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:09:44.678872 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.55 seconds
12:09:44.680642 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:09:44.762452 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
12:09:44.764438 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
12:09:44.764919 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
12:09:44.765274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:09:45.306282 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1f39-0001-63bb-0001-57120004fdf6
12:09:45.306982 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:09:45.307431 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:09:45.308248 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:09:45.308790 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
12:09:45.373045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:09:45.373847 [info ] [MainThread]: 
12:09:45.388745 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
12:09:45.389574 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
12:09:45.390342 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:09:45.391196 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
12:09:45.392296 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
12:09:45.394601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:09:45.413485 [debug] [Thread-1  ]: finished collecting timing info
12:09:45.414273 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
12:09:45.429964 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:09:45.449524 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:09:45.450138 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num;
12:09:45.450909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:09:45.984646 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f39-0001-63bb-0001-57120004fdfa
12:09:45.987297 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 23 unexpected ';'.
12:09:45.988422 [debug] [Thread-1  ]: finished collecting timing info
12:09:45.990391 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
12:09:46.055491 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 23 unexpected ';'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:09:46.056351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b676499d-a66d-4a27-8b9d-b3b4fbf4f9ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796678299fd0>]}
12:09:46.057316 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.67s]
12:09:46.058182 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
12:09:46.060937 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:09:46.062066 [info ] [MainThread]: 
12:09:46.062900 [info ] [MainThread]: Finished running 1 table model in 4.15s.
12:09:46.063526 [debug] [MainThread]: Connection 'master' was properly closed.
12:09:46.064822 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
12:09:46.103302 [info ] [MainThread]: 
12:09:46.108264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:09:46.109340 [info ] [MainThread]: 
12:09:46.109962 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
12:09:46.113870 [error] [MainThread]:   001003 (42000): SQL compilation error:
12:09:46.115154 [error] [MainThread]:   syntax error line 17 at position 23 unexpected ';'.
12:09:46.115748 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:09:46.117641 [info ] [MainThread]: 
12:09:46.121589 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:09:46.122330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7966787be040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7966787be850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796678298370>]}


============================== 2025-08-03 12:10:21.369164 | a4274e3f-6ce1-4e72-9536-db123ff0f3a0 ==============================
12:10:21.369164 [info ] [MainThread]: Running with dbt=1.0.0
12:10:21.371123 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:10:21.372284 [debug] [MainThread]: Tracking: tracking
12:10:21.374168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fed0542af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fed0542a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fed0542a30>]}
12:14:49.345373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:14:49.352870 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
12:14:49.414382 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
12:14:49.481778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_sales_pipeline.marts.utils
- models.dbt_sales_pipeline.staging.utils

12:14:49.488090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4274e3f-6ce1-4e72-9536-db123ff0f3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fecd3a60d0>]}
12:14:49.527596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4274e3f-6ce1-4e72-9536-db123ff0f3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fed61ca730>]}
12:14:49.528682 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:14:49.534972 [info ] [MainThread]: 
12:14:49.536778 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:14:49.539446 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:14:49.550315 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:14:49.551633 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:14:49.552454 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:14:51.668109 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.12 seconds
12:14:51.674782 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:14:51.872139 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING"
12:14:51.878234 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING"
12:14:51.879052 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING"} */

    show terse objects in SALES_PIPELINE.STAGING
12:14:51.879603 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:14:52.617345 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01be1f3e-0001-63bb-0001-57120004fe06
12:14:52.618206 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
12:14:52.618998 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
12:14:52.619684 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
12:14:52.620504 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING: Close
12:14:52.687290 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:14:52.689457 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:14:52.690251 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:14:52.690885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:14:53.248725 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.56 seconds
12:14:53.251702 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:14:53.323561 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:14:53.326453 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:14:53.327379 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:14:53.328007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:14:53.871835 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.54 seconds
12:14:53.873959 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:14:53.951690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:14:53.953007 [info ] [MainThread]: 
12:14:53.969566 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
12:14:53.970541 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
12:14:53.972050 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:14:53.972713 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
12:14:53.973791 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
12:14:53.977049 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:14:53.985380 [debug] [Thread-1  ]: finished collecting timing info
12:14:53.986436 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
12:14:54.004126 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:14:54.012518 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:14:54.013538 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING.base_date b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
12:14:54.014336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:14:54.609763 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f3e-0001-63bb-0001-57120004fe0e
12:14:54.632136 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
12:14:54.633224 [debug] [Thread-1  ]: finished collecting timing info
12:14:54.634099 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
12:14:54.706360 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (02000): SQL compilation error:
  Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:14:54.708502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4274e3f-6ce1-4e72-9536-db123ff0f3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fec769c730>]}
12:14:54.709560 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.74s]
12:14:54.710410 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
12:14:54.712710 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:14:54.713670 [info ] [MainThread]: 
12:14:54.714518 [info ] [MainThread]: Finished running 1 table model in 5.18s.
12:14:54.715623 [debug] [MainThread]: Connection 'master' was properly closed.
12:14:54.716274 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
12:14:54.716940 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
12:14:54.731983 [info ] [MainThread]: 
12:14:54.733954 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:14:54.734961 [info ] [MainThread]: 
12:14:54.736964 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
12:14:54.737948 [error] [MainThread]:   002003 (02000): SQL compilation error:
12:14:54.739014 [error] [MainThread]:   Schema 'SALES_PIPELINE.STAGING' does not exist or not authorized.
12:14:54.739770 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:14:54.740761 [info ] [MainThread]: 
12:14:54.741561 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:14:54.765966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fec76f1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fec76f17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fec769cd60>]}


============================== 2025-08-03 12:50:07.781947 | 31502ffc-af7e-4904-acb0-c352aa909858 ==============================
12:50:07.781947 [info ] [MainThread]: Running with dbt=1.0.0
12:50:07.785494 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.clean.CleanTask'>, which='clean', rpc_method=None)
12:50:07.786389 [debug] [MainThread]: Tracking: tracking
12:50:07.787419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed3e740d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed3e740bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed3e740c10>]}
12:50:07.915151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed3e74d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed3e74d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ed3e74d1c0>]}


============================== 2025-08-03 12:50:18.941432 | a6b637a2-2563-4cd3-83e2-aa61f96d33c3 ==============================
12:50:18.941432 [info ] [MainThread]: Running with dbt=1.0.0
12:50:18.947966 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:50:18.948900 [debug] [MainThread]: Tracking: tracking
12:50:18.950093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045fa3d0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045fa3d0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045fa3d0af0>]}
12:50:18.984290 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:50:18.986125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a6b637a2-2563-4cd3-83e2-aa61f96d33c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045fb44ea60>]}
12:55:19.416481 [debug] [MainThread]: Parsing macros/date_utils.sql
12:55:19.423593 [debug] [MainThread]: Parsing macros/catalog.sql
12:55:19.425679 [debug] [MainThread]: Parsing macros/adapters.sql
12:55:19.448675 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:55:19.450208 [debug] [MainThread]: Parsing macros/materializations/merge.sql
12:55:19.453118 [debug] [MainThread]: Parsing macros/materializations/table.sql
12:55:19.455546 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:55:19.459082 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:55:19.464625 [debug] [MainThread]: Parsing macros/materializations/view.sql
12:55:19.466451 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:55:19.469648 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:55:19.471859 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:55:19.475974 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:55:19.486570 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:55:19.488491 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:55:19.491759 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:55:19.493386 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:55:19.500419 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:55:19.508117 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:55:19.509930 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:55:19.513307 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:55:19.523107 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:55:19.525713 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:55:19.530354 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:55:19.532523 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:55:19.533718 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:55:19.535914 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:55:19.540859 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:55:19.548131 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:55:19.549995 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:55:19.556644 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:55:19.567701 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:55:19.573350 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:55:19.576895 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:55:19.578769 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:55:19.580857 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:55:19.582427 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:55:19.583960 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:55:19.585059 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:55:19.586182 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:55:19.587445 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:55:19.593888 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:55:19.597174 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:55:19.599534 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:55:19.604672 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:55:19.606719 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:55:19.608782 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:55:19.615023 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:55:19.742492 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
12:55:19.762069 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
12:55:19.765468 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
12:55:19.767942 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
12:55:19.770882 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
12:55:19.773583 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
12:55:19.775768 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
12:55:19.778109 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
12:55:19.780488 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
12:55:19.782883 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
12:55:19.785137 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
12:55:19.787189 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
12:55:19.789680 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
12:55:19.792004 [debug] [MainThread]: 1699: static parser successfully parsed utils/base_date.sql
12:55:19.919622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

12:55:19.924348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6b637a2-2563-4cd3-83e2-aa61f96d33c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045f82ceac0>]}
12:55:19.955416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6b637a2-2563-4cd3-83e2-aa61f96d33c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045fb44e280>]}
12:55:19.956221 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:55:19.958803 [info ] [MainThread]: 
12:55:19.960000 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:55:19.961387 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:55:19.971836 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:55:19.972903 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:55:19.973520 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:55:21.479477 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.51 seconds
12:55:21.481774 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:55:21.554752 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:55:21.560865 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:55:21.561818 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:55:21.562629 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:55:22.251469 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.69 seconds
12:55:22.253414 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:55:22.320881 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:55:22.322918 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:55:22.323533 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:55:22.324152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:55:22.880482 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.56 seconds
12:55:22.882450 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:55:22.951719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:55:22.952859 [info ] [MainThread]: 
12:55:22.969287 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
12:55:22.993456 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
12:55:22.994846 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:55:22.995571 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
12:55:22.996440 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
12:55:22.999032 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:55:23.014006 [debug] [Thread-1  ]: finished collecting timing info
12:55:23.025519 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
12:55:23.043081 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
12:55:23.058640 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
12:55:23.059506 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING_staging.base_date b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
12:55:23.060105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:55:23.664225 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f67-0001-63bc-0001-57120004ee4a
12:55:23.678340 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SALES_PIPELINE.STAGING_STAGING.BASE_DATE' does not exist or not authorized.
12:55:23.679414 [debug] [Thread-1  ]: finished collecting timing info
12:55:23.680148 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
12:55:23.750974 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (42S02): SQL compilation error:
  Object 'SALES_PIPELINE.STAGING_STAGING.BASE_DATE' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:55:23.752451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6b637a2-2563-4cd3-83e2-aa61f96d33c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045b26b4d90>]}
12:55:23.753769 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.76s]
12:55:23.754786 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
12:55:23.757004 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:55:23.759625 [info ] [MainThread]: 
12:55:23.760417 [info ] [MainThread]: Finished running 1 table model in 3.80s.
12:55:23.761579 [debug] [MainThread]: Connection 'master' was properly closed.
12:55:23.762447 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
12:55:23.763253 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
12:55:23.781105 [info ] [MainThread]: 
12:55:23.782258 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:55:23.784496 [info ] [MainThread]: 
12:55:23.785511 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
12:55:23.786440 [error] [MainThread]:   002003 (42S02): SQL compilation error:
12:55:23.787415 [error] [MainThread]:   Object 'SALES_PIPELINE.STAGING_STAGING.BASE_DATE' does not exist or not authorized.
12:55:23.788498 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
12:55:23.790003 [info ] [MainThread]: 
12:55:23.790779 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:55:23.791561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045f825df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045b33d3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7045b26ac2b0>]}


============================== 2025-08-03 13:16:10.988237 | 3c431d3d-62c0-4230-a1c0-428849081ee6 ==============================
13:16:10.988237 [info ] [MainThread]: Running with dbt=1.0.0
13:16:11.001012 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:16:11.002118 [debug] [MainThread]: Tracking: tracking
13:16:11.003030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cafbe14e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cafbe14e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cafbe14e790>]}
13:20:03.861725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:20:03.871927 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_monthly_sales.sql
13:20:03.885439 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
13:20:03.931471 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:20:03.936184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c431d3d-62c0-4230-a1c0-428849081ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cafbc1e8fa0>]}
13:20:03.954418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c431d3d-62c0-4230-a1c0-428849081ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cafbe06dee0>]}
13:20:03.955369 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:20:03.976368 [info ] [MainThread]: 
13:20:03.977751 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:20:03.979128 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:20:03.989335 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:20:03.990314 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:20:03.990951 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:20:07.138679 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.15 seconds
13:20:07.147500 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:20:07.221183 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:20:07.226952 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:20:07.227860 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:20:07.228518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:20:07.824691 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.6 seconds
13:20:07.826804 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:20:07.893123 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:20:07.895289 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:20:07.896425 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:20:07.897079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:20:08.527942 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.63 seconds
13:20:08.529804 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:20:08.596011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:20:08.597009 [info ] [MainThread]: 
13:20:08.613523 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
13:20:08.618753 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
13:20:08.620301 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:20:08.621054 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
13:20:08.621580 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
13:20:08.623969 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:20:08.629963 [debug] [Thread-1  ]: finished collecting timing info
13:20:08.630799 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
13:20:08.647648 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:20:08.654718 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:20:08.655405 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN SALES_PIPELINE.STAGING_staging.base_date b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
13:20:08.656033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:20:09.245750 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f80-0001-63bb-0001-57120004fe2a
13:20:09.260219 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SALES_PIPELINE.STAGING_STAGING.BASE_DATE' does not exist or not authorized.
13:20:09.261156 [debug] [Thread-1  ]: finished collecting timing info
13:20:09.261969 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
13:20:09.330547 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  002003 (42S02): SQL compilation error:
  Object 'SALES_PIPELINE.STAGING_STAGING.BASE_DATE' does not exist or not authorized.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
13:20:09.331804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c431d3d-62c0-4230-a1c0-428849081ee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caf7eb81c40>]}
13:20:09.332768 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.71s]
13:20:09.333661 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
13:20:09.335949 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:20:09.336923 [info ] [MainThread]: 
13:20:09.337631 [info ] [MainThread]: Finished running 1 table model in 5.36s.
13:20:09.338451 [debug] [MainThread]: Connection 'master' was properly closed.
13:20:09.339063 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
13:20:09.355970 [info ] [MainThread]: 
13:20:09.357140 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:20:09.358018 [info ] [MainThread]: 
13:20:09.359192 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
13:20:09.360207 [error] [MainThread]:   002003 (42S02): SQL compilation error:
13:20:09.360942 [error] [MainThread]:   Object 'SALES_PIPELINE.STAGING_STAGING.BASE_DATE' does not exist or not authorized.
13:20:09.361625 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
13:20:09.362420 [info ] [MainThread]: 
13:20:09.363398 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:20:09.364388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cafbe00db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cafbe0a4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caf7ec12e80>]}


============================== 2025-08-03 13:22:27.977172 | 65fb39fc-3528-4bc4-81dd-f83af781a9d5 ==============================
13:22:27.977172 [info ] [MainThread]: Running with dbt=1.0.0
13:22:27.977863 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, defer=None, state=None, cls=<class 'dbt.task.clean.CleanTask'>, which='clean', rpc_method=None)
13:22:27.978418 [debug] [MainThread]: Tracking: tracking
13:22:27.980417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de7207d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de7207dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de7207d280>]}
13:22:28.046367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de72089a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de72089640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de72089070>]}


============================== 2025-08-03 13:22:33.248321 | ee8a01d5-ccf8-4d69-ae10-e63e43682bff ==============================
13:22:33.248321 [info ] [MainThread]: Running with dbt=1.0.0
13:22:33.249374 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:22:33.250062 [debug] [MainThread]: Tracking: tracking
13:22:33.250887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddcff2d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddcff2d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddcff2d7c0>]}
13:22:33.270274 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:22:33.271143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee8a01d5-ccf8-4d69-ae10-e63e43682bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddcff7b550>]}
13:27:45.161495 [debug] [MainThread]: Parsing macros/date_utils.sql
13:27:45.169134 [debug] [MainThread]: Parsing macros/catalog.sql
13:27:45.171394 [debug] [MainThread]: Parsing macros/adapters.sql
13:27:45.194422 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:27:45.196431 [debug] [MainThread]: Parsing macros/materializations/merge.sql
13:27:45.199562 [debug] [MainThread]: Parsing macros/materializations/table.sql
13:27:45.202012 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:27:45.205769 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:27:45.211771 [debug] [MainThread]: Parsing macros/materializations/view.sql
13:27:45.213237 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:27:45.216059 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:27:45.218175 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:27:45.222166 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:27:45.232907 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:27:45.234783 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:27:45.238044 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:27:45.239871 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:27:45.246933 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:27:45.254236 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:27:45.258401 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:27:45.261840 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:27:45.272511 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:27:45.274857 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:27:45.279719 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:27:45.282072 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:27:45.283336 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:27:45.286441 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:27:45.291945 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:27:45.299519 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:27:45.301303 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:27:45.308249 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:27:45.319091 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:27:45.324697 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:27:45.328406 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:27:45.330141 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:27:45.332141 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:27:45.333775 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:27:45.335041 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:27:45.335842 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:27:45.336694 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:27:45.337638 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:27:45.343948 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:27:45.347461 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:27:45.349597 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:27:45.354510 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:27:45.356663 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:27:45.358813 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:27:45.364955 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:27:45.490253 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
13:27:45.502271 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
13:27:45.504982 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
13:27:45.507114 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
13:27:45.510472 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
13:27:45.513225 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
13:27:45.515651 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
13:27:45.518017 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
13:27:45.520865 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
13:27:45.523009 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
13:27:45.526715 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
13:27:45.528931 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
13:27:45.531921 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
13:27:45.534132 [debug] [MainThread]: 1699: static parser successfully parsed utils/base_date.sql
13:27:45.639987 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:27:45.646490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee8a01d5-ccf8-4d69-ae10-e63e43682bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddccd930d0>]}
13:27:45.671855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee8a01d5-ccf8-4d69-ae10-e63e43682bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddccd931f0>]}
13:27:45.674449 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:27:45.677220 [info ] [MainThread]: 
13:27:45.678494 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:27:45.679780 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:27:45.689329 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:27:45.690186 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:27:45.690680 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:27:46.859383 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.17 seconds
13:27:46.862039 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:27:46.933700 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:27:46.939235 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:27:46.939928 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:27:46.940340 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:27:47.665604 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.73 seconds
13:27:47.668290 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:27:47.734268 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:27:47.738481 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:27:47.739254 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:27:47.739752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:48.299065 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.56 seconds
13:27:48.301269 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:27:48.364640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:27:48.365521 [info ] [MainThread]: 
13:27:48.380543 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:48.381369 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
13:27:48.382037 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:48.382602 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:48.383034 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
13:27:48.385078 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:48.401054 [debug] [Thread-1  ]: finished collecting timing info
13:27:48.401627 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:48.421124 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:48.436541 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:48.437553 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(DATE, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train
),
WITH sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN base_date_cte b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
13:27:48.438407 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:48.977647 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1f87-0001-63bc-0001-57120004ee56
13:27:48.978497 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 0 unexpected 'WITH'.
13:27:48.979129 [debug] [Thread-1  ]: finished collecting timing info
13:27:48.979642 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
13:27:49.048512 [debug] [Thread-1  ]: Database Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 0 unexpected 'WITH'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
13:27:49.049320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee8a01d5-ccf8-4d69-ae10-e63e43682bff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72dd871bb460>]}
13:27:49.049918 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_revenue_by_month........... [[31mERROR[0m in 0.67s]
13:27:49.051190 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:49.053176 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:27:49.053898 [info ] [MainThread]: 
13:27:49.054465 [info ] [MainThread]: Finished running 1 table model in 3.38s.
13:27:49.055041 [debug] [MainThread]: Connection 'master' was properly closed.
13:27:49.055631 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
13:27:49.056508 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
13:27:49.077856 [info ] [MainThread]: 
13:27:49.081217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:27:49.083771 [info ] [MainThread]: 
13:27:49.084647 [error] [MainThread]: [33mDatabase Error in model mart_revenue_by_month (models/marts/mart_revenue_by_month.sql)[0m
13:27:49.086205 [error] [MainThread]:   001003 (42000): SQL compilation error:
13:27:49.087060 [error] [MainThread]:   syntax error line 6 at position 0 unexpected 'WITH'.
13:27:49.087815 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_revenue_by_month.sql
13:27:49.088578 [info ] [MainThread]: 
13:27:49.089235 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:27:49.090004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddcfe59f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ddcfe59d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72dd87ec4730>]}


============================== 2025-08-03 13:31:25.876171 | 1ed011b9-e2a9-4a36-b975-41169b5f5923 ==============================
13:31:25.876171 [info ] [MainThread]: Running with dbt=1.0.0
13:31:25.877535 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_revenue_by_month'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:31:25.879994 [debug] [MainThread]: Tracking: tracking
13:31:25.880839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72914b52c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72914b52c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72914b52c7c0>]}
13:35:13.446152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:35:13.455256 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
13:35:13.469594 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
13:35:13.522700 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:35:13.527683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ed011b9-e2a9-4a36-b975-41169b5f5923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7291483a80d0>]}
13:35:13.560929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ed011b9-e2a9-4a36-b975-41169b5f5923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72914b445a30>]}
13:35:13.561757 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:35:13.576292 [info ] [MainThread]: 
13:35:13.577624 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:35:13.579088 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:35:13.588199 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:35:13.589401 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:35:13.590175 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:35:14.771911 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.18 seconds
13:35:14.774290 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:35:14.849629 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:35:14.856442 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:35:14.857678 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:35:14.858420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:35:15.568964 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.71 seconds
13:35:15.583222 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:35:15.648819 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:35:15.650597 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:35:15.651343 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:35:15.651850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:35:16.192759 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.54 seconds
13:35:16.194931 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:35:16.262320 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:35:16.263310 [info ] [MainThread]: 
13:35:16.278495 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
13:35:16.279482 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_revenue_by_month.................... [RUN]
13:35:16.280902 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:35:16.281678 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
13:35:16.282330 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
13:35:16.284502 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:35:16.308504 [debug] [Thread-1  ]: finished collecting timing info
13:35:16.309449 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
13:35:16.337860 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:35:16.345123 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:35:16.345801 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_revenue_by_month  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(DATE, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train
), sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    CROSS JOIN base_date_cte b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
13:35:16.346336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:35:18.583669 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.24 seconds
13:35:18.590681 [debug] [Thread-1  ]: finished collecting timing info
13:35:18.591572 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
13:35:18.665567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ed011b9-e2a9-4a36-b975-41169b5f5923', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729102f430d0>]}
13:35:18.666806 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_revenue_by_month............... [[32mSUCCESS 1[0m in 2.39s]
13:35:18.667658 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
13:35:18.669914 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:35:18.671064 [info ] [MainThread]: 
13:35:18.671676 [info ] [MainThread]: Finished running 1 table model in 5.09s.
13:35:18.672458 [debug] [MainThread]: Connection 'master' was properly closed.
13:35:18.673083 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_revenue_by_month' was properly closed.
13:35:18.686444 [info ] [MainThread]: 
13:35:18.687355 [info ] [MainThread]: [32mCompleted successfully[0m
13:35:18.688132 [info ] [MainThread]: 
13:35:18.689368 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
13:35:18.690363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72910340cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729102f8c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729102f8c460>]}


============================== 2025-08-03 14:00:00.252257 | d9497dc4-cce1-4eb6-851c-3c1a909ce112 ==============================
14:00:00.252257 [info ] [MainThread]: Running with dbt=1.0.0
14:00:00.254190 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_monthly_sales'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:00:00.255334 [debug] [MainThread]: Tracking: tracking
14:00:00.256766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09a00a0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09a00a0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e09a00a07c0>]}


============================== 2025-08-03 14:04:43.711194 | 70fbd13d-afd0-44c5-967f-8b747b2a459b ==============================
14:04:43.711194 [info ] [MainThread]: Running with dbt=1.0.0
14:04:43.712248 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_monthly_sales'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:04:43.713365 [debug] [MainThread]: Tracking: tracking
14:04:43.714199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788614d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788614d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788614d7c0>]}
14:08:56.803956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
14:08:56.806760 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_monthly_sales.sql
14:08:56.808932 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_revenue_by_month.sql
14:08:56.820586 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
14:08:56.837410 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
14:08:56.872792 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

14:08:56.878099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70fbd13d-afd0-44c5-967f-8b747b2a459b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78841bd0d0>]}
14:08:56.905583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70fbd13d-afd0-44c5-967f-8b747b2a459b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c78860a4ca0>]}
14:08:56.906781 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:08:56.909487 [info ] [MainThread]: 
14:08:56.910424 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:08:56.911821 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
14:08:56.924481 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
14:08:56.925380 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
14:08:56.926079 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:08:57.939159 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.01 seconds
14:08:57.941404 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
14:08:58.006615 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:08:58.013625 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:08:58.016422 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
14:08:58.018831 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:08:58.691536 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.67 seconds
14:08:58.694541 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
14:08:58.759969 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:08:58.761640 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:08:58.762328 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
14:08:58.762962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:08:59.333672 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.57 seconds
14:08:59.336904 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
14:08:59.406389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:08:59.408796 [info ] [MainThread]: 
14:08:59.428376 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
14:08:59.430667 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
14:08:59.432394 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
14:08:59.435043 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
14:08:59.436097 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
14:08:59.440401 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
14:08:59.447061 [debug] [Thread-1  ]: finished collecting timing info
14:08:59.449079 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
14:08:59.465487 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
14:08:59.480056 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
14:08:59.480616 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(DATE, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train
), base AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        s.shop_id,
        s.item_id,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue,
        SUM(s.item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train s
    CROSS JOIN base_date_cte b
    GROUP BY s.date_block_num, s.shop_id, s.item_id, b.base_date
)

SELECT *
FROM base
ORDER BY date_block_num, shop_id, item_id;
14:08:59.481101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:09:00.023350 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be1fb1-0001-63bb-0001-57120004fea6
14:09:00.024202 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 41 unexpected ';'.
14:09:00.025266 [debug] [Thread-1  ]: finished collecting timing info
14:09:00.025985 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
14:09:00.089153 [debug] [Thread-1  ]: Database Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 41 unexpected ';'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
14:09:00.090219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70fbd13d-afd0-44c5-967f-8b747b2a459b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c784a3d0ee0>]}
14:09:00.091056 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_monthly_sales.............. [[31mERROR[0m in 0.66s]
14:09:00.091856 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
14:09:00.093362 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:09:00.094258 [info ] [MainThread]: 
14:09:00.094959 [info ] [MainThread]: Finished running 1 table model in 3.18s.
14:09:00.095609 [debug] [MainThread]: Connection 'master' was properly closed.
14:09:00.096135 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
14:09:00.096533 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_monthly_sales' was properly closed.
14:09:00.109608 [info ] [MainThread]: 
14:09:00.112239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:09:00.113967 [info ] [MainThread]: 
14:09:00.114624 [error] [MainThread]: [33mDatabase Error in model mart_monthly_sales (models/marts/mart_monthly_sales.sql)[0m
14:09:00.115219 [error] [MainThread]:   001003 (42000): SQL compilation error:
14:09:00.115728 [error] [MainThread]:   syntax error line 20 at position 41 unexpected ';'.
14:09:00.116407 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_monthly_sales.sql
14:09:00.117017 [info ] [MainThread]: 
14:09:00.117703 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
14:09:00.118472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788614f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c788614f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c784a3d0d90>]}


============================== 2025-08-03 14:19:00.633035 | bf59441b-0178-45ed-b0d9-faed1b4960f4 ==============================
14:19:00.633035 [info ] [MainThread]: Running with dbt=1.0.0
14:19:00.634348 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_monthly_sales'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:19:00.635096 [debug] [MainThread]: Tracking: tracking
14:19:00.636015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcfa42e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcfa42e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcfa42e7c0>]}
14:21:18.433451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:21:18.435024 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_monthly_sales.sql
14:21:18.447014 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
14:21:18.483703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

14:21:18.487999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf59441b-0178-45ed-b0d9-faed1b4960f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcf80adf40>]}
14:21:18.507617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf59441b-0178-45ed-b0d9-faed1b4960f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcf9369af0>]}
14:21:18.510697 [info ] [MainThread]: Found 14 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:21:18.518265 [info ] [MainThread]: 
14:21:18.519210 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:21:18.520482 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
14:21:18.529260 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
14:21:18.529933 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
14:21:18.530492 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:19.869716 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.34 seconds
14:21:19.876965 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
14:21:19.957349 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:21:19.962739 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:21:19.963469 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
14:21:19.963994 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:21:20.664354 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.7 seconds
14:21:20.667129 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
14:21:20.740494 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:21:20.742818 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:21:20.743429 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
14:21:20.743912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:21:21.279254 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.54 seconds
14:21:21.288654 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
14:21:21.366665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:21:21.368706 [info ] [MainThread]: 
14:21:21.387152 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
14:21:21.387889 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_monthly_sales....................... [RUN]
14:21:21.388904 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
14:21:21.389424 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
14:21:21.389916 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
14:21:21.391165 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
14:21:21.395862 [debug] [Thread-1  ]: finished collecting timing info
14:21:21.396924 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
14:21:21.412418 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
14:21:21.417727 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
14:21:21.418108 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_monthly_sales  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(DATE, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train
), base AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        s.shop_id,
        s.item_id,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue,
        SUM(s.item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train s
    CROSS JOIN base_date_cte b
    GROUP BY s.date_block_num, s.shop_id, s.item_id, b.base_date
)

SELECT *
FROM base
ORDER BY date_block_num, shop_id, item_id
      );
14:21:21.418520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:21:25.225720 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.81 seconds
14:21:25.232638 [debug] [Thread-1  ]: finished collecting timing info
14:21:25.233279 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
14:21:25.301702 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf59441b-0178-45ed-b0d9-faed1b4960f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcd96c12b0>]}
14:21:25.302624 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_monthly_sales.................. [[32mSUCCESS 1[0m in 3.91s]
14:21:25.303304 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
14:21:25.305038 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:21:25.306221 [info ] [MainThread]: 
14:21:25.307104 [info ] [MainThread]: Finished running 1 table model in 6.79s.
14:21:25.307917 [debug] [MainThread]: Connection 'master' was properly closed.
14:21:25.311480 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
14:21:25.314215 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_monthly_sales' was properly closed.
14:21:25.326605 [info ] [MainThread]: 
14:21:25.327313 [info ] [MainThread]: [32mCompleted successfully[0m
14:21:25.328284 [info ] [MainThread]: 
14:21:25.329098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:21:25.333335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcf805bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcf805d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76dcd96be1c0>]}


============================== 2025-08-04 11:55:28.938463 | 7ccde3ac-b870-4015-a39b-8d2600da8b0e ==============================
11:55:28.938463 [info ] [MainThread]: Running with dbt=1.0.0
11:55:28.939810 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
11:55:28.941006 [debug] [MainThread]: Tracking: tracking
11:55:28.941684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e0294e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e0294e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e0294e7c0>]}
11:57:59.743370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
11:57:59.744555 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
11:57:59.757601 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
11:57:59.796212 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

11:57:59.801740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ccde3ac-b870-4015-a39b-8d2600da8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e007d4f40>]}
11:57:59.837280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ccde3ac-b870-4015-a39b-8d2600da8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e0298b220>]}
11:57:59.838074 [info ] [MainThread]: Found 15 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
11:57:59.840438 [info ] [MainThread]: 
11:57:59.841268 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:57:59.842524 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
11:57:59.851625 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
11:57:59.852746 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
11:57:59.853504 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:58:00.987820 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.13 seconds
11:58:00.990074 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
11:58:01.064436 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
11:58:01.069364 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
11:58:01.069989 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
11:58:01.070378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:58:01.680175 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.61 seconds
11:58:01.681879 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
11:58:01.750797 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
11:58:01.752746 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
11:58:01.753333 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
11:58:01.753684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:58:02.458423 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.7 seconds
11:58:02.460526 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
11:58:02.526295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:58:02.527197 [info ] [MainThread]: 
11:58:02.541909 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
11:58:02.542813 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
11:58:02.543746 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
11:58:02.544218 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
11:58:02.544930 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
11:58:02.547851 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
11:58:02.554187 [debug] [Thread-1  ]: finished collecting timing info
11:58:02.554787 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
11:58:02.573083 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
11:58:02.580602 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
11:58:02.581142 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', date) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT s.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
    ORDER BY revenue_per_item DESC
    LIMIT 10
)

SELECT * FROM final
      );
11:58:02.581535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:58:03.245206 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be24ce-0001-63bb-0001-57120005200e
11:58:03.246072 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function DATE_TRUNC does not support VARCHAR(16777216) argument type
11:58:03.246768 [debug] [Thread-1  ]: finished collecting timing info
11:58:03.247205 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
11:58:03.315854 [debug] [Thread-1  ]: Database Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(16777216) argument type
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
11:58:03.316928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ccde3ac-b870-4015-a39b-8d2600da8b0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e0002a430>]}
11:58:03.317676 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_shop_profile............... [[31mERROR[0m in 0.77s]
11:58:03.318465 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
11:58:03.320021 [debug] [MainThread]: Acquiring new snowflake connection "master"
11:58:03.320746 [info ] [MainThread]: 
11:58:03.321250 [info ] [MainThread]: Finished running 1 table model in 3.48s.
11:58:03.322029 [debug] [MainThread]: Connection 'master' was properly closed.
11:58:03.322640 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
11:58:03.350526 [info ] [MainThread]: 
11:58:03.351168 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:58:03.351769 [info ] [MainThread]: 
11:58:03.352602 [error] [MainThread]: [33mDatabase Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)[0m
11:58:03.353231 [error] [MainThread]:   002016 (22000): SQL compilation error:
11:58:03.353931 [error] [MainThread]:   Function DATE_TRUNC does not support VARCHAR(16777216) argument type
11:58:03.354730 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
11:58:03.355480 [info ] [MainThread]: 
11:58:03.356084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
11:58:03.356901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e02991c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e0286cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709e00055ac0>]}


============================== 2025-08-04 12:00:10.852808 | e4181519-0e0b-46b5-99ec-03d79fbe00c1 ==============================
12:00:10.852808 [info ] [MainThread]: Running with dbt=1.0.0
12:00:10.853962 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:00:10.854558 [debug] [MainThread]: Tracking: tracking
12:00:10.855159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bc554e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bc554e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bc554e790>]}
12:02:34.488696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:02:34.489614 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
12:02:34.500365 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
12:02:34.519204 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

12:02:34.525244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4181519-0e0b-46b5-99ec-03d79fbe00c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bc41e3fa0>]}
12:02:34.541570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4181519-0e0b-46b5-99ec-03d79fbe00c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bc558bc10>]}
12:02:34.542395 [info ] [MainThread]: Found 15 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:02:34.544448 [info ] [MainThread]: 
12:02:34.545334 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:02:34.546685 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:02:34.559797 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:02:34.560565 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:02:34.561090 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:02:35.623047 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.06 seconds
12:02:35.625047 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:02:35.696257 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:02:35.701563 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:02:35.702132 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:02:35.702523 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:02:36.415982 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.71 seconds
12:02:36.417569 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:02:36.492572 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:02:36.494269 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:02:36.494712 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:02:36.495036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:02:37.042700 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.55 seconds
12:02:37.044207 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:02:37.118389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:02:37.119292 [info ] [MainThread]: 
12:02:37.135890 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
12:02:37.136745 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
12:02:37.137742 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
12:02:37.138319 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
12:02:37.138932 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
12:02:37.141474 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
12:02:37.146934 [debug] [Thread-1  ]: finished collecting timing info
12:02:37.147606 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
12:02:37.164102 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
12:02:37.170298 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
12:02:37.170746 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date)) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT s.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
    ORDER BY revenue_per_item DESC
    LIMIT 10
)

SELECT * FROM final
      );
12:02:37.171093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:02:37.820300 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be24d2-0001-63bb-0001-571200052016
12:02:37.821055 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 23
invalid identifier 'S.ITEM_CATEGORY_ID'
12:02:37.821557 [debug] [Thread-1  ]: finished collecting timing info
12:02:37.821997 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
12:02:37.896964 [debug] [Thread-1  ]: Database Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)
  000904 (42000): SQL compilation error: error line 14 at position 23
  invalid identifier 'S.ITEM_CATEGORY_ID'
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
12:02:37.897915 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4181519-0e0b-46b5-99ec-03d79fbe00c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bbe574af0>]}
12:02:37.898716 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_shop_profile............... [[31mERROR[0m in 0.76s]
12:02:37.899500 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
12:02:37.901092 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:02:37.901680 [info ] [MainThread]: 
12:02:37.902156 [info ] [MainThread]: Finished running 1 table model in 3.36s.
12:02:37.902790 [debug] [MainThread]: Connection 'master' was properly closed.
12:02:37.903344 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
12:02:37.903738 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
12:02:37.914890 [info ] [MainThread]: 
12:02:37.915776 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:02:37.916672 [info ] [MainThread]: 
12:02:37.917519 [error] [MainThread]: [33mDatabase Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)[0m
12:02:37.918326 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 14 at position 23
12:02:37.919033 [error] [MainThread]:   invalid identifier 'S.ITEM_CATEGORY_ID'
12:02:37.919765 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
12:02:37.920544 [info ] [MainThread]: 
12:02:37.921420 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:02:37.922192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bc54b23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bc546ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6bbdfe8190>]}


============================== 2025-08-04 12:25:09.046599 | 0b646289-a6e6-4999-84bc-05ddeee61725 ==============================
12:25:09.046599 [info ] [MainThread]: Running with dbt=1.0.0
12:25:09.047969 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:25:09.048760 [debug] [MainThread]: Tracking: tracking
12:25:09.049445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75b38d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75b38d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75b38d7c0>]}
12:27:42.085027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:27:42.086176 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
12:27:42.097741 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
12:27:42.117400 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

12:27:42.122465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b646289-a6e6-4999-84bc-05ddeee61725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75921d0d0>]}
12:27:42.138274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b646289-a6e6-4999-84bc-05ddeee61725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75b3ca580>]}
12:27:42.138850 [info ] [MainThread]: Found 15 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:27:42.141163 [info ] [MainThread]: 
12:27:42.142257 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:27:42.143535 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:27:42.152214 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:27:42.153121 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:27:42.153796 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:27:45.545893 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.39 seconds
12:27:45.547900 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:27:46.003185 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:27:46.009009 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:27:46.009809 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:27:46.010359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:27:46.574170 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.56 seconds
12:27:46.575702 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:27:46.645882 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:27:46.648149 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:27:46.648728 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:27:46.649134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:27:47.191516 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.54 seconds
12:27:47.193287 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:27:47.262753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:27:47.263905 [info ] [MainThread]: 
12:27:47.282839 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
12:27:47.283692 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
12:27:47.284813 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
12:27:47.285407 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
12:27:47.285875 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
12:27:47.288800 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
12:27:47.294897 [debug] [Thread-1  ]: finished collecting timing info
12:27:47.295499 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
12:27:47.313296 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
12:27:47.321375 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
12:27:47.322062 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date)) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT i.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON s.item_id = i.item_id
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
    ORDER BY revenue_per_item DESC
    LIMIT 10
)

SELECT * FROM final;
12:27:47.322723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:27:48.035723 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be24eb-0001-63bb-0001-57120005208a
12:27:48.036317 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 45 at position 19 unexpected ';'.
12:27:48.036835 [debug] [Thread-1  ]: finished collecting timing info
12:27:48.037308 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
12:27:48.110820 [debug] [Thread-1  ]: Database Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)
  001003 (42000): SQL compilation error:
  syntax error line 45 at position 19 unexpected ';'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
12:27:48.111813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b646289-a6e6-4999-84bc-05ddeee61725', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75814c6d0>]}
12:27:48.112571 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_shop_profile............... [[31mERROR[0m in 0.83s]
12:27:48.113196 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
12:27:48.114870 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:27:48.115648 [info ] [MainThread]: 
12:27:48.116214 [info ] [MainThread]: Finished running 1 table model in 5.97s.
12:27:48.116958 [debug] [MainThread]: Connection 'master' was properly closed.
12:27:48.117530 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
12:27:48.128262 [info ] [MainThread]: 
12:27:48.129217 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:27:48.130386 [info ] [MainThread]: 
12:27:48.131189 [error] [MainThread]: [33mDatabase Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)[0m
12:27:48.131938 [error] [MainThread]:   001003 (42000): SQL compilation error:
12:27:48.132537 [error] [MainThread]:   syntax error line 45 at position 19 unexpected ';'.
12:27:48.133155 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
12:27:48.133760 [info ] [MainThread]: 
12:27:48.134395 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:27:48.135338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75b2f14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b75b2af4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79b758410520>]}


============================== 2025-08-04 12:37:10.702799 | 88336a52-b508-4fa9-b29b-ffb151acda74 ==============================
12:37:10.702799 [info ] [MainThread]: Running with dbt=1.0.0
12:37:10.704040 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:37:10.705025 [debug] [MainThread]: Tracking: tracking
12:37:10.705945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725550eae700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725550eae760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725550eae7c0>]}
12:40:43.900663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:40:43.902074 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
12:40:43.915102 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
12:40:43.952723 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

12:40:43.958074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88336a52-b508-4fa9-b29b-ffb151acda74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72554dd1dfd0>]}
12:40:43.999207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88336a52-b508-4fa9-b29b-ffb151acda74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725550eeb220>]}
12:40:44.000364 [info ] [MainThread]: Found 15 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:40:44.002927 [info ] [MainThread]: 
12:40:44.004114 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:40:44.005633 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
12:40:44.016297 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
12:40:44.017324 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
12:40:44.017973 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:40:47.316603 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.3 seconds
12:40:47.319098 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
12:40:47.392825 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:40:47.398467 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
12:40:47.399239 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
12:40:47.399680 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:40:47.987335 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.59 seconds
12:40:47.989431 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
12:40:48.060877 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:40:48.062806 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
12:40:48.063579 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
12:40:48.064213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:40:48.646220 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.58 seconds
12:40:48.648576 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
12:40:48.720045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:40:48.721172 [info ] [MainThread]: 
12:40:48.735563 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
12:40:48.736813 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
12:40:48.738262 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
12:40:48.739153 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
12:40:48.740561 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
12:40:48.743654 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
12:40:48.761078 [debug] [Thread-1  ]: finished collecting timing info
12:40:48.761826 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
12:40:48.778941 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
12:40:48.796187 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
12:40:48.797123 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date)) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT i.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON s.item_id = i.item_id
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
    ORDER BY revenue_per_item DESC
    LIMIT 10
)

SELECT * FROM final
      );
12:40:48.797926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:40:50.674297 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be24f8-0001-63bb-0001-57120005209a
12:40:50.675208 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100040 (22007): Date '15.01.2015' is not recognized
12:40:50.676063 [debug] [Thread-1  ]: finished collecting timing info
12:40:50.676906 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
12:40:50.750027 [debug] [Thread-1  ]: Database Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)
  100040 (22007): Date '15.01.2015' is not recognized
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
12:40:50.751348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88336a52-b508-4fa9-b29b-ffb151acda74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72554cee02b0>]}
12:40:50.752376 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_shop_profile............... [[31mERROR[0m in 2.01s]
12:40:50.753414 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
12:40:50.755199 [debug] [MainThread]: Acquiring new snowflake connection "master"
12:40:50.756310 [info ] [MainThread]: 
12:40:50.757097 [info ] [MainThread]: Finished running 1 table model in 6.75s.
12:40:50.757872 [debug] [MainThread]: Connection 'master' was properly closed.
12:40:50.758582 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
12:40:50.759511 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
12:40:50.785622 [info ] [MainThread]: 
12:40:50.786369 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:40:50.787236 [info ] [MainThread]: 
12:40:50.788207 [error] [MainThread]: [33mDatabase Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)[0m
12:40:50.789051 [error] [MainThread]:   100040 (22007): Date '15.01.2015' is not recognized
12:40:50.789877 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
12:40:50.790665 [info ] [MainThread]: 
12:40:50.791501 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:40:50.792693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72554fdafbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72554fdafc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72554c987430>]}


============================== 2025-08-04 12:58:19.480489 | 113be13d-0209-4d8d-8740-6c002fbe5a22 ==============================
12:58:19.480489 [info ] [MainThread]: Running with dbt=1.0.0
12:58:19.481507 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
12:58:19.482306 [debug] [MainThread]: Tracking: tracking
12:58:19.482911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71088d65f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71088d65f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71088d65f7c0>]}
13:01:05.410888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:01:05.413585 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
13:01:05.431025 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
13:01:05.462824 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:01:05.468627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '113be13d-0209-4d8d-8740-6c002fbe5a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71088c0ea0d0>]}
13:01:05.491233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '113be13d-0209-4d8d-8740-6c002fbe5a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71088d69c220>]}
13:01:05.492250 [info ] [MainThread]: Found 15 models, 30 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:01:05.495021 [info ] [MainThread]: 
13:01:05.496500 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:01:05.498166 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:01:05.508266 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:01:05.509425 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:01:05.510403 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:01:07.073116 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.56 seconds
13:01:07.076447 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:01:07.244598 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:01:07.250733 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:01:07.251757 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:01:07.252390 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:01:08.224918 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.97 seconds
13:01:08.228343 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:01:08.387103 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:01:08.389270 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:01:08.389992 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:01:08.390671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:01:09.276678 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.89 seconds
13:01:09.278808 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:01:09.512740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:01:09.513940 [info ] [MainThread]: 
13:01:09.530255 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
13:01:09.531316 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
13:01:09.532697 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:01:09.533437 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
13:01:09.534087 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
13:01:09.537796 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:01:09.546340 [debug] [Thread-1  ]: finished collecting timing info
13:01:09.547679 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
13:01:09.567144 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:01:09.576473 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:01:09.577422 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date, 'DD.MM.YYYY')) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT i.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON s.item_id = i.item_id
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
    ORDER BY revenue_per_item DESC
    LIMIT 10
)

SELECT * FROM final
      );
13:01:09.598233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:01:13.818458 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.22 seconds
13:01:13.827040 [debug] [Thread-1  ]: finished collecting timing info
13:01:13.828400 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
13:01:13.913038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '113be13d-0209-4d8d-8740-6c002fbe5a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7108848c89d0>]}
13:01:13.914302 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_shop_profile................... [[32mSUCCESS 1[0m in 4.38s]
13:01:13.915110 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
13:01:13.917097 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:01:13.918055 [info ] [MainThread]: 
13:01:13.918778 [info ] [MainThread]: Finished running 1 table model in 8.42s.
13:01:13.919680 [debug] [MainThread]: Connection 'master' was properly closed.
13:01:13.920335 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
13:01:13.920918 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
13:01:13.936963 [info ] [MainThread]: 
13:01:13.937895 [info ] [MainThread]: [32mCompleted successfully[0m
13:01:13.938857 [info ] [MainThread]: 
13:01:13.939960 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
13:01:13.941426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71088d661550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7108848c8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7108856c9850>]}


============================== 2025-08-04 13:52:36.871529 | 02a006f3-5cee-4a56-8240-026481ab425e ==============================
13:52:36.871529 [info ] [MainThread]: Running with dbt=1.0.0
13:52:36.872564 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:52:36.873424 [debug] [MainThread]: Tracking: tracking
13:52:36.874150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f85674e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f85674e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f85674e7c0>]}
13:55:12.985366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
13:55:12.987205 [debug] [MainThread]: Partial parsing: update schema file: dbt_sales_pipeline://models/marts/schema.yml
13:55:12.988008 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
13:55:13.003386 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
13:55:13.052813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:55:13.057904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02a006f3-5cee-4a56-8240-026481ab425e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f8545969d0>]}
13:55:13.075153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02a006f3-5cee-4a56-8240-026481ab425e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f85661d3a0>]}
13:55:13.076079 [info ] [MainThread]: Found 15 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:55:13.078332 [info ] [MainThread]: 
13:55:13.079693 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:55:13.081086 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:55:13.091137 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:55:13.091871 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:55:13.092484 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:55:14.557176 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.46 seconds
13:55:14.559702 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:55:14.630696 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:55:14.637054 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:55:14.638094 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:55:14.638847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:55:15.383870 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.75 seconds
13:55:15.385617 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:55:15.453717 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:55:15.455495 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:55:15.456149 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:55:15.456629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:55:16.014959 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.56 seconds
13:55:16.016579 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:55:16.082359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:55:16.083291 [info ] [MainThread]: 
13:55:16.098510 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
13:55:16.099411 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
13:55:16.100609 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:55:16.101088 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
13:55:16.101686 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
13:55:16.104471 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:55:16.111882 [debug] [Thread-1  ]: finished collecting timing info
13:55:16.112383 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
13:55:16.128731 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:55:16.135969 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:55:16.136738 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date, 'DD.MM.YYYY')) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT i.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON s.item_id = i.item_id
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
),

stats AS (
    SELECT
        MAX(category_count) AS max_category,
        MAX(avg_item_price) AS max_price,
        MAX(revenue_per_item) AS max_rev_per_item,
        MAX(monthly_revenue_variance) AS max_variance
    FROM final
)

SELECT
    f.shop_id,
    f.shop_name,
    ROUND(f.category_count / NULLIF(s.max_category, 0), 4) AS category_count,
    ROUND(f.avg_item_price / NULLIF(s.max_price, 0), 4) AS avg_item_price,
    ROUND(f.revenue_per_item / NULLIF(s.max_rev_per_item, 0), 4) AS revenue_per_item,
    ROUND(f.monthly_revenue_variance / NULLIF(s.max_variance, 0), 4) AS monthly_revenue_variance
FROM final f
CROSS JOIN stats s
ORDER BY revenue_per_item DESC
LIMIT 10;
13:55:16.137263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:55:16.675395 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be2543-0001-63bc-0001-57120005025a
13:55:16.676158 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 62 at position 8 unexpected ';'.
13:55:16.676749 [debug] [Thread-1  ]: finished collecting timing info
13:55:16.677152 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
13:55:16.746075 [debug] [Thread-1  ]: Database Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)
  001003 (42000): SQL compilation error:
  syntax error line 62 at position 8 unexpected ';'.
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
13:55:16.747048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02a006f3-5cee-4a56-8240-026481ab425e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f80f17f550>]}
13:55:16.747757 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_shop_profile............... [[31mERROR[0m in 0.65s]
13:55:16.748361 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
13:55:16.750012 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:55:16.750656 [info ] [MainThread]: 
13:55:16.751196 [info ] [MainThread]: Finished running 1 table model in 3.67s.
13:55:16.751993 [debug] [MainThread]: Connection 'master' was properly closed.
13:55:16.752577 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
13:55:16.764172 [info ] [MainThread]: 
13:55:16.765306 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:55:16.766188 [info ] [MainThread]: 
13:55:16.767294 [error] [MainThread]: [33mDatabase Error in model mart_shop_profile (models/marts/mart_shop_profile.sql)[0m
13:55:16.768175 [error] [MainThread]:   001003 (42000): SQL compilation error:
13:55:16.769276 [error] [MainThread]:   syntax error line 62 at position 8 unexpected ';'.
13:55:16.770119 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_shop_profile.sql
13:55:16.771029 [info ] [MainThread]: 
13:55:16.771989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:55:16.772883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f85678bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f85666fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73f80f1709a0>]}


============================== 2025-08-04 13:56:52.432115 | e443548c-8842-45ed-9342-f939a5db6d87 ==============================
13:56:52.432115 [info ] [MainThread]: Running with dbt=1.0.0
13:56:52.432916 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:56:52.433681 [debug] [MainThread]: Tracking: tracking
13:56:52.434362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aa05a4c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aa05a4c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aa05a4c7c0>]}
13:59:20.941826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
13:59:20.943699 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
13:59:20.957819 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
13:59:21.002153 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:59:21.007385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e443548c-8842-45ed-9342-f939a5db6d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aa04056fa0>]}
13:59:21.021544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e443548c-8842-45ed-9342-f939a5db6d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aa0497bd60>]}
13:59:21.022516 [info ] [MainThread]: Found 15 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:59:21.024779 [info ] [MainThread]: 
13:59:21.025721 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:59:21.026967 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:59:21.036002 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:59:21.036846 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:59:21.037405 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:59:22.230178 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.19 seconds
13:59:22.232129 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:59:22.305863 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:59:22.311490 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
13:59:22.312586 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
13:59:22.313475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:59:22.930271 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.62 seconds
13:59:22.932024 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
13:59:23.003164 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:59:23.004965 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
13:59:23.005551 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
13:59:23.006091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:59:23.675439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.67 seconds
13:59:23.677381 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
13:59:23.745545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:59:23.746396 [info ] [MainThread]: 
13:59:23.761061 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
13:59:23.762102 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
13:59:23.763249 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:59:23.763737 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
13:59:23.764194 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
13:59:23.767332 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:59:23.772493 [debug] [Thread-1  ]: finished collecting timing info
13:59:23.773052 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
13:59:23.790935 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:59:23.797108 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:59:23.797810 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date, 'DD.MM.YYYY')) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT i.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON s.item_id = i.item_id
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
),

stats AS (
    SELECT
        MAX(category_count) AS max_category,
        MAX(avg_item_price) AS max_price,
        MAX(revenue_per_item) AS max_rev_per_item,
        MAX(monthly_revenue_variance) AS max_variance
    FROM final
)

SELECT
    f.shop_id,
    f.shop_name,
    ROUND(f.category_count / NULLIF(s.max_category, 0), 4) AS category_count,
    ROUND(f.avg_item_price / NULLIF(s.max_price, 0), 4) AS avg_item_price,
    ROUND(f.revenue_per_item / NULLIF(s.max_rev_per_item, 0), 4) AS revenue_per_item,
    ROUND(f.monthly_revenue_variance / NULLIF(s.max_variance, 0), 4) AS monthly_revenue_variance
FROM final f
CROSS JOIN stats s
ORDER BY revenue_per_item DESC
LIMIT 10
      );
13:59:23.798494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:59:26.637807 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.84 seconds
13:59:26.646337 [debug] [Thread-1  ]: finished collecting timing info
13:59:26.647222 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
13:59:26.716958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e443548c-8842-45ed-9342-f939a5db6d87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a9f545ddc0>]}
13:59:26.717890 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_shop_profile................... [[32mSUCCESS 1[0m in 2.95s]
13:59:26.718408 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
13:59:26.720282 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:59:26.721025 [info ] [MainThread]: 
13:59:26.721565 [info ] [MainThread]: Finished running 1 table model in 5.70s.
13:59:26.722284 [debug] [MainThread]: Connection 'master' was properly closed.
13:59:26.722782 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
13:59:26.734851 [info ] [MainThread]: 
13:59:26.735696 [info ] [MainThread]: [32mCompleted successfully[0m
13:59:26.736419 [info ] [MainThread]: 
13:59:26.737148 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
13:59:26.738201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aa048bf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75aa048bffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a9f541ba90>]}


============================== 2025-08-04 14:38:18.177800 | 734e0367-6fa1-4475-bfcc-7ce5eaffa08f ==============================
14:38:18.177800 [info ] [MainThread]: Running with dbt=1.0.0
14:38:18.179184 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_shop_profile'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
14:38:18.180110 [debug] [MainThread]: Tracking: tracking
14:38:18.180936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a46606a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a4660700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a4660760>]}
14:40:48.568523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:40:48.569594 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_shop_profile.sql
14:40:48.582112 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
14:40:48.626901 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

14:40:48.631933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '734e0367-6fa1-4475-bfcc-7ce5eaffa08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a148ef10>]}
14:40:48.646881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '734e0367-6fa1-4475-bfcc-7ce5eaffa08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a35bccd0>]}
14:40:48.647504 [info ] [MainThread]: Found 15 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:40:48.649370 [info ] [MainThread]: 
14:40:48.650443 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:40:48.651832 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
14:40:48.660858 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
14:40:48.661968 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
14:40:48.662691 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:40:50.193916 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.53 seconds
14:40:50.196129 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
14:40:50.270093 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:40:50.275835 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
14:40:50.276522 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
14:40:50.277015 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:40:50.905850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.63 seconds
14:40:50.907367 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
14:40:50.975804 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:40:50.977598 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
14:40:50.978090 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
14:40:50.978487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:40:51.525369 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.55 seconds
14:40:51.527004 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
14:40:51.593650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:40:51.594435 [info ] [MainThread]: 
14:40:51.608226 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
14:40:51.608972 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_shop_profile........................ [RUN]
14:40:51.609938 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
14:40:51.610617 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
14:40:51.611118 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
14:40:51.613960 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
14:40:51.618520 [debug] [Thread-1  ]: finished collecting timing info
14:40:51.619047 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
14:40:51.635743 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
14:40:51.641658 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
14:40:51.642226 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date, 'DD.MM.YYYY')) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT i.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON s.item_id = i.item_id
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
    ORDER BY revenue_per_item DESC
    LIMIT 10
)

SELECT * FROM final
      );
14:40:51.642611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:40:55.017473 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.37 seconds
14:40:55.024324 [debug] [Thread-1  ]: finished collecting timing info
14:40:55.025085 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
14:40:55.093941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '734e0367-6fa1-4475-bfcc-7ce5eaffa08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a008c850>]}
14:40:55.094744 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_shop_profile................... [[32mSUCCESS 1[0m in 3.48s]
14:40:55.095525 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
14:40:55.097072 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:40:55.097870 [info ] [MainThread]: 
14:40:55.098412 [info ] [MainThread]: Finished running 1 table model in 6.45s.
14:40:55.098958 [debug] [MainThread]: Connection 'master' was properly closed.
14:40:55.099468 [debug] [MainThread]: Connection 'list_SALES_PIPELINE' was properly closed.
14:40:55.099935 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_shop_profile' was properly closed.
14:40:55.111077 [info ] [MainThread]: 
14:40:55.111939 [info ] [MainThread]: [32mCompleted successfully[0m
14:40:55.113121 [info ] [MainThread]: 
14:40:55.114036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
14:40:55.114832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a008c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a0096dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7745a00fd400>]}


============================== 2025-08-04 15:13:07.915311 | ae44da5d-70d4-417b-914e-038ff0193eab ==============================
15:13:07.915311 [info ] [MainThread]: Running with dbt=1.0.0
15:13:07.916495 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_item_monthly_consistency'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:13:07.917629 [debug] [MainThread]: Tracking: tracking
15:13:07.918336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746db4043700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746db4043760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746db40437c0>]}
15:15:38.559857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
15:15:38.561098 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_item_monthly_consistency.sql
15:15:38.572427 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_item_monthly_consistency.sql
15:15:38.596594 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

15:15:38.601480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae44da5d-70d4-417b-914e-038ff0193eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746db0ea30d0>]}
15:15:38.618457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae44da5d-70d4-417b-914e-038ff0193eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746db4045430>]}
15:15:38.619433 [info ] [MainThread]: Found 16 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
15:15:38.621565 [info ] [MainThread]: 
15:15:38.622589 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:15:38.623870 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
15:15:38.633114 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
15:15:38.633841 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
15:15:38.634337 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:15:39.827958 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.19 seconds
15:15:39.831871 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
15:15:39.912003 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
15:15:39.917594 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
15:15:39.918379 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
15:15:39.918871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:15:41.368489 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.45 seconds
15:15:41.370275 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
15:15:41.439865 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
15:15:41.441637 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
15:15:41.442222 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
15:15:41.442645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:15:42.028461 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.59 seconds
15:15:42.030912 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
15:15:42.103067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:15:42.104033 [info ] [MainThread]: 
15:15:42.119457 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_item_monthly_consistency
15:15:42.120366 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_item_monthly_consistency............ [RUN]
15:15:42.121526 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
15:15:42.122261 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_item_monthly_consistency
15:15:42.122926 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_item_monthly_consistency
15:15:42.125376 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
15:15:42.133151 [debug] [Thread-1  ]: finished collecting timing info
15:15:42.134029 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_item_monthly_consistency
15:15:42.150329 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
15:15:42.157784 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
15:15:42.158453 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_item_monthly_consistency"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_item_monthly_consistency  as
      (-- models/marts/mart_item_monthly_consistency.sql

WITH monthly_sales AS (
    SELECT
        DATE_BLOCK_NUM,
        ITEM_ID,
        SUM(ITEM_CNT_DAY * ITEM_PRICE) AS MONTHLY_REVENUE
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY DATE_BLOCK_NUM, ITEM_ID
),

item_total_revenue AS (
    SELECT
        ITEM_ID,
        SUM(MONTHLY_REVENUE) AS TOTAL_REVENUE
    FROM monthly_sales
    GROUP BY ITEM_ID
),

ranked_items AS (
    SELECT
        ITEM_ID,
        TOTAL_REVENUE,
        RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS REVENUE_RANK
    FROM item_total_revenue
),

filtered_top_items AS (
    SELECT
        ITEM_ID
    FROM ranked_items
    WHERE REVENUE_RANK <= 30
),

final_matrix AS (
    SELECT
        m.DATE_BLOCK_NUM,
        m.ITEM_ID,
        m.MONTHLY_REVENUE
    FROM monthly_sales m
    JOIN filtered_top_items t
    ON m.ITEM_ID = t.ITEM_ID
)

SELECT *
FROM final_matrix
      );
15:15:42.158953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:15:44.669550 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.51 seconds
15:15:44.676627 [debug] [Thread-1  ]: finished collecting timing info
15:15:44.677414 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: Close
15:15:44.744228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae44da5d-70d4-417b-914e-038ff0193eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d6ba46820>]}
15:15:44.745167 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_item_monthly_consistency....... [[32mSUCCESS 1[0m in 2.62s]
15:15:44.745769 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_item_monthly_consistency
15:15:44.747265 [debug] [MainThread]: Acquiring new snowflake connection "master"
15:15:44.748103 [info ] [MainThread]: 
15:15:44.748828 [info ] [MainThread]: Finished running 1 table model in 6.13s.
15:15:44.749602 [debug] [MainThread]: Connection 'master' was properly closed.
15:15:44.750191 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_item_monthly_consistency' was properly closed.
15:15:44.762432 [info ] [MainThread]: 
15:15:44.763191 [info ] [MainThread]: [32mCompleted successfully[0m
15:15:44.764010 [info ] [MainThread]: 
15:15:44.764637 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
15:15:44.765580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746db2eeff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746d6ba73370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746db0e3c9a0>]}


============================== 2025-08-04 15:58:45.646067 | 9c5edb1b-345e-4f33-8a6d-9e029c4e5a94 ==============================
15:58:45.646067 [info ] [MainThread]: Running with dbt=1.0.0
15:58:45.647542 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_item_monthly_consistency'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
15:58:45.648075 [debug] [MainThread]: Tracking: tracking
15:58:45.648707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775339fce700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775339fce760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775339fce7c0>]}
16:02:10.202740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:02:10.204516 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_item_monthly_consistency.sql
16:02:10.221548 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_item_monthly_consistency.sql
16:02:10.271328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

16:02:10.276340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c5edb1b-345e-4f33-8a6d-9e029c4e5a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77533805f0d0>]}
16:02:10.344528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c5edb1b-345e-4f33-8a6d-9e029c4e5a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775339fd04f0>]}
16:02:10.345604 [info ] [MainThread]: Found 16 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
16:02:10.348439 [info ] [MainThread]: 
16:02:10.349677 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:02:10.351368 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
16:02:10.362667 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
16:02:10.363683 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
16:02:10.364285 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:02:11.480299 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.12 seconds
16:02:11.483023 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
16:02:11.559584 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:02:11.565838 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:02:11.566778 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
16:02:11.567453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:02:12.818978 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 1.25 seconds
16:02:12.821109 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
16:02:12.896659 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:02:12.899093 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:02:12.899915 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
16:02:12.900649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:02:13.469387 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.57 seconds
16:02:13.471322 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
16:02:13.539381 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:02:13.540519 [info ] [MainThread]: 
16:02:13.555885 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:02:13.556907 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_item_monthly_consistency............ [RUN]
16:02:13.558131 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:02:13.558926 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:02:13.559515 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_item_monthly_consistency
16:02:13.562119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:02:13.570942 [debug] [Thread-1  ]: finished collecting timing info
16:02:13.571694 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:02:13.589299 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:02:13.598120 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:02:13.598859 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_item_monthly_consistency"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_item_monthly_consistency  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(date, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
),

monthly_sales AS (
    SELECT
        DATE_BLOCK_NUM,
        ITEM_ID,
        SUM(ITEM_CNT_DAY * ITEM_PRICE) AS MONTHLY_REVENUE
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY DATE_BLOCK_NUM, ITEM_ID
),

item_total_revenue AS (
    SELECT
        ITEM_ID,
        SUM(MONTHLY_REVENUE) AS TOTAL_REVENUE
    FROM monthly_sales
    GROUP BY ITEM_ID
),

ranked_items AS (
    SELECT
        ITEM_ID,
        TOTAL_REVENUE,
        RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS REVENUE_RANK
    FROM item_total_revenue
),

filtered_top_items AS (
    SELECT
        ITEM_ID
    FROM ranked_items
    WHERE REVENUE_RANK <= 30
),

final_matrix AS (
    SELECT
        m.DATE_BLOCK_NUM,
        m.ITEM_ID,
        m.MONTHLY_REVENUE,
        TO_CHAR(DATEADD(month, m.DATE_BLOCK_NUM, b.base_date), 'Mon YYYY') AS MONTH_LABEL
    FROM monthly_sales m
    JOIN filtered_top_items t ON m.ITEM_ID = t.ITEM_ID
    CROSS JOIN base_date_cte b
)

SELECT *
FROM final_matrix
      );
16:02:13.599641 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:02:16.326745 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.73 seconds
16:02:16.333978 [debug] [Thread-1  ]: finished collecting timing info
16:02:16.334957 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: Close
16:02:16.399427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c5edb1b-345e-4f33-8a6d-9e029c4e5a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7752fa9e63a0>]}
16:02:16.400777 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_item_monthly_consistency....... [[32mSUCCESS 1[0m in 2.84s]
16:02:16.401644 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:02:16.403376 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:02:16.404216 [info ] [MainThread]: 
16:02:16.404935 [info ] [MainThread]: Finished running 1 table model in 6.05s.
16:02:16.405712 [debug] [MainThread]: Connection 'master' was properly closed.
16:02:16.427924 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_item_monthly_consistency' was properly closed.
16:02:16.444333 [info ] [MainThread]: 
16:02:16.445259 [info ] [MainThread]: [32mCompleted successfully[0m
16:02:16.446323 [info ] [MainThread]: 
16:02:16.459140 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:02:16.460590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77533b00c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77533b00c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7752fa9b6b80>]}


============================== 2025-08-04 16:40:23.913970 | cab41cf2-6fe3-48e3-be2f-a0aa80a8d7e4 ==============================
16:40:23.913970 [info ] [MainThread]: Running with dbt=1.0.0
16:40:23.915581 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_item_monthly_consistency'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
16:40:23.916433 [debug] [MainThread]: Tracking: tracking
16:40:23.917122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b58cf4e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b58cf4e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b58cf4e7c0>]}
16:42:57.726860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:42:57.728611 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_item_monthly_consistency.sql
16:42:57.741319 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_item_monthly_consistency.sql
16:42:57.767431 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

16:42:57.772472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cab41cf2-6fe3-48e3-be2f-a0aa80a8d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b58c1eb0d0>]}
16:42:57.790461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cab41cf2-6fe3-48e3-be2f-a0aa80a8d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b58cf50430>]}
16:42:57.791098 [info ] [MainThread]: Found 16 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
16:42:57.793536 [info ] [MainThread]: 
16:42:57.794634 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:42:57.795947 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
16:42:57.804929 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
16:42:57.805688 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
16:42:57.806206 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:59.275166 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.47 seconds
16:42:59.277453 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
16:42:59.346149 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:42:59.351308 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
16:42:59.351966 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
16:42:59.352663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:42:59.904157 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.55 seconds
16:42:59.905856 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
16:42:59.971695 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:42:59.974011 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
16:42:59.974520 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
16:42:59.974996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:43:00.671878 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.7 seconds
16:43:00.673792 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
16:43:00.747290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
16:43:00.748789 [info ] [MainThread]: 
16:43:00.765410 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:43:00.766345 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_item_monthly_consistency............ [RUN]
16:43:00.768521 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:43:00.769643 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:43:00.770718 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_item_monthly_consistency
16:43:00.775567 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:43:00.783399 [debug] [Thread-1  ]: finished collecting timing info
16:43:00.784139 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:43:00.800970 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:43:00.808559 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
16:43:00.809229 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_item_monthly_consistency"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_item_monthly_consistency  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(date, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
),

monthly_sales AS (
    SELECT
        DATE_BLOCK_NUM,
        ITEM_ID,
        SUM(ITEM_CNT_DAY * ITEM_PRICE) AS MONTHLY_REVENUE
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
    GROUP BY DATE_BLOCK_NUM, ITEM_ID
),

item_total_revenue AS (
    SELECT
        ITEM_ID,
        SUM(MONTHLY_REVENUE) AS TOTAL_REVENUE
    FROM monthly_sales
    GROUP BY ITEM_ID
),

ranked_items AS (
    SELECT
        ITEM_ID,
        TOTAL_REVENUE,
        RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS REVENUE_RANK
    FROM item_total_revenue
),

filtered_top_items AS (
    SELECT ITEM_ID
    FROM ranked_items
    WHERE REVENUE_RANK <= 30
),

final_matrix AS (
    SELECT
        m.DATE_BLOCK_NUM,
        m.ITEM_ID,
        i.ITEM_NAME,
        m.MONTHLY_REVENUE,
        TO_CHAR(DATEADD(month, m.DATE_BLOCK_NUM, b.base_date), 'Mon YYYY') AS MONTH_LABEL,
        DATEADD(month, m.DATE_BLOCK_NUM, b.base_date) AS MONTH_DATE
    FROM monthly_sales m
    JOIN filtered_top_items t ON m.ITEM_ID = t.ITEM_ID
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON m.ITEM_ID = i.ITEM_ID
    CROSS JOIN base_date_cte b
)

SELECT *
FROM final_matrix
      );
16:43:00.809910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:43:03.662500 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.85 seconds
16:43:03.669850 [debug] [Thread-1  ]: finished collecting timing info
16:43:03.670591 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: Close
16:43:03.747240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab41cf2-6fe3-48e3-be2f-a0aa80a8d7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b57595e8e0>]}
16:43:03.748137 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_item_monthly_consistency....... [[32mSUCCESS 1[0m in 2.98s]
16:43:03.748790 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_item_monthly_consistency
16:43:03.750231 [debug] [MainThread]: Acquiring new snowflake connection "master"
16:43:03.751111 [info ] [MainThread]: 
16:43:03.751657 [info ] [MainThread]: Finished running 1 table model in 5.96s.
16:43:03.752249 [debug] [MainThread]: Connection 'master' was properly closed.
16:43:03.752715 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_item_monthly_consistency' was properly closed.
16:43:03.765351 [info ] [MainThread]: 
16:43:03.766119 [info ] [MainThread]: [32mCompleted successfully[0m
16:43:03.766927 [info ] [MainThread]: 
16:43:03.767660 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
16:43:03.768944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b58ce00e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b58cf8a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78b5759702e0>]}


============================== 2025-08-04 17:11:09.468908 | 51bf7d82-feb8-493f-800b-0c54917fee21 ==============================
17:11:09.468908 [info ] [MainThread]: Running with dbt=1.0.0
17:11:09.470274 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_seasonality_by_category'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:11:09.470931 [debug] [MainThread]: Tracking: tracking
17:11:09.471565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03fb4e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03fb4e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03fb4e7c0>]}
17:13:43.109132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:13:43.109969 [debug] [MainThread]: Partial parsing: added file: dbt_sales_pipeline://models/marts/mart_seasonality_by_category.sql
17:13:43.120373 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_seasonality_by_category.sql
17:13:43.141453 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

17:13:43.146185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51bf7d82-feb8-493f-800b-0c54917fee21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03d9d30d0>]}
17:13:43.160929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51bf7d82-feb8-493f-800b-0c54917fee21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03fb50550>]}
17:13:43.161595 [info ] [MainThread]: Found 17 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
17:13:43.163490 [info ] [MainThread]: 
17:13:43.164442 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:13:43.165711 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
17:13:43.174391 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
17:13:43.175595 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
17:13:43.176295 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:13:46.970276 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.79 seconds
17:13:46.972231 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
17:13:47.050681 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
17:13:47.055851 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
17:13:47.056600 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
17:13:47.057122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:13:47.759689 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.7 seconds
17:13:47.761537 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
17:13:47.828366 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
17:13:47.830128 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
17:13:47.830669 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
17:13:47.831283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:13:48.382061 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.55 seconds
17:13:48.383657 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
17:13:48.518949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:13:48.519761 [info ] [MainThread]: 
17:13:48.535478 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_seasonality_by_category
17:13:48.536332 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_seasonality_by_category............. [RUN]
17:13:48.537318 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:13:48.537849 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_seasonality_by_category
17:13:48.538273 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_seasonality_by_category
17:13:48.540370 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:13:48.544930 [debug] [Thread-1  ]: finished collecting timing info
17:13:48.545397 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_seasonality_by_category
17:13:48.562115 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:13:48.567883 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:13:48.568400 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_seasonality_by_category: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_seasonality_by_category"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_seasonality_by_category  as
      (-- models/marts/mart_seasonality_by_category.sql

WITH monthly_revenue AS (
    SELECT
        item_category_id,
        item_category_name,
        TO_CHAR(date_month, 'Mon') AS month_label,
        EXTRACT(MONTH FROM date_month) AS month_num,
        SUM(monthly_revenue) AS revenue
    FROM SALES_PIPELINE.STAGING_marts.mart_monthly_sales
    GROUP BY 1, 2, 3, 4
),

category_avg AS (
    SELECT
        item_category_id,
        AVG(revenue) AS avg_revenue
    FROM monthly_revenue
    GROUP BY 1
),

seasonality_index AS (
    SELECT
        m.item_category_id,
        m.item_category_name,
        m.month_label,
        m.month_num,
        ROUND(m.revenue / NULLIF(c.avg_revenue, 0), 2) AS seasonality_score
    FROM monthly_revenue m
    JOIN category_avg c USING(item_category_id)
)

SELECT *
FROM seasonality_index
ORDER BY item_category_name, month_num
      );
17:13:48.568937 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:13:49.166256 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01be2609-0001-63bb-0001-571200052316
17:13:49.166809 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'ITEM_CATEGORY_ID'
17:13:49.167291 [debug] [Thread-1  ]: finished collecting timing info
17:13:49.167822 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_seasonality_by_category: Close
17:13:49.233337 [debug] [Thread-1  ]: Database Error in model mart_seasonality_by_category (models/marts/mart_seasonality_by_category.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'ITEM_CATEGORY_ID'
  compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_seasonality_by_category.sql
17:13:49.234404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51bf7d82-feb8-493f-800b-0c54917fee21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03c5c8e20>]}
17:13:49.235007 [error] [Thread-1  ]: 1 of 1 ERROR creating table model STAGING_marts.mart_seasonality_by_category.... [[31mERROR[0m in 0.70s]
17:13:49.235596 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_seasonality_by_category
17:13:49.237034 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:13:49.237870 [info ] [MainThread]: 
17:13:49.238685 [info ] [MainThread]: Finished running 1 table model in 6.07s.
17:13:49.239289 [debug] [MainThread]: Connection 'master' was properly closed.
17:13:49.239811 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_seasonality_by_category' was properly closed.
17:13:49.251650 [info ] [MainThread]: 
17:13:49.252346 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:13:49.253246 [info ] [MainThread]: 
17:13:49.253892 [error] [MainThread]: [33mDatabase Error in model mart_seasonality_by_category (models/marts/mart_seasonality_by_category.sql)[0m
17:13:49.254576 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 6 at position 8
17:13:49.255133 [error] [MainThread]:   invalid identifier 'ITEM_CATEGORY_ID'
17:13:49.255701 [error] [MainThread]:   compiled SQL at target/run/dbt_sales_pipeline/models/marts/mart_seasonality_by_category.sql
17:13:49.256349 [info ] [MainThread]: 
17:13:49.257009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
17:13:49.257789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03fb85c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03d987e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb03ca5ed90>]}


============================== 2025-08-04 17:28:21.757064 | a1b868a3-d635-4c9e-b581-7dc5313f2dc4 ==============================
17:28:21.757064 [info ] [MainThread]: Running with dbt=1.0.0
17:28:21.758653 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=['mart_seasonality_by_category'], exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
17:28:21.759666 [debug] [MainThread]: Tracking: tracking
17:28:21.760864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f4a10a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f4a10a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f4a10a7c0>]}
17:30:49.730019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:30:49.731218 [debug] [MainThread]: Partial parsing: updated file: dbt_sales_pipeline://models/marts/mart_seasonality_by_category.sql
17:30:49.743321 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_seasonality_by_category.sql
17:30:49.765335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

17:30:49.769932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1b868a3-d635-4c9e-b581-7dc5313f2dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f481690d0>]}
17:30:49.784716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1b868a3-d635-4c9e-b581-7dc5313f2dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f4a0e6b20>]}
17:30:49.785374 [info ] [MainThread]: Found 17 models, 36 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
17:30:49.787514 [info ] [MainThread]: 
17:30:49.788449 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:30:49.790047 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
17:30:49.799001 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
17:30:49.800030 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
17:30:49.800740 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:30:52.942229 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.14 seconds
17:30:52.944344 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
17:30:53.012635 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_staging"
17:30:53.018084 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_staging"
17:30:53.018811 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_staging"} */

    show terse objects in SALES_PIPELINE.STAGING_staging
17:30:53.019233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:30:53.748631 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.73 seconds
17:30:53.750112 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_staging: Close
17:30:53.818135 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_STAGING_marts"
17:30:53.819665 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_STAGING_marts"
17:30:53.820099 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_STAGING_marts"} */

    show terse objects in SALES_PIPELINE.STAGING_marts
17:30:53.820451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:30:54.371495 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.55 seconds
17:30:54.373369 [debug] [ThreadPool]: On list_SALES_PIPELINE_STAGING_marts: Close
17:30:54.441190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
17:30:54.441990 [info ] [MainThread]: 
17:30:54.455860 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_seasonality_by_category
17:30:54.456600 [info ] [Thread-1  ]: 1 of 1 START table model STAGING_marts.mart_seasonality_by_category............. [RUN]
17:30:54.457686 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:30:54.458189 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_seasonality_by_category
17:30:54.458689 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_seasonality_by_category
17:30:54.461135 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:30:54.465961 [debug] [Thread-1  ]: finished collecting timing info
17:30:54.466554 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_seasonality_by_category
17:30:54.482574 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:30:54.488654 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
17:30:54.489176 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_seasonality_by_category: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_seasonality_by_category"} */


      create or replace transient table SALES_PIPELINE.STAGING_marts.mart_seasonality_by_category  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(date, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_staging.stg_sales_train
),

monthly_sales_with_category AS (
    SELECT
        m.date_block_num,
        i.item_category_id,
        c.item_category_name,
        DATEADD(month, m.date_block_num, b.base_date) AS date_month,
        SUM(m.monthly_revenue) AS monthly_revenue
    FROM SALES_PIPELINE.STAGING_marts.mart_monthly_sales m
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_items i ON m.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.STAGING_staging.stg_item_categories c ON i.item_category_id = c.item_category_id
    CROSS JOIN base_date_cte b
    GROUP BY 1, 2, 3, 4
),

monthly_revenue AS (
    SELECT
        item_category_id,
        item_category_name,
        TO_CHAR(date_month, 'Mon') AS month_label,
        EXTRACT(MONTH FROM date_month) AS month_num,
        SUM(monthly_revenue) AS revenue
    FROM monthly_sales_with_category
    GROUP BY 1, 2, 3, 4
),

category_avg AS (
    SELECT
        item_category_id,
        AVG(revenue) AS avg_revenue
    FROM monthly_revenue
    GROUP BY 1
),

seasonality_index AS (
    SELECT
        m.item_category_id,
        m.item_category_name,
        m.month_label,
        m.month_num,
        ROUND(m.revenue / NULLIF(c.avg_revenue, 0), 2) AS seasonality_score
    FROM monthly_revenue m
    JOIN category_avg c USING(item_category_id)
)

SELECT *
FROM seasonality_index
ORDER BY item_category_name, month_num
      );
17:30:54.489714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:30:57.320744 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.83 seconds
17:30:57.327075 [debug] [Thread-1  ]: finished collecting timing info
17:30:57.327670 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_seasonality_by_category: Close
17:30:57.395941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1b868a3-d635-4c9e-b581-7dc5313f2dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f2a0ecb80>]}
17:30:57.396790 [info ] [Thread-1  ]: 1 of 1 OK created table model STAGING_marts.mart_seasonality_by_category........ [[32mSUCCESS 1[0m in 2.94s]
17:30:57.397343 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_seasonality_by_category
17:30:57.398660 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:30:57.399356 [info ] [MainThread]: 
17:30:57.399924 [info ] [MainThread]: Finished running 1 table model in 7.61s.
17:30:57.400510 [debug] [MainThread]: Connection 'master' was properly closed.
17:30:57.401242 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_seasonality_by_category' was properly closed.
17:30:57.411559 [info ] [MainThread]: 
17:30:57.412399 [info ] [MainThread]: [32mCompleted successfully[0m
17:30:57.413489 [info ] [MainThread]: 
17:30:57.414265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
17:30:57.415089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f48108fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f29aedb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743f29aedee0>]}


============================== 2025-08-05 13:18:52.174521 | 1762b80c-6085-4775-af2a-acc1e1897bc2 ==============================
13:18:52.174521 [info ] [MainThread]: Running with dbt=1.0.0
13:18:52.175409 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
13:18:52.176127 [debug] [MainThread]: Tracking: tracking
13:18:52.180040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966dfff1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966dfff8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966dfff040>]}
13:18:52.207229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e060e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e0607c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f966e0609a0>]}


============================== 2025-08-05 13:20:26.484940 | 7e98d1c2-a403-4004-a8fe-743581c497a3 ==============================
13:20:26.484940 [info ] [MainThread]: Running with dbt=1.0.0
13:20:26.485770 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, config_dir=False, defer=None, state=None, cls=<class 'dbt.task.debug.DebugTask'>, which='debug', rpc_method=None)
13:20:26.486416 [debug] [MainThread]: Tracking: tracking
13:20:26.490396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e065fb1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e065fb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e065fb160>]}
13:20:26.801861 [debug] [MainThread]: Executing "git --help"
13:20:26.808928 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:20:26.810313 [debug] [MainThread]: STDERR: "b''"
13:20:26.816015 [debug] [MainThread]: Acquiring new snowflake connection "debug"
13:20:26.817581 [debug] [MainThread]: Using snowflake connection "debug"
13:20:26.818250 [debug] [MainThread]: On debug: select 1 as id
13:20:26.818756 [debug] [MainThread]: Opening a new connection, currently in state init
13:20:27.768232 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.95 seconds
13:20:27.769647 [debug] [MainThread]: On debug: Close
13:20:27.838493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e0096c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e0096c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756e0096cb80>]}
13:20:28.266382 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2025-08-05 13:24:41.037417 | 237f5f69-f93b-4469-a150-d1ad5d4c520c ==============================
13:24:41.037417 [info ] [MainThread]: Running with dbt=1.0.0
13:24:41.038139 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
13:24:41.038846 [debug] [MainThread]: Tracking: tracking
13:24:41.039442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28aeadaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28aeada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28aeada30>]}
13:24:41.090693 [info ] [MainThread]: Unable to do partial parsing because profile has changed
13:24:41.091638 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
13:24:41.092318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb290b854f0>]}
13:27:12.491464 [debug] [MainThread]: Parsing macros/date_utils.sql
13:27:12.493113 [debug] [MainThread]: Parsing macros/catalog.sql
13:27:12.494787 [debug] [MainThread]: Parsing macros/adapters.sql
13:27:12.518621 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:27:12.519947 [debug] [MainThread]: Parsing macros/materializations/merge.sql
13:27:12.522937 [debug] [MainThread]: Parsing macros/materializations/table.sql
13:27:12.525223 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:27:12.528927 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:27:12.534421 [debug] [MainThread]: Parsing macros/materializations/view.sql
13:27:12.535739 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:27:12.538541 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:27:12.540666 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:27:12.544715 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:27:12.554386 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:27:12.556142 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:27:12.559298 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:27:12.560985 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:27:12.568048 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:27:12.574536 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:27:12.576110 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:27:12.579296 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:27:12.589032 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:27:12.591224 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:27:12.595802 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:27:12.597882 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:27:12.599120 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:27:12.601319 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:27:12.606274 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:27:12.613617 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:27:12.615203 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:27:12.622150 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:27:12.631862 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:27:12.637474 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:27:12.640359 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:27:12.641704 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:27:12.643453 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:27:12.644690 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:27:12.645806 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:27:12.646790 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:27:12.647610 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:27:12.648253 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:27:12.654072 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:27:12.656932 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:27:12.659135 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:27:12.664107 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:27:12.665904 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:27:12.667900 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:27:12.673238 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:27:12.788905 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_daily_sales.sql
13:27:12.815669 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_item_monthly_consistency.sql
13:27:12.818005 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_monthly_sales.sql
13:27:12.819972 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_month.sql
13:27:12.821849 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_revenue_by_store.sql
13:27:12.824131 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_seasonality_by_category.sql
13:27:12.827040 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_category_matrix.sql
13:27:12.829614 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_shop_profile.sql
13:27:12.831764 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_item_categories.sql
13:27:12.834140 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_products.sql
13:27:12.836988 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_top_shops.sql
13:27:12.839206 [debug] [MainThread]: 1699: static parser successfully parsed marts/mart_total_revenue.sql
13:27:12.842079 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_items.sql
13:27:12.844150 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_item_categories.sql
13:27:12.846120 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_train.sql
13:27:12.848318 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_shops.sql
13:27:12.850729 [debug] [MainThread]: 1699: static parser successfully parsed utils/base_date.sql
13:27:12.969623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:27:12.974557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb289d8ab20>]}
13:27:13.014679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb289d96c10>]}
13:27:13.015378 [info ] [MainThread]: Found 17 models, 42 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:27:13.018019 [info ] [MainThread]: 
13:27:13.019278 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:27:13.021212 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:27:13.030289 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:27:13.031096 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:27:13.031605 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:27:14.131680 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.1 seconds
13:27:14.133993 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:27:14.202306 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE"
13:27:14.204392 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE"
13:27:14.204955 [debug] [ThreadPool]: On list_SALES_PIPELINE: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE"} */

    show terse schemas in database SALES_PIPELINE
    limit 10000
13:27:14.205291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:14.742823 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.54 seconds
13:27:14.744366 [debug] [ThreadPool]: On list_SALES_PIPELINE: Close
13:27:14.810830 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_RAW_marts"
13:27:14.811599 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_RAW_marts"
13:27:14.812323 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='sales_pipeline', schema='raw_marts', identifier=None)"
13:27:14.816183 [debug] [ThreadPool]: Using snowflake connection "create_SALES_PIPELINE_RAW_marts"
13:27:14.817012 [debug] [ThreadPool]: On create_SALES_PIPELINE_RAW_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "create_SALES_PIPELINE_RAW_marts"} */
create schema if not exists SALES_PIPELINE.RAW_marts
13:27:14.817365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:15.506585 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.69 seconds
13:27:15.507911 [debug] [ThreadPool]: On create_SALES_PIPELINE_RAW_marts: Close
13:27:15.576514 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_RAW_staging"
13:27:15.577477 [debug] [ThreadPool]: Acquiring new snowflake connection "create_SALES_PIPELINE_RAW_staging"
13:27:15.578047 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='sales_pipeline', schema='raw_staging', identifier=None)"
13:27:15.579402 [debug] [ThreadPool]: Using snowflake connection "create_SALES_PIPELINE_RAW_staging"
13:27:15.580062 [debug] [ThreadPool]: On create_SALES_PIPELINE_RAW_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "create_SALES_PIPELINE_RAW_staging"} */
create schema if not exists SALES_PIPELINE.RAW_staging
13:27:15.580560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:16.132517 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.55 seconds
13:27:16.134082 [debug] [ThreadPool]: On create_SALES_PIPELINE_RAW_staging: Close
13:27:16.202619 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:27:16.207131 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:27:16.207832 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_marts"} */

    show terse objects in SALES_PIPELINE.RAW_marts
13:27:16.208241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:16.731766 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.52 seconds
13:27:16.733287 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: Close
13:27:16.797351 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:27:16.799006 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:27:16.799476 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_staging"} */

    show terse objects in SALES_PIPELINE.RAW_staging
13:27:16.799904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:27:17.329509 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.53 seconds
13:27:17.330930 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: Close
13:27:17.397578 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:27:17.400179 [info ] [MainThread]: 
13:27:17.414432 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
13:27:17.415828 [info ] [Thread-1  ]: 1 of 17 START table model RAW_marts.mart_monthly_sales.......................... [RUN]
13:27:17.418005 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
13:27:17.418838 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
13:27:17.420115 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
13:27:17.422439 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
13:27:17.438971 [debug] [Thread-1  ]: finished collecting timing info
13:27:17.439587 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
13:27:17.457039 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
13:27:17.472234 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
13:27:17.472850 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_monthly_sales"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_monthly_sales  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(DATE, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train
), base AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        s.shop_id,
        s.item_id,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue,
        SUM(s.item_cnt_day) AS monthly_qty_sold
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train s
    CROSS JOIN base_date_cte b
    GROUP BY s.date_block_num, s.shop_id, s.item_id, b.base_date
)

SELECT *
FROM base
ORDER BY date_block_num, shop_id, item_id
      );
13:27:17.473386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:21.141542 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.67 seconds
13:27:21.148077 [debug] [Thread-1  ]: finished collecting timing info
13:27:21.148839 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_monthly_sales: Close
13:27:21.214740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a944700>]}
13:27:21.215746 [info ] [Thread-1  ]: 1 of 17 OK created table model RAW_marts.mart_monthly_sales..................... [[32mSUCCESS 1[0m in 3.80s]
13:27:21.216508 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
13:27:21.217327 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
13:27:21.218120 [info ] [Thread-1  ]: 2 of 17 START table model RAW_marts.mart_revenue_by_store....................... [RUN]
13:27:21.218913 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
13:27:21.219570 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
13:27:21.220099 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
13:27:21.221663 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
13:27:21.227801 [debug] [Thread-1  ]: finished collecting timing info
13:27:21.228835 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
13:27:21.231141 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
13:27:21.236851 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
13:27:21.237427 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_store"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_revenue_by_store  as
      (SELECT 
  shop_id,
  SUM(item_price * item_cnt_day) AS total_revenue
FROM RAW.sales_train
GROUP BY shop_id
      );
13:27:21.237916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:22.422745 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.18 seconds
13:27:22.424821 [debug] [Thread-1  ]: finished collecting timing info
13:27:22.426275 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_store: Close
13:27:22.494071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8df400>]}
13:27:22.494939 [info ] [Thread-1  ]: 2 of 17 OK created table model RAW_marts.mart_revenue_by_store.................. [[32mSUCCESS 1[0m in 1.28s]
13:27:22.495737 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
13:27:22.496489 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
13:27:22.497215 [info ] [Thread-1  ]: 3 of 17 START table model RAW_marts.mart_top_products........................... [RUN]
13:27:22.498158 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
13:27:22.498817 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
13:27:22.499287 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
13:27:22.500667 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
13:27:22.506120 [debug] [Thread-1  ]: finished collecting timing info
13:27:22.506755 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
13:27:22.508785 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_products"
13:27:22.514777 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_products"
13:27:22.515514 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_products"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_top_products  as
      (SELECT 
  item_id,
  SUM(item_cnt_day) AS total_units_sold
FROM RAW.sales_train
GROUP BY item_id
ORDER BY total_units_sold DESC
LIMIT 10
      );
13:27:22.516223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:23.504229 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.99 seconds
13:27:23.506284 [debug] [Thread-1  ]: finished collecting timing info
13:27:23.507318 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_products: Close
13:27:23.570403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8df310>]}
13:27:23.571383 [info ] [Thread-1  ]: 3 of 17 OK created table model RAW_marts.mart_top_products...................... [[32mSUCCESS 1[0m in 1.07s]
13:27:23.572118 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
13:27:23.572779 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_item_categories
13:27:23.573533 [info ] [Thread-1  ]: 4 of 17 START view model RAW_staging.stg_item_categories........................ [RUN]
13:27:23.574481 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
13:27:23.575031 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_item_categories
13:27:23.575678 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_item_categories
13:27:23.577972 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_item_categories"
13:27:23.588000 [debug] [Thread-1  ]: finished collecting timing info
13:27:23.588906 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_item_categories
13:27:23.602154 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_item_categories"
13:27:23.612499 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
13:27:23.613234 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_item_categories"} */

  create or replace  view SALES_PIPELINE.RAW_staging.stg_item_categories 
  
   as (
    -- models/staging/stg_item_categories.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.translated_item_categories
),

renamed as (
    select
        item_category_id::int as item_category_id,
        item_category_name::string as item_category_name
    from source
)

select * from renamed
  );
13:27:23.613783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:24.423269 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.81 seconds
13:27:24.425135 [debug] [Thread-1  ]: finished collecting timing info
13:27:24.425916 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_item_categories: Close
13:27:24.513990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8df1f0>]}
13:27:24.514926 [info ] [Thread-1  ]: 4 of 17 OK created view model RAW_staging.stg_item_categories................... [[32mSUCCESS 1[0m in 0.94s]
13:27:24.515573 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_item_categories
13:27:24.516181 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_items
13:27:24.516691 [info ] [Thread-1  ]: 5 of 17 START view model RAW_staging.stg_items.................................. [RUN]
13:27:24.517431 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_items"
13:27:24.517890 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_items
13:27:24.518255 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_items
13:27:24.520207 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_items"
13:27:24.525160 [debug] [Thread-1  ]: finished collecting timing info
13:27:24.525741 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_items
13:27:24.527814 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_items"
13:27:24.534209 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_items"
13:27:24.534813 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_items"} */

  create or replace  view SALES_PIPELINE.RAW_staging.stg_items 
  
   as (
    -- models/staging/stg_items.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.translated_items
),

renamed as (
    select
        item_id::int as item_id,
        item_name::string as item_name,
        item_category_id::int as item_category_id
    from source
)

select * from renamed
  );
13:27:24.535323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:25.214799 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.68 seconds
13:27:25.216299 [debug] [Thread-1  ]: finished collecting timing info
13:27:25.216887 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_items: Close
13:27:25.283270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8df0d0>]}
13:27:25.284241 [info ] [Thread-1  ]: 5 of 17 OK created view model RAW_staging.stg_items............................. [[32mSUCCESS 1[0m in 0.77s]
13:27:25.285211 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_items
13:27:25.286061 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_sales_train
13:27:25.286767 [info ] [Thread-1  ]: 6 of 17 START view model RAW_staging.stg_sales_train............................ [RUN]
13:27:25.287540 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
13:27:25.288192 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_sales_train
13:27:25.288810 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_sales_train
13:27:25.291016 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_sales_train"
13:27:25.298370 [debug] [Thread-1  ]: finished collecting timing info
13:27:25.299174 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_sales_train
13:27:25.301617 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_sales_train"
13:27:25.309702 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
13:27:25.310560 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_sales_train: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_sales_train"} */

  create or replace  view SALES_PIPELINE.RAW_staging.stg_sales_train 
  
   as (
    -- models/staging/stg_sales_train.sql

with source as (
    select
        date,
        cast(date_block_num as int) as date_block_num,
        cast(shop_id as int) as shop_id,
        cast(item_id as int) as item_id,
        cast(item_price as float) as item_price,
        cast(item_cnt_day as float) as item_cnt_day
    FROM SALES_PIPELINE.RAW.sales_train
)

select * from source
  );
13:27:25.311290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:25.962003 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
13:27:25.964188 [debug] [Thread-1  ]: finished collecting timing info
13:27:25.964950 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_sales_train: Close
13:27:26.031311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8dfa00>]}
13:27:26.032401 [info ] [Thread-1  ]: 6 of 17 OK created view model RAW_staging.stg_sales_train....................... [[32mSUCCESS 1[0m in 0.74s]
13:27:26.033162 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_sales_train
13:27:26.033772 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_shops
13:27:26.034646 [info ] [Thread-1  ]: 7 of 17 START view model RAW_staging.stg_shops.................................. [RUN]
13:27:26.035530 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_shops"
13:27:26.036154 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_shops
13:27:26.036765 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_shops
13:27:26.039377 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_shops"
13:27:26.046547 [debug] [Thread-1  ]: finished collecting timing info
13:27:26.047333 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_shops
13:27:26.049722 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.stg_shops"
13:27:26.057528 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.stg_shops"
13:27:26.058461 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.stg_shops"} */

  create or replace  view SALES_PIPELINE.RAW_staging.stg_shops 
  
   as (
    -- models/staging/stg_shops.sql

with source as (
    select * FROM SALES_PIPELINE.RAW.translated_shops
),

renamed as (
    select
        shop_id::int as shop_id,
        shop_name::string as shop_name
    from source
)

select * from renamed
  );
13:27:26.059138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:26.712785 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
13:27:26.714517 [debug] [Thread-1  ]: finished collecting timing info
13:27:26.715041 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.stg_shops: Close
13:27:26.780422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a937580>]}
13:27:26.781377 [info ] [Thread-1  ]: 7 of 17 OK created view model RAW_staging.stg_shops............................. [[32mSUCCESS 1[0m in 0.74s]
13:27:26.782025 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_shops
13:27:26.782666 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.base_date
13:27:26.783415 [info ] [Thread-1  ]: 8 of 17 START view model RAW_staging.base_date.................................. [RUN]
13:27:26.784099 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.base_date"
13:27:26.784727 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.base_date
13:27:26.785144 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.base_date
13:27:26.788158 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.base_date"
13:27:26.799500 [debug] [Thread-1  ]: finished collecting timing info
13:27:26.800472 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.base_date
13:27:26.803033 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.base_date"
13:27:26.811870 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.base_date"
13:27:26.812519 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.base_date: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.base_date"} */

  create or replace  view SALES_PIPELINE.RAW_staging.base_date 
  
   as (
    SELECT
  MIN(DATE) AS BASE_DATE
FROM SALES_PIPELINE.RAW_staging.stg_sales_train
  );
13:27:26.812983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:27.612514 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.8 seconds
13:27:27.614214 [debug] [Thread-1  ]: finished collecting timing info
13:27:27.614731 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.base_date: Close
13:27:27.682254 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a97b3a0>]}
13:27:27.683056 [info ] [Thread-1  ]: 8 of 17 OK created view model RAW_staging.base_date............................. [[32mSUCCESS 1[0m in 0.90s]
13:27:27.683570 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.base_date
13:27:27.684124 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
13:27:27.684689 [info ] [Thread-1  ]: 9 of 17 START table model RAW_marts.mart_daily_sales............................ [RUN]
13:27:27.685448 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
13:27:27.685900 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
13:27:27.686274 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
13:27:27.688239 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
13:27:27.694037 [debug] [Thread-1  ]: finished collecting timing info
13:27:27.694582 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
13:27:27.696377 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
13:27:27.701884 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
13:27:27.702598 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_daily_sales"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_daily_sales  as
      (with sales as (

    select
        date,
        shop_id,
        item_id,
        sum(item_cnt_day) as total_item_cnt,
        sum(item_price * item_cnt_day) as total_revenue

    from SALES_PIPELINE.RAW_staging.stg_sales_train
    group by date, shop_id, item_id

)

select *
from sales
      );
13:27:27.703222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:30.935790 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.23 seconds
13:27:30.937417 [debug] [Thread-1  ]: finished collecting timing info
13:27:30.938357 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_daily_sales: Close
13:27:31.003518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8a8f10>]}
13:27:31.004388 [info ] [Thread-1  ]: 9 of 17 OK created table model RAW_marts.mart_daily_sales....................... [[32mSUCCESS 1[0m in 3.32s]
13:27:31.004992 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
13:27:31.005693 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:27:31.006252 [info ] [Thread-1  ]: 10 of 17 START table model RAW_marts.mart_item_monthly_consistency.............. [RUN]
13:27:31.006938 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:27:31.007393 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:27:31.007890 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_item_monthly_consistency
13:27:31.010239 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:27:31.024038 [debug] [Thread-1  ]: finished collecting timing info
13:27:31.024666 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:27:31.027275 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:27:31.040702 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:27:31.041365 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_item_monthly_consistency"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_item_monthly_consistency  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(date, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train
),

monthly_sales AS (
    SELECT
        DATE_BLOCK_NUM,
        ITEM_ID,
        SUM(ITEM_CNT_DAY * ITEM_PRICE) AS MONTHLY_REVENUE
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train
    GROUP BY DATE_BLOCK_NUM, ITEM_ID
),

item_total_revenue AS (
    SELECT
        ITEM_ID,
        SUM(MONTHLY_REVENUE) AS TOTAL_REVENUE
    FROM monthly_sales
    GROUP BY ITEM_ID
),

ranked_items AS (
    SELECT
        ITEM_ID,
        TOTAL_REVENUE,
        RANK() OVER (ORDER BY TOTAL_REVENUE DESC) AS REVENUE_RANK
    FROM item_total_revenue
),

filtered_top_items AS (
    SELECT ITEM_ID
    FROM ranked_items
    WHERE REVENUE_RANK <= 30
),

final_matrix AS (
    SELECT
        m.DATE_BLOCK_NUM,
        m.ITEM_ID,
        i.ITEM_NAME,
        m.MONTHLY_REVENUE,
        TO_CHAR(DATEADD(month, m.DATE_BLOCK_NUM, b.base_date), 'Mon YYYY') AS MONTH_LABEL,
        DATEADD(month, m.DATE_BLOCK_NUM, b.base_date) AS MONTH_DATE
    FROM monthly_sales m
    JOIN filtered_top_items t ON m.ITEM_ID = t.ITEM_ID
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_items i ON m.ITEM_ID = i.ITEM_ID
    CROSS JOIN base_date_cte b
)

SELECT *
FROM final_matrix
      );
13:27:31.042050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:32.801120 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.76 seconds
13:27:32.802874 [debug] [Thread-1  ]: finished collecting timing info
13:27:32.803399 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_item_monthly_consistency: Close
13:27:32.923336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2490815b0>]}
13:27:32.924286 [info ] [Thread-1  ]: 10 of 17 OK created table model RAW_marts.mart_item_monthly_consistency......... [[32mSUCCESS 1[0m in 1.92s]
13:27:32.924963 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:27:32.925796 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:32.926696 [info ] [Thread-1  ]: 11 of 17 START table model RAW_marts.mart_revenue_by_month...................... [RUN]
13:27:32.927407 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:32.928166 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:32.928763 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
13:27:32.930688 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:32.946014 [debug] [Thread-1  ]: finished collecting timing info
13:27:32.946707 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:32.948839 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:32.962632 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:27:32.963448 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_revenue_by_month"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_revenue_by_month  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(DATE, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.STAGING_STAGING.stg_sales_train
), sales_data AS (
    SELECT
        s.date_block_num,
        TO_CHAR(DATEADD(month, s.date_block_num, b.base_date), 'YYYY-MM') AS date_month,
        SUM(s.item_cnt_day * s.item_price) AS monthly_revenue
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train s
    CROSS JOIN base_date_cte b
    GROUP BY s.date_block_num, b.base_date
)

SELECT
    date_block_num,
    date_month,
    monthly_revenue
FROM sales_data
ORDER BY date_block_num
      );
13:27:32.963988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:34.529770 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.57 seconds
13:27:34.531671 [debug] [Thread-1  ]: finished collecting timing info
13:27:34.532326 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_revenue_by_month: Close
13:27:34.595379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a9b9d00>]}
13:27:34.596193 [info ] [Thread-1  ]: 11 of 17 OK created table model RAW_marts.mart_revenue_by_month................. [[32mSUCCESS 1[0m in 1.67s]
13:27:34.597018 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
13:27:34.597633 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_seasonality_by_category
13:27:34.598182 [info ] [Thread-1  ]: 12 of 17 START table model RAW_marts.mart_seasonality_by_category............... [RUN]
13:27:34.598895 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:27:34.599467 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_seasonality_by_category
13:27:34.600073 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_seasonality_by_category
13:27:34.602564 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:27:34.618396 [debug] [Thread-1  ]: finished collecting timing info
13:27:34.619242 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_seasonality_by_category
13:27:34.621550 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:27:34.635829 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:27:34.636378 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_seasonality_by_category: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_seasonality_by_category"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_seasonality_by_category  as
      (WITH base_date_cte AS (
    SELECT MIN(TO_DATE(date, 'DD.MM.YYYY')) AS base_date
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train
),

monthly_sales_with_category AS (
    SELECT
        m.date_block_num,
        i.item_category_id,
        c.item_category_name,
        DATEADD(month, m.date_block_num, b.base_date) AS date_month,
        SUM(m.monthly_revenue) AS monthly_revenue
    FROM SALES_PIPELINE.RAW_marts.mart_monthly_sales m
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_items i ON m.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_item_categories c ON i.item_category_id = c.item_category_id
    CROSS JOIN base_date_cte b
    GROUP BY 1, 2, 3, 4
),

monthly_revenue AS (
    SELECT
        item_category_id,
        item_category_name,
        TO_CHAR(date_month, 'Mon') AS month_label,
        EXTRACT(MONTH FROM date_month) AS month_num,
        SUM(monthly_revenue) AS revenue
    FROM monthly_sales_with_category
    GROUP BY 1, 2, 3, 4
),

category_avg AS (
    SELECT
        item_category_id,
        AVG(revenue) AS avg_revenue
    FROM monthly_revenue
    GROUP BY 1
),

seasonality_index AS (
    SELECT
        m.item_category_id,
        m.item_category_name,
        m.month_label,
        m.month_num,
        ROUND(m.revenue / NULLIF(c.avg_revenue, 0), 2) AS seasonality_score
    FROM monthly_revenue m
    JOIN category_avg c USING(item_category_id)
)

SELECT *
FROM seasonality_index
ORDER BY item_category_name, month_num
      );
13:27:34.637092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:36.739937 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.1 seconds
13:27:36.741734 [debug] [Thread-1  ]: finished collecting timing info
13:27:36.742481 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_seasonality_by_category: Close
13:27:36.808549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2880e8760>]}
13:27:36.809366 [info ] [Thread-1  ]: 12 of 17 OK created table model RAW_marts.mart_seasonality_by_category.......... [[32mSUCCESS 1[0m in 2.21s]
13:27:36.810036 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_seasonality_by_category
13:27:36.810638 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
13:27:36.811260 [info ] [Thread-1  ]: 13 of 17 START table model RAW_marts.mart_top_item_categories................... [RUN]
13:27:36.812025 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
13:27:36.812701 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
13:27:36.813119 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
13:27:36.815095 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
13:27:36.820661 [debug] [Thread-1  ]: finished collecting timing info
13:27:36.821422 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
13:27:36.823277 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
13:27:36.830315 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
13:27:36.830845 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_item_categories"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_top_item_categories  as
      (WITH category_revenue AS (
    SELECT
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    GROUP BY ic.item_category_id, ic.item_category_name
)

SELECT
    item_category_id,
    item_category_name,
    total_revenue
FROM category_revenue
ORDER BY total_revenue DESC
      );
13:27:36.831454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:38.354771 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.52 seconds
13:27:38.356451 [debug] [Thread-1  ]: finished collecting timing info
13:27:38.357395 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_item_categories: Close
13:27:38.424813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a9a5430>]}
13:27:38.425900 [info ] [Thread-1  ]: 13 of 17 OK created table model RAW_marts.mart_top_item_categories.............. [[32mSUCCESS 1[0m in 1.61s]
13:27:38.426914 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
13:27:38.427753 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
13:27:38.428747 [info ] [Thread-1  ]: 14 of 17 START table model RAW_marts.mart_total_revenue......................... [RUN]
13:27:38.430185 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
13:27:38.431015 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
13:27:38.431739 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
13:27:38.433964 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
13:27:38.443056 [debug] [Thread-1  ]: finished collecting timing info
13:27:38.443812 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
13:27:38.446208 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
13:27:38.454996 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
13:27:38.455615 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_total_revenue"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_total_revenue  as
      (WITH sales_data AS (
    SELECT
        date,
        item_price,
        item_cnt_day,
        item_price * item_cnt_day AS revenue
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train
)

SELECT
    SUM(revenue) AS total_revenue
FROM sales_data
      );
13:27:38.456100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:39.430986 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.97 seconds
13:27:39.432904 [debug] [Thread-1  ]: finished collecting timing info
13:27:39.433770 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_total_revenue: Close
13:27:39.513346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb288026430>]}
13:27:39.514349 [info ] [Thread-1  ]: 14 of 17 OK created table model RAW_marts.mart_total_revenue.................... [[32mSUCCESS 1[0m in 1.08s]
13:27:39.515068 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
13:27:39.515736 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
13:27:39.516308 [info ] [Thread-1  ]: 15 of 17 START table model RAW_marts.mart_shop_category_matrix.................. [RUN]
13:27:39.517103 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:27:39.517680 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
13:27:39.518314 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
13:27:39.521715 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:27:39.528796 [debug] [Thread-1  ]: finished collecting timing info
13:27:39.529532 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
13:27:39.531689 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:27:39.542960 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:27:39.543635 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_category_matrix"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_shop_category_matrix  as
      (WITH shop_category_sales AS (
    SELECT
        s.shop_id,
        sh.shop_name,
        ic.item_category_id,
        ic.item_category_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_items i
        ON s.item_id = i.item_id
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_item_categories ic
        ON i.item_category_id = ic.item_category_id
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_shops sh
        ON s.shop_id = sh.shop_id
    GROUP BY s.shop_id, sh.shop_name, ic.item_category_id, ic.item_category_name
)

SELECT *
FROM shop_category_sales
ORDER BY shop_id, total_revenue DESC
      );
13:27:39.544235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:41.258918 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.71 seconds
13:27:41.261009 [debug] [Thread-1  ]: finished collecting timing info
13:27:41.261625 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_category_matrix: Close
13:27:41.325586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb249060f40>]}
13:27:41.326707 [info ] [Thread-1  ]: 15 of 17 OK created table model RAW_marts.mart_shop_category_matrix............. [[32mSUCCESS 1[0m in 1.81s]
13:27:41.327389 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
13:27:41.328102 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
13:27:41.328785 [info ] [Thread-1  ]: 16 of 17 START table model RAW_marts.mart_shop_profile.......................... [RUN]
13:27:41.329439 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:27:41.330003 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
13:27:41.330400 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
13:27:41.332740 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:27:41.352215 [debug] [Thread-1  ]: finished collecting timing info
13:27:41.353006 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
13:27:41.355123 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:27:41.372820 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:27:41.373846 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_shop_profile"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_shop_profile  as
      (WITH monthly_shop_revenue AS (
    SELECT
        shop_id,
        DATE_TRUNC('month', TO_DATE(date, 'DD.MM.YYYY')) AS month,
        SUM(item_price * item_cnt_day) AS monthly_revenue
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train
    GROUP BY shop_id, month
),

shop_stats AS (
    SELECT
        s.shop_id,
        COUNT(DISTINCT i.item_category_id) AS category_count,
        AVG(s.item_price) AS avg_item_price,
        SUM(s.item_price * s.item_cnt_day) / COUNT(DISTINCT s.item_id) AS revenue_per_item
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_items i ON s.item_id = i.item_id
    GROUP BY s.shop_id
),

revenue_variance AS (
    SELECT
        shop_id,
        STDDEV(monthly_revenue) AS revenue_stddev
    FROM monthly_shop_revenue
    GROUP BY shop_id
),

final AS (
    SELECT
        ss.shop_id,
        sc.shop_name,
        ss.category_count,
        ROUND(ss.avg_item_price, 2) AS avg_item_price,
        ROUND(ss.revenue_per_item, 2) AS revenue_per_item,
        ROUND(rv.revenue_stddev, 2) AS monthly_revenue_variance
    FROM shop_stats ss
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_shops sc ON ss.shop_id = sc.shop_id
    LEFT JOIN revenue_variance rv ON ss.shop_id = rv.shop_id
    ORDER BY revenue_per_item DESC
    LIMIT 10
)

SELECT * FROM final
      );
13:27:41.374616 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:43.384073 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.01 seconds
13:27:43.385718 [debug] [Thread-1  ]: finished collecting timing info
13:27:43.386216 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_shop_profile: Close
13:27:43.453866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a929f70>]}
13:27:43.455226 [info ] [Thread-1  ]: 16 of 17 OK created table model RAW_marts.mart_shop_profile..................... [[32mSUCCESS 1[0m in 2.12s]
13:27:43.456180 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
13:27:43.457238 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
13:27:43.457997 [info ] [Thread-1  ]: 17 of 17 START table model RAW_marts.mart_top_shops............................. [RUN]
13:27:43.458833 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
13:27:43.459519 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
13:27:43.460010 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
13:27:43.462300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
13:27:43.467558 [debug] [Thread-1  ]: finished collecting timing info
13:27:43.468127 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
13:27:43.470239 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_sales_pipeline.mart_top_shops"
13:27:43.476143 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
13:27:43.476739 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "model.dbt_sales_pipeline.mart_top_shops"} */


      create or replace transient table SALES_PIPELINE.RAW_marts.mart_top_shops  as
      (WITH shop_revenue AS (
    SELECT
        s.shop_id,
        shp.shop_name,
        ROUND(SUM(s.item_price * s.item_cnt_day), 2) AS total_revenue
    FROM SALES_PIPELINE.RAW_staging.stg_sales_train s
    LEFT JOIN SALES_PIPELINE.RAW_staging.stg_shops shp
        ON s.shop_id = shp.shop_id
    GROUP BY s.shop_id, shp.shop_name
)

SELECT
    shop_id,
    shop_name,
    total_revenue
FROM shop_revenue
ORDER BY total_revenue DESC
      );
13:27:43.477340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:27:44.673910 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.2 seconds
13:27:44.675648 [debug] [Thread-1  ]: finished collecting timing info
13:27:44.676250 [debug] [Thread-1  ]: On model.dbt_sales_pipeline.mart_top_shops: Close
13:27:44.746152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237f5f69-f93b-4469-a150-d1ad5d4c520c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb249091e80>]}
13:27:44.747128 [info ] [Thread-1  ]: 17 of 17 OK created table model RAW_marts.mart_top_shops........................ [[32mSUCCESS 1[0m in 1.29s]
13:27:44.747965 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
13:27:44.749671 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:27:44.750444 [info ] [MainThread]: 
13:27:44.751181 [info ] [MainThread]: Finished running 12 table models, 5 view models in 31.73s.
13:27:44.751871 [debug] [MainThread]: Connection 'master' was properly closed.
13:27:44.752364 [debug] [MainThread]: Connection 'model.dbt_sales_pipeline.mart_top_shops' was properly closed.
13:27:44.778412 [info ] [MainThread]: 
13:27:44.779166 [info ] [MainThread]: [32mCompleted successfully[0m
13:27:44.780178 [info ] [MainThread]: 
13:27:44.780957 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
13:27:44.781881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8df6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8df850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24a8df580>]}


============================== 2025-08-05 13:27:56.519727 | 3aba5ce2-c02d-4d1f-87c5-a1c96802b7e4 ==============================
13:27:56.519727 [info ] [MainThread]: Running with dbt=1.0.0
13:27:56.521176 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
13:27:56.522115 [debug] [MainThread]: Tracking: tracking
13:27:56.523303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71821c007b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71821c007ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71821c007a60>]}
13:30:27.001120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:30:27.001936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:30:27.003143 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:30:27.008919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aba5ce2-c02d-4d1f-87c5-a1c96802b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71821aef6f40>]}
13:30:27.028950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aba5ce2-c02d-4d1f-87c5-a1c96802b7e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71821afca070>]}
13:30:27.029723 [info ] [MainThread]: Found 17 models, 42 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:30:27.033080 [info ] [MainThread]: 
13:30:27.034176 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:30:27.036047 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:30:27.046274 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:30:27.046953 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_staging"} */

    show terse objects in SALES_PIPELINE.RAW_staging
13:30:27.047351 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:30:28.024134 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.98 seconds
13:30:28.026343 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: Close
13:30:28.095145 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:30:28.097259 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:30:28.097818 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_marts"} */

    show terse objects in SALES_PIPELINE.RAW_marts
13:30:28.098649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:30:28.809616 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.71 seconds
13:30:28.811765 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: Close
13:30:28.878421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:30:28.879280 [info ] [MainThread]: 
13:30:28.890403 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:30:28.891388 [info ] [Thread-1  ]: 1 of 42 START test not_null_mart_daily_sales_date............................... [RUN]
13:30:28.892064 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:30:28.892580 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:30:28.893050 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:30:28.899586 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:30:28.908467 [debug] [Thread-1  ]: finished collecting timing info
13:30:28.909237 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:30:28.920165 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:30:28.929347 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:30:28.930125 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_daily_sales
where date is null



      
    ) dbt_internal_test
13:30:28.930682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:29.603962 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
13:30:29.610419 [debug] [Thread-1  ]: finished collecting timing info
13:30:29.611348 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861: Close
13:30:29.675671 [info ] [Thread-1  ]: 1 of 42 PASS not_null_mart_daily_sales_date..................................... [[32mPASS[0m in 0.78s]
13:30:29.676777 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:30:29.677604 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:30:29.678351 [info ] [Thread-1  ]: 2 of 42 START test not_null_mart_daily_sales_item_id............................ [RUN]
13:30:29.679164 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:30:29.679799 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:30:29.680368 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:30:29.683365 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:30:29.690223 [debug] [Thread-1  ]: finished collecting timing info
13:30:29.691089 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:30:29.692900 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:30:29.700316 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:30:29.701062 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_daily_sales
where item_id is null



      
    ) dbt_internal_test
13:30:29.701666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:30.368855 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.67 seconds
13:30:30.370908 [debug] [Thread-1  ]: finished collecting timing info
13:30:30.371621 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f: Close
13:30:30.442858 [info ] [Thread-1  ]: 2 of 42 PASS not_null_mart_daily_sales_item_id.................................. [[32mPASS[0m in 0.76s]
13:30:30.443762 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:30:30.444381 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:30:30.444939 [info ] [Thread-1  ]: 3 of 42 START test not_null_mart_daily_sales_shop_id............................ [RUN]
13:30:30.445568 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:30:30.446082 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:30:30.446608 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:30:30.449459 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:30:30.455711 [debug] [Thread-1  ]: finished collecting timing info
13:30:30.456280 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:30:30.458559 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:30:30.464534 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:30:30.465207 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_daily_sales
where shop_id is null



      
    ) dbt_internal_test
13:30:30.465699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:31.053147 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
13:30:31.055021 [debug] [Thread-1  ]: finished collecting timing info
13:30:31.055799 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50: Close
13:30:31.130010 [info ] [Thread-1  ]: 3 of 42 PASS not_null_mart_daily_sales_shop_id.................................. [[32mPASS[0m in 0.68s]
13:30:31.131053 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:30:31.131646 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:30:31.132154 [info ] [Thread-1  ]: 4 of 42 START test not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM........ [RUN]
13:30:31.132861 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:30:31.133411 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:30:31.133989 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:30:31.137538 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:30:31.144280 [debug] [Thread-1  ]: finished collecting timing info
13:30:31.144880 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:30:31.146876 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:30:31.154229 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:30:31.154751 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_item_monthly_consistency
where DATE_BLOCK_NUM is null



      
    ) dbt_internal_test
13:30:31.155264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:31.784312 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
13:30:31.785850 [debug] [Thread-1  ]: finished collecting timing info
13:30:31.786254 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b: Close
13:30:31.853819 [info ] [Thread-1  ]: 4 of 42 PASS not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.............. [[32mPASS[0m in 0.72s]
13:30:31.854814 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:30:31.855809 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:30:31.856258 [info ] [Thread-1  ]: 5 of 42 START test not_null_mart_item_monthly_consistency_ITEM_ID............... [RUN]
13:30:31.856925 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:30:31.857459 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:30:31.857851 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:30:31.861068 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:30:31.867372 [debug] [Thread-1  ]: finished collecting timing info
13:30:31.867927 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:30:31.869843 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:30:31.877962 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:30:31.878581 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_item_monthly_consistency
where ITEM_ID is null



      
    ) dbt_internal_test
13:30:31.879221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:32.496456 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
13:30:32.498663 [debug] [Thread-1  ]: finished collecting timing info
13:30:32.499506 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b: Close
13:30:32.568680 [info ] [Thread-1  ]: 5 of 42 PASS not_null_mart_item_monthly_consistency_ITEM_ID..................... [[32mPASS[0m in 0.71s]
13:30:32.569987 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:30:32.570839 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:30:32.571659 [info ] [Thread-1  ]: 6 of 42 START test not_null_mart_item_monthly_consistency_MONTHLY_REVENUE....... [RUN]
13:30:32.572607 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:30:32.573247 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:30:32.573886 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:30:32.576817 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:30:32.583795 [debug] [Thread-1  ]: finished collecting timing info
13:30:32.584612 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:30:32.586467 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:30:32.594286 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:30:32.595094 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_item_monthly_consistency
where MONTHLY_REVENUE is null



      
    ) dbt_internal_test
13:30:32.595609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:33.195433 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
13:30:33.197331 [debug] [Thread-1  ]: finished collecting timing info
13:30:33.197865 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5: Close
13:30:33.261597 [info ] [Thread-1  ]: 6 of 42 PASS not_null_mart_item_monthly_consistency_MONTHLY_REVENUE............. [[32mPASS[0m in 0.69s]
13:30:33.262451 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:30:33.263130 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:30:33.263803 [info ] [Thread-1  ]: 7 of 42 START test not_null_mart_monthly_sales_date_block_num................... [RUN]
13:30:33.264483 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:30:33.265170 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:30:33.265643 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:30:33.268605 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:30:33.274752 [debug] [Thread-1  ]: finished collecting timing info
13:30:33.275543 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:30:33.277688 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:30:33.285828 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:30:33.286559 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_monthly_sales
where date_block_num is null



      
    ) dbt_internal_test
13:30:33.287168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:33.850926 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
13:30:33.852863 [debug] [Thread-1  ]: finished collecting timing info
13:30:33.853545 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562: Close
13:30:33.918953 [info ] [Thread-1  ]: 7 of 42 PASS not_null_mart_monthly_sales_date_block_num......................... [[32mPASS[0m in 0.65s]
13:30:33.920151 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:30:33.920906 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:30:33.921438 [info ] [Thread-1  ]: 8 of 42 START test not_null_mart_monthly_sales_item_id.......................... [RUN]
13:30:33.922194 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:30:33.922726 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:30:33.923245 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:30:33.925963 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:30:33.932146 [debug] [Thread-1  ]: finished collecting timing info
13:30:33.932918 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:30:33.935315 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:30:33.941609 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:30:33.942169 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_monthly_sales
where item_id is null



      
    ) dbt_internal_test
13:30:33.942605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:34.558551 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
13:30:34.560941 [debug] [Thread-1  ]: finished collecting timing info
13:30:34.562161 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8: Close
13:30:34.635041 [info ] [Thread-1  ]: 8 of 42 PASS not_null_mart_monthly_sales_item_id................................ [[32mPASS[0m in 0.71s]
13:30:34.635936 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:30:34.636482 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:30:34.637068 [info ] [Thread-1  ]: 9 of 42 START test not_null_mart_monthly_sales_shop_id.......................... [RUN]
13:30:34.637754 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:30:34.638274 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:30:34.638703 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:30:34.641238 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:30:34.646637 [debug] [Thread-1  ]: finished collecting timing info
13:30:34.647237 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:30:34.649146 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:30:34.655226 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:30:34.655814 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_monthly_sales
where shop_id is null



      
    ) dbt_internal_test
13:30:34.656298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:35.225232 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
13:30:35.227095 [debug] [Thread-1  ]: finished collecting timing info
13:30:35.227814 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a: Close
13:30:35.293686 [info ] [Thread-1  ]: 9 of 42 PASS not_null_mart_monthly_sales_shop_id................................ [[32mPASS[0m in 0.66s]
13:30:35.294586 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:30:35.295144 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:30:35.295649 [info ] [Thread-1  ]: 10 of 42 START test not_null_mart_revenue_by_month_date_block_num............... [RUN]
13:30:35.296298 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:30:35.296818 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:30:35.297291 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:30:35.299889 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:30:35.305355 [debug] [Thread-1  ]: finished collecting timing info
13:30:35.305876 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:30:35.307495 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:30:35.313254 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:30:35.313850 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_revenue_by_month
where date_block_num is null



      
    ) dbt_internal_test
13:30:35.314390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:35.925140 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
13:30:35.927100 [debug] [Thread-1  ]: finished collecting timing info
13:30:35.928124 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f: Close
13:30:35.994367 [info ] [Thread-1  ]: 10 of 42 PASS not_null_mart_revenue_by_month_date_block_num..................... [[32mPASS[0m in 0.70s]
13:30:35.995236 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:30:35.995846 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:30:35.996281 [info ] [Thread-1  ]: 11 of 42 START test not_null_mart_revenue_by_month_monthly_revenue.............. [RUN]
13:30:35.996974 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:30:35.997573 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:30:35.997939 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:30:36.000631 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:30:36.006136 [debug] [Thread-1  ]: finished collecting timing info
13:30:36.006883 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:30:36.044434 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:30:36.050983 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:30:36.051470 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_revenue_by_month
where monthly_revenue is null



      
    ) dbt_internal_test
13:30:36.051921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:36.693531 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
13:30:36.695479 [debug] [Thread-1  ]: finished collecting timing info
13:30:36.696191 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b: Close
13:30:36.767162 [info ] [Thread-1  ]: 11 of 42 PASS not_null_mart_revenue_by_month_monthly_revenue.................... [[32mPASS[0m in 0.77s]
13:30:36.768153 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:30:36.769213 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:30:36.769765 [info ] [Thread-1  ]: 12 of 42 START test not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID...... [RUN]
13:30:36.770444 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:30:36.770938 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:30:36.771328 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:30:36.774200 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:30:36.780381 [debug] [Thread-1  ]: finished collecting timing info
13:30:36.781161 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:30:36.782722 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:30:36.789533 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:30:36.790209 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_seasonality_by_category
where ITEM_CATEGORY_ID is null



      
    ) dbt_internal_test
13:30:36.790812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:37.433268 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
13:30:37.435292 [debug] [Thread-1  ]: finished collecting timing info
13:30:37.435957 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028: Close
13:30:37.503318 [info ] [Thread-1  ]: 12 of 42 PASS not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID............ [[32mPASS[0m in 0.73s]
13:30:37.504301 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:30:37.505015 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:30:37.505525 [info ] [Thread-1  ]: 13 of 42 START test not_null_mart_seasonality_by_category_MONTH_LABEL........... [RUN]
13:30:37.506259 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:30:37.506827 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:30:37.507294 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:30:37.510071 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:30:37.516807 [debug] [Thread-1  ]: finished collecting timing info
13:30:37.517544 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:30:37.519428 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:30:37.525945 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:30:37.526578 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_seasonality_by_category
where MONTH_LABEL is null



      
    ) dbt_internal_test
13:30:37.527242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:38.316635 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
13:30:38.318442 [debug] [Thread-1  ]: finished collecting timing info
13:30:38.319152 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d: Close
13:30:38.390972 [info ] [Thread-1  ]: 13 of 42 PASS not_null_mart_seasonality_by_category_MONTH_LABEL................. [[32mPASS[0m in 0.88s]
13:30:38.392113 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:30:38.392992 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:30:38.393768 [info ] [Thread-1  ]: 14 of 42 START test not_null_mart_seasonality_by_category_SEASONALITY_SCORE..... [RUN]
13:30:38.395012 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:30:38.395904 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:30:38.396629 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:30:38.400506 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:30:38.409231 [debug] [Thread-1  ]: finished collecting timing info
13:30:38.410025 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:30:38.412664 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:30:38.421290 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:30:38.421981 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_seasonality_by_category
where SEASONALITY_SCORE is null



      
    ) dbt_internal_test
13:30:38.422629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:39.246865 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
13:30:39.249022 [debug] [Thread-1  ]: finished collecting timing info
13:30:39.249653 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3: Close
13:30:39.318923 [info ] [Thread-1  ]: 14 of 42 PASS not_null_mart_seasonality_by_category_SEASONALITY_SCORE........... [[32mPASS[0m in 0.92s]
13:30:39.320001 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:30:39.320827 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:30:39.321560 [info ] [Thread-1  ]: 15 of 42 START test not_null_mart_shop_category_matrix_item_category_id......... [RUN]
13:30:39.322274 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:30:39.322904 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:30:39.323409 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:30:39.326226 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:30:39.332734 [debug] [Thread-1  ]: finished collecting timing info
13:30:39.333472 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:30:39.335406 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:30:39.341577 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:30:39.342139 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_category_matrix
where item_category_id is null



      
    ) dbt_internal_test
13:30:39.342652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:39.974741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
13:30:39.976747 [debug] [Thread-1  ]: finished collecting timing info
13:30:39.977395 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39: Close
13:30:40.046508 [info ] [Thread-1  ]: 15 of 42 PASS not_null_mart_shop_category_matrix_item_category_id............... [[32mPASS[0m in 0.72s]
13:30:40.047613 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:30:40.048418 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:30:40.049162 [info ] [Thread-1  ]: 16 of 42 START test not_null_mart_shop_category_matrix_shop_id.................. [RUN]
13:30:40.050050 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:30:40.050732 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:30:40.051266 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:30:40.054313 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:30:40.062600 [debug] [Thread-1  ]: finished collecting timing info
13:30:40.063305 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:30:40.065155 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:30:40.072024 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:30:40.072669 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_category_matrix
where shop_id is null



      
    ) dbt_internal_test
13:30:40.073189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:40.727641 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
13:30:40.729630 [debug] [Thread-1  ]: finished collecting timing info
13:30:40.730271 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575: Close
13:30:40.795429 [info ] [Thread-1  ]: 16 of 42 PASS not_null_mart_shop_category_matrix_shop_id........................ [[32mPASS[0m in 0.75s]
13:30:40.796417 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:30:40.797121 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:30:40.797663 [info ] [Thread-1  ]: 17 of 42 START test not_null_mart_shop_profile_AVG_ITEM_PRICE................... [RUN]
13:30:40.798494 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:30:40.799096 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:30:40.799625 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:30:40.802550 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:30:40.809212 [debug] [Thread-1  ]: finished collecting timing info
13:30:40.809932 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:30:40.811909 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:30:40.818181 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:30:40.819121 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where AVG_ITEM_PRICE is null



      
    ) dbt_internal_test
13:30:40.819705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:41.463043 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
13:30:41.464897 [debug] [Thread-1  ]: finished collecting timing info
13:30:41.465443 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798: Close
13:30:41.529675 [info ] [Thread-1  ]: 17 of 42 PASS not_null_mart_shop_profile_AVG_ITEM_PRICE......................... [[32mPASS[0m in 0.73s]
13:30:41.530511 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:30:41.531160 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:30:41.531605 [info ] [Thread-1  ]: 18 of 42 START test not_null_mart_shop_profile_CATEGORY_COUNT................... [RUN]
13:30:41.532207 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:30:41.532876 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:30:41.533270 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:30:41.535762 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:30:41.542605 [debug] [Thread-1  ]: finished collecting timing info
13:30:41.543272 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:30:41.545448 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:30:41.551719 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:30:41.552292 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where CATEGORY_COUNT is null



      
    ) dbt_internal_test
13:30:41.552932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:42.126036 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
13:30:42.128273 [debug] [Thread-1  ]: finished collecting timing info
13:30:42.129436 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4: Close
13:30:42.198374 [info ] [Thread-1  ]: 18 of 42 PASS not_null_mart_shop_profile_CATEGORY_COUNT......................... [[32mPASS[0m in 0.67s]
13:30:42.199695 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:30:42.200738 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:30:42.201542 [info ] [Thread-1  ]: 19 of 42 START test not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE......... [RUN]
13:30:42.202456 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:30:42.203062 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:30:42.203774 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:30:42.206813 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:30:42.214695 [debug] [Thread-1  ]: finished collecting timing info
13:30:42.215339 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:30:42.218031 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:30:42.225557 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:30:42.226237 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where MONTHLY_REVENUE_VARIANCE is null



      
    ) dbt_internal_test
13:30:42.226841 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:42.852729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
13:30:42.854853 [debug] [Thread-1  ]: finished collecting timing info
13:30:42.855831 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607: Close
13:30:42.922111 [info ] [Thread-1  ]: 19 of 42 PASS not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE............... [[32mPASS[0m in 0.72s]
13:30:42.923120 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:30:42.923763 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:30:42.924329 [info ] [Thread-1  ]: 20 of 42 START test not_null_mart_shop_profile_REVENUE_PER_ITEM................. [RUN]
13:30:42.925264 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:30:42.925995 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:30:42.926497 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:30:42.929245 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:30:42.935285 [debug] [Thread-1  ]: finished collecting timing info
13:30:42.936097 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:30:42.938498 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:30:42.945111 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:30:42.945749 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where REVENUE_PER_ITEM is null



      
    ) dbt_internal_test
13:30:42.946252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:43.525670 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
13:30:43.527410 [debug] [Thread-1  ]: finished collecting timing info
13:30:43.528061 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b: Close
13:30:43.593377 [info ] [Thread-1  ]: 20 of 42 PASS not_null_mart_shop_profile_REVENUE_PER_ITEM....................... [[32mPASS[0m in 0.67s]
13:30:43.594256 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:30:43.594926 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:30:43.595455 [info ] [Thread-1  ]: 21 of 42 START test not_null_mart_shop_profile_SHOP_ID.......................... [RUN]
13:30:43.596145 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:30:43.596664 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:30:43.597126 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:30:43.599816 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:30:43.605578 [debug] [Thread-1  ]: finished collecting timing info
13:30:43.606143 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:30:43.607889 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:30:43.614145 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:30:43.614768 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where SHOP_ID is null



      
    ) dbt_internal_test
13:30:43.615234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:44.187652 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
13:30:44.189778 [debug] [Thread-1  ]: finished collecting timing info
13:30:44.190500 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6: Close
13:30:44.782810 [info ] [Thread-1  ]: 21 of 42 PASS not_null_mart_shop_profile_SHOP_ID................................ [[32mPASS[0m in 1.19s]
13:30:44.783602 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:30:44.784163 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:30:44.784641 [info ] [Thread-1  ]: 22 of 42 START test not_null_mart_shop_profile_SHOP_NAME........................ [RUN]
13:30:44.785325 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:30:44.785934 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:30:44.786467 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:30:44.789264 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:30:44.795924 [debug] [Thread-1  ]: finished collecting timing info
13:30:44.796726 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:30:44.798894 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:30:44.806204 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:30:44.807022 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where SHOP_NAME is null



      
    ) dbt_internal_test
13:30:44.807850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:45.376064 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
13:30:45.378045 [debug] [Thread-1  ]: finished collecting timing info
13:30:45.378731 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f: Close
13:30:45.445668 [info ] [Thread-1  ]: 22 of 42 PASS not_null_mart_shop_profile_SHOP_NAME.............................. [[32mPASS[0m in 0.66s]
13:30:45.446688 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:30:45.447324 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:30:45.447823 [info ] [Thread-1  ]: 23 of 42 START test not_null_mart_top_item_categories_item_category_id.......... [RUN]
13:30:45.448637 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:30:45.449112 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:30:45.449640 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:30:45.452249 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:30:45.457176 [debug] [Thread-1  ]: finished collecting timing info
13:30:45.457793 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:30:45.459625 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:30:45.466026 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:30:45.466831 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_item_categories
where item_category_id is null



      
    ) dbt_internal_test
13:30:45.467329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:46.120551 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.65 seconds
13:30:46.122348 [debug] [Thread-1  ]: finished collecting timing info
13:30:46.122911 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb: Close
13:30:46.194186 [info ] [Thread-1  ]: 23 of 42 PASS not_null_mart_top_item_categories_item_category_id................ [[32mPASS[0m in 0.75s]
13:30:46.195174 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:30:46.196012 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:30:46.196561 [info ] [Thread-1  ]: 24 of 42 START test not_null_mart_top_item_categories_total_revenue............. [RUN]
13:30:46.197640 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:30:46.198662 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:30:46.199294 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:30:46.202830 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:30:46.210228 [debug] [Thread-1  ]: finished collecting timing info
13:30:46.211141 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:30:46.213099 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:30:46.220486 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:30:46.221074 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_item_categories
where total_revenue is null



      
    ) dbt_internal_test
13:30:46.221863 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:46.848015 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
13:30:46.850043 [debug] [Thread-1  ]: finished collecting timing info
13:30:46.850684 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765: Close
13:30:46.913612 [info ] [Thread-1  ]: 24 of 42 PASS not_null_mart_top_item_categories_total_revenue................... [[32mPASS[0m in 0.72s]
13:30:46.914486 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:30:46.915225 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:30:46.915806 [info ] [Thread-1  ]: 25 of 42 START test not_null_mart_top_shops_shop_id............................. [RUN]
13:30:46.916555 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:30:46.917080 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:30:46.917564 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:30:46.920249 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:30:46.927771 [debug] [Thread-1  ]: finished collecting timing info
13:30:46.928517 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:30:46.930548 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:30:46.936773 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:30:46.937502 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_shops
where shop_id is null



      
    ) dbt_internal_test
13:30:46.938201 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:47.626737 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
13:30:47.628789 [debug] [Thread-1  ]: finished collecting timing info
13:30:47.629447 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83: Close
13:30:47.697600 [info ] [Thread-1  ]: 25 of 42 PASS not_null_mart_top_shops_shop_id................................... [[32mPASS[0m in 0.78s]
13:30:47.698433 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:30:47.699065 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:30:47.699527 [info ] [Thread-1  ]: 26 of 42 START test not_null_mart_top_shops_total_revenue....................... [RUN]
13:30:47.700479 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:30:47.701180 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:30:47.701692 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:30:47.704082 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:30:47.711027 [debug] [Thread-1  ]: finished collecting timing info
13:30:47.711715 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:30:47.714011 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:30:47.721487 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:30:47.722184 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_shops
where total_revenue is null



      
    ) dbt_internal_test
13:30:47.722792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:48.544680 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.82 seconds
13:30:48.546394 [debug] [Thread-1  ]: finished collecting timing info
13:30:48.547001 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001: Close
13:30:48.619202 [info ] [Thread-1  ]: 26 of 42 PASS not_null_mart_top_shops_total_revenue............................. [[32mPASS[0m in 0.92s]
13:30:48.620103 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:30:48.620700 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:30:48.621130 [info ] [Thread-1  ]: 27 of 42 START test not_null_mart_total_revenue_total_revenue................... [RUN]
13:30:48.622124 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:30:48.622688 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:30:48.623127 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:30:48.625583 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:30:48.632363 [debug] [Thread-1  ]: finished collecting timing info
13:30:48.633083 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:30:48.634950 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:30:48.641385 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:30:48.642003 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_total_revenue
where total_revenue is null



      
    ) dbt_internal_test
13:30:48.642484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:49.263044 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
13:30:49.264872 [debug] [Thread-1  ]: finished collecting timing info
13:30:49.265357 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6: Close
13:30:49.333413 [info ] [Thread-1  ]: 27 of 42 PASS not_null_mart_total_revenue_total_revenue......................... [[32mPASS[0m in 0.71s]
13:30:49.334221 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:30:49.334822 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:30:49.335218 [info ] [Thread-1  ]: 28 of 42 START test not_null_stg_item_categories_item_category_id............... [RUN]
13:30:49.336028 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:30:49.336776 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:30:49.337199 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:30:49.340170 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:30:49.347586 [debug] [Thread-1  ]: finished collecting timing info
13:30:49.348254 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:30:49.350193 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:30:49.357759 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:30:49.358370 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_item_categories
where item_category_id is null



      
    ) dbt_internal_test
13:30:49.358833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:49.950484 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
13:30:49.952331 [debug] [Thread-1  ]: finished collecting timing info
13:30:49.952909 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: Close
13:30:50.027516 [info ] [Thread-1  ]: 28 of 42 PASS not_null_stg_item_categories_item_category_id..................... [[32mPASS[0m in 0.69s]
13:30:50.028668 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:30:50.029408 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:30:50.029874 [info ] [Thread-1  ]: 29 of 42 START test not_null_stg_item_categories_item_category_name............. [RUN]
13:30:50.030648 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:30:50.031101 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:30:50.031637 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:30:50.034528 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:30:50.040727 [debug] [Thread-1  ]: finished collecting timing info
13:30:50.041382 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:30:50.043249 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:30:50.049874 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:30:50.050553 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_item_categories
where item_category_name is null



      
    ) dbt_internal_test
13:30:50.051107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:50.644239 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
13:30:50.646156 [debug] [Thread-1  ]: finished collecting timing info
13:30:50.646653 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: Close
13:30:50.713572 [info ] [Thread-1  ]: 29 of 42 PASS not_null_stg_item_categories_item_category_name................... [[32mPASS[0m in 0.68s]
13:30:50.714492 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:30:50.715141 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:30:50.715636 [info ] [Thread-1  ]: 30 of 42 START test not_null_stg_items_item_id.................................. [RUN]
13:30:50.716334 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:30:50.716857 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:30:50.717242 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:30:50.719886 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:30:50.726525 [debug] [Thread-1  ]: finished collecting timing info
13:30:50.727218 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:30:50.729197 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:30:50.735604 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:30:50.736334 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_items
where item_id is null



      
    ) dbt_internal_test
13:30:50.737216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:51.504287 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.77 seconds
13:30:51.506316 [debug] [Thread-1  ]: finished collecting timing info
13:30:51.507131 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: Close
13:30:51.574017 [info ] [Thread-1  ]: 30 of 42 PASS not_null_stg_items_item_id........................................ [[32mPASS[0m in 0.86s]
13:30:51.574906 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:30:51.575617 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:30:51.576054 [info ] [Thread-1  ]: 31 of 42 START test not_null_stg_items_item_name................................ [RUN]
13:30:51.576745 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:30:51.577186 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:30:51.577595 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:30:51.580109 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:30:51.584377 [debug] [Thread-1  ]: finished collecting timing info
13:30:51.585010 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:30:51.586851 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:30:51.593189 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:30:51.594017 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_items
where item_name is null



      
    ) dbt_internal_test
13:30:51.594754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:52.210515 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
13:30:52.212311 [debug] [Thread-1  ]: finished collecting timing info
13:30:52.213042 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: Close
13:30:52.284419 [info ] [Thread-1  ]: 31 of 42 PASS not_null_stg_items_item_name...................................... [[32mPASS[0m in 0.71s]
13:30:52.285414 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:30:52.285978 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:30:52.286505 [info ] [Thread-1  ]: 32 of 42 START test not_null_stg_sales_train_date............................... [RUN]
13:30:52.287181 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:30:52.287772 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:30:52.288277 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:30:52.291271 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:30:52.296699 [debug] [Thread-1  ]: finished collecting timing info
13:30:52.297209 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:30:52.299020 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:30:52.305033 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:30:52.305577 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where date is null



      
    ) dbt_internal_test
13:30:52.306028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:52.894716 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
13:30:52.896388 [debug] [Thread-1  ]: finished collecting timing info
13:30:52.897042 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9: Close
13:30:52.963846 [info ] [Thread-1  ]: 32 of 42 PASS not_null_stg_sales_train_date..................................... [[32mPASS[0m in 0.68s]
13:30:52.964746 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:30:52.965398 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:30:52.965912 [info ] [Thread-1  ]: 33 of 42 START test not_null_stg_sales_train_date_block_num..................... [RUN]
13:30:52.966631 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:30:52.967152 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:30:52.967659 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:30:52.970298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:30:52.976079 [debug] [Thread-1  ]: finished collecting timing info
13:30:52.976722 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:30:52.978475 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:30:52.985652 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:30:52.986253 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where date_block_num is null



      
    ) dbt_internal_test
13:30:52.986797 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:53.570673 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
13:30:53.572465 [debug] [Thread-1  ]: finished collecting timing info
13:30:53.573057 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d: Close
13:30:53.641962 [info ] [Thread-1  ]: 33 of 42 PASS not_null_stg_sales_train_date_block_num........................... [[32mPASS[0m in 0.68s]
13:30:53.642967 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:30:53.643554 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:30:53.644059 [info ] [Thread-1  ]: 34 of 42 START test not_null_stg_sales_train_item_cnt_day....................... [RUN]
13:30:53.644908 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:30:53.645608 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:30:53.646464 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:30:53.649592 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:30:53.657762 [debug] [Thread-1  ]: finished collecting timing info
13:30:53.658950 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:30:53.661129 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:30:53.669108 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:30:53.669874 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where item_cnt_day is null



      
    ) dbt_internal_test
13:30:53.670543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:54.273808 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
13:30:54.275525 [debug] [Thread-1  ]: finished collecting timing info
13:30:54.276285 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7: Close
13:30:54.344287 [info ] [Thread-1  ]: 34 of 42 PASS not_null_stg_sales_train_item_cnt_day............................. [[32mPASS[0m in 0.70s]
13:30:54.345228 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:30:54.345916 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:30:54.346322 [info ] [Thread-1  ]: 35 of 42 START test not_null_stg_sales_train_item_id............................ [RUN]
13:30:54.347124 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:30:54.347620 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:30:54.348043 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:30:54.351070 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:30:54.356352 [debug] [Thread-1  ]: finished collecting timing info
13:30:54.357154 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:30:54.359348 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:30:54.364639 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:30:54.365256 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where item_id is null



      
    ) dbt_internal_test
13:30:54.365791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:54.939063 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
13:30:54.940835 [debug] [Thread-1  ]: finished collecting timing info
13:30:54.941324 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8: Close
13:30:55.008127 [info ] [Thread-1  ]: 35 of 42 PASS not_null_stg_sales_train_item_id.................................. [[32mPASS[0m in 0.66s]
13:30:55.009190 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:30:55.009980 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:30:55.010403 [info ] [Thread-1  ]: 36 of 42 START test not_null_stg_sales_train_item_price......................... [RUN]
13:30:55.011024 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:30:55.011554 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:30:55.012144 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:30:55.014614 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:30:55.020064 [debug] [Thread-1  ]: finished collecting timing info
13:30:55.020726 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:30:55.022953 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:30:55.030165 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:30:55.030935 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where item_price is null



      
    ) dbt_internal_test
13:30:55.031635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:55.608576 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
13:30:55.610713 [debug] [Thread-1  ]: finished collecting timing info
13:30:55.611526 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da: Close
13:30:55.680324 [info ] [Thread-1  ]: 36 of 42 PASS not_null_stg_sales_train_item_price............................... [[32mPASS[0m in 0.67s]
13:30:55.681398 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:30:55.682079 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:30:55.682636 [info ] [Thread-1  ]: 37 of 42 START test not_null_stg_sales_train_shop_id............................ [RUN]
13:30:55.683383 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:30:55.683928 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:30:55.684395 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:30:55.687174 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:30:55.693222 [debug] [Thread-1  ]: finished collecting timing info
13:30:55.693863 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:30:55.695726 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:30:55.702820 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:30:55.703397 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where shop_id is null



      
    ) dbt_internal_test
13:30:55.703982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:56.292210 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
13:30:56.293878 [debug] [Thread-1  ]: finished collecting timing info
13:30:56.294580 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831: Close
13:30:56.364364 [info ] [Thread-1  ]: 37 of 42 PASS not_null_stg_sales_train_shop_id.................................. [[32mPASS[0m in 0.68s]
13:30:56.365135 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:30:56.365763 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:30:56.366217 [info ] [Thread-1  ]: 38 of 42 START test not_null_stg_shops_shop_id.................................. [RUN]
13:30:56.367101 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:30:56.367661 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:30:56.368084 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:30:56.370586 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:30:56.377034 [debug] [Thread-1  ]: finished collecting timing info
13:30:56.377611 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:30:56.379253 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:30:56.384860 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:30:56.385342 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_shops
where shop_id is null



      
    ) dbt_internal_test
13:30:56.385781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:56.979316 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
13:30:56.981427 [debug] [Thread-1  ]: finished collecting timing info
13:30:56.982117 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: Close
13:30:57.070289 [info ] [Thread-1  ]: 38 of 42 PASS not_null_stg_shops_shop_id........................................ [[32mPASS[0m in 0.70s]
13:30:57.071166 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:30:57.071825 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:30:57.072411 [info ] [Thread-1  ]: 39 of 42 START test not_null_stg_shops_shop_name................................ [RUN]
13:30:57.073104 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:30:57.073628 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:30:57.074081 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:30:57.077019 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:30:57.081960 [debug] [Thread-1  ]: finished collecting timing info
13:30:57.082824 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:30:57.084715 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:30:57.090085 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:30:57.090666 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_shops
where shop_name is null



      
    ) dbt_internal_test
13:30:57.091077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:57.778095 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
13:30:57.780117 [debug] [Thread-1  ]: finished collecting timing info
13:30:57.780772 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: Close
13:30:57.847894 [info ] [Thread-1  ]: 39 of 42 PASS not_null_stg_shops_shop_name...................................... [[32mPASS[0m in 0.77s]
13:30:57.848879 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:30:57.849577 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:30:57.850307 [info ] [Thread-1  ]: 40 of 42 START test unique_stg_item_categories_item_category_id................. [RUN]
13:30:57.851289 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:30:57.852008 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:30:57.852717 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:30:57.859223 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:30:57.867971 [debug] [Thread-1  ]: finished collecting timing info
13:30:57.868831 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:30:57.870774 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:30:57.879071 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:30:57.880150 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_category_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.RAW_staging.stg_item_categories
where item_category_id is not null
group by item_category_id
having count(*) > 1



      
    ) dbt_internal_test
13:30:57.880795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:58.504050 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.62 seconds
13:30:58.505878 [debug] [Thread-1  ]: finished collecting timing info
13:30:58.506448 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: Close
13:30:58.573643 [info ] [Thread-1  ]: 40 of 42 PASS unique_stg_item_categories_item_category_id....................... [[32mPASS[0m in 0.72s]
13:30:58.574568 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:30:58.575174 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:30:58.575670 [info ] [Thread-1  ]: 41 of 42 START test unique_stg_items_item_id.................................... [RUN]
13:30:58.576309 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:30:58.576982 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:30:58.577419 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:30:58.580145 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:30:58.585237 [debug] [Thread-1  ]: finished collecting timing info
13:30:58.585742 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:30:58.587478 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:30:58.593817 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:30:58.594496 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.RAW_staging.stg_items
where item_id is not null
group by item_id
having count(*) > 1



      
    ) dbt_internal_test
13:30:58.595034 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:30:59.387345 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
13:30:59.389094 [debug] [Thread-1  ]: finished collecting timing info
13:30:59.389582 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: Close
13:30:59.460128 [info ] [Thread-1  ]: 41 of 42 PASS unique_stg_items_item_id.......................................... [[32mPASS[0m in 0.88s]
13:30:59.461291 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:30:59.461875 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:30:59.462406 [info ] [Thread-1  ]: 42 of 42 START test unique_stg_shops_shop_id.................................... [RUN]
13:30:59.463321 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:30:59.463983 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:30:59.464649 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:30:59.467435 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:30:59.476418 [debug] [Thread-1  ]: finished collecting timing info
13:30:59.477396 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:30:59.479335 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:30:59.487223 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:30:59.488170 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    shop_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.RAW_staging.stg_shops
where shop_id is not null
group by shop_id
having count(*) > 1



      
    ) dbt_internal_test
13:30:59.488938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:31:00.114054 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.63 seconds
13:31:00.115942 [debug] [Thread-1  ]: finished collecting timing info
13:31:00.116486 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: Close
13:31:00.183815 [info ] [Thread-1  ]: 42 of 42 PASS unique_stg_shops_shop_id.......................................... [[32mPASS[0m in 0.72s]
13:31:00.184652 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:31:00.186175 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:31:00.186773 [info ] [MainThread]: 
13:31:00.187299 [info ] [MainThread]: Finished running 42 tests in 33.15s.
13:31:00.187956 [debug] [MainThread]: Connection 'master' was properly closed.
13:31:00.188473 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3' was properly closed.
13:31:00.202754 [info ] [MainThread]: 
13:31:00.203623 [info ] [MainThread]: [32mCompleted successfully[0m
13:31:00.204450 [info ] [MainThread]: 
13:31:00.205144 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 TOTAL=42
13:31:00.205857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718219f3ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71821aec9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718219b0af10>]}


============================== 2025-08-05 13:31:11.871019 | 82041513-4c49-4fac-94b5-1cb666e1c616 ==============================
13:31:11.871019 [info ] [MainThread]: Running with dbt=1.0.0
13:31:11.872149 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:31:11.872871 [debug] [MainThread]: Tracking: tracking
13:31:11.873661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700584664ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700584664a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700584664a00>]}
13:33:40.041969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:33:40.042651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:33:40.043707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:33:40.049224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82041513-4c49-4fac-94b5-1cb666e1c616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700583534f10>]}
13:33:40.065761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82041513-4c49-4fac-94b5-1cb666e1c616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700584626040>]}
13:33:40.066544 [info ] [MainThread]: Found 17 models, 42 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:33:40.069655 [info ] [MainThread]: 
13:33:40.070927 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:33:40.072702 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:33:40.082024 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:33:40.082834 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_staging"} */

    show terse objects in SALES_PIPELINE.RAW_staging
13:33:40.083365 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:33:41.166660 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.08 seconds
13:33:41.169220 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: Close
13:33:41.238901 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:33:41.242019 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:33:41.242630 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_marts"} */

    show terse objects in SALES_PIPELINE.RAW_marts
13:33:41.243109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:33:41.808103 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.56 seconds
13:33:41.810565 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: Close
13:33:41.879021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:33:41.880059 [info ] [MainThread]: 
13:33:41.892359 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
13:33:41.893474 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
13:33:41.894015 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
13:33:41.894549 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
13:33:41.895929 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
13:33:41.900989 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.901616 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
13:33:41.902145 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.902829 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
13:33:41.903276 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
13:33:41.904097 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
13:33:41.904482 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
13:33:41.904949 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
13:33:41.906216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
13:33:41.911065 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.911671 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
13:33:41.912116 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.912868 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
13:33:41.913347 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
13:33:41.914215 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
13:33:41.914654 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
13:33:41.915283 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
13:33:41.916529 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
13:33:41.921144 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.921711 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
13:33:41.922189 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.922808 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
13:33:41.923248 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_item_categories
13:33:41.923874 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
13:33:41.924225 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_item_categories
13:33:41.924677 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_item_categories
13:33:41.926824 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_item_categories"
13:33:41.931705 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.932365 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_item_categories
13:33:41.933010 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.933614 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_item_categories
13:33:41.934125 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_items
13:33:41.934863 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_items"
13:33:41.935288 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_items
13:33:41.935751 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_items
13:33:41.937887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_items"
13:33:41.942838 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.943324 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_items
13:33:41.943855 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.944479 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_items
13:33:41.944987 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_sales_train
13:33:41.945735 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
13:33:41.946167 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_sales_train
13:33:41.946486 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_sales_train
13:33:41.948489 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_sales_train"
13:33:41.952808 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.953361 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_sales_train
13:33:41.953830 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.954349 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_sales_train
13:33:41.954818 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_shops
13:33:41.955686 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_shops"
13:33:41.956095 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_shops
13:33:41.956615 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_shops
13:33:41.959264 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_shops"
13:33:41.965493 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.966449 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_shops
13:33:41.967260 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.967994 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_shops
13:33:41.968818 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:33:41.969718 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:33:41.970346 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:33:41.970930 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:33:41.978233 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:33:41.986354 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.987065 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:33:41.987544 [debug] [Thread-1  ]: finished collecting timing info
13:33:41.988204 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:33:41.988759 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:33:41.989342 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:33:41.989733 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:33:41.990196 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:33:41.993068 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:33:42.000911 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.001595 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:33:42.002305 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.003127 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:33:42.003816 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:33:42.004453 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:33:42.005069 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:33:42.005598 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:33:42.008167 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:33:42.016341 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.017129 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:33:42.017823 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.018620 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:33:42.019268 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:33:42.019949 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:33:42.020478 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:33:42.021070 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:33:42.024081 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:33:42.031429 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.032196 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:33:42.032986 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.033839 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:33:42.034457 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:33:42.035141 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:33:42.035720 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:33:42.036225 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:33:42.039150 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:33:42.046075 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.046717 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:33:42.047220 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.047858 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:33:42.048404 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:33:42.049137 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:33:42.049634 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:33:42.050088 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:33:42.054597 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:33:42.060501 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.061166 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:33:42.061688 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.062285 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:33:42.062804 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:33:42.063375 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:33:42.063823 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:33:42.064305 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:33:42.067102 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:33:42.073019 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.073714 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:33:42.074333 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.075058 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:33:42.075663 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:33:42.076338 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:33:42.076970 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:33:42.077573 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:33:42.080580 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:33:42.087755 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.088518 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:33:42.089172 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.089974 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:33:42.090587 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:33:42.091197 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:33:42.091703 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:33:42.092162 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:33:42.094998 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:33:42.101010 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.101625 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:33:42.102162 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.102823 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:33:42.103445 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.base_date
13:33:42.104128 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.base_date"
13:33:42.104621 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.base_date
13:33:42.105083 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.base_date
13:33:42.107136 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.base_date"
13:33:42.112771 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.113347 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.base_date
13:33:42.113826 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.114451 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.base_date
13:33:42.114953 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
13:33:42.115653 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
13:33:42.116131 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
13:33:42.116636 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
13:33:42.118820 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
13:33:42.125589 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.126286 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
13:33:42.126899 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.127713 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
13:33:42.128353 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:33:42.129299 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:33:42.129907 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:33:42.130616 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_item_monthly_consistency
13:33:42.133518 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:33:42.139696 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.140354 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:33:42.140931 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.141581 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:33:42.142265 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
13:33:42.142986 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:33:42.143437 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
13:33:42.143952 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
13:33:42.146757 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:33:42.154220 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.154956 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
13:33:42.155426 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.156038 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
13:33:42.156554 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_seasonality_by_category
13:33:42.157442 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:33:42.157974 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_seasonality_by_category
13:33:42.158515 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_seasonality_by_category
13:33:42.160994 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:33:42.167304 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.167882 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_seasonality_by_category
13:33:42.168408 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.169184 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_seasonality_by_category
13:33:42.169760 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
13:33:42.170423 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
13:33:42.170845 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
13:33:42.171301 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
13:33:42.173539 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
13:33:42.179143 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.179754 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
13:33:42.180242 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.180882 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
13:33:42.181396 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
13:33:42.181997 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
13:33:42.182414 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
13:33:42.182828 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
13:33:42.184759 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
13:33:42.190080 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.190605 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
13:33:42.191053 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.191666 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
13:33:42.192189 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:33:42.192790 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:33:42.193253 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:33:42.193695 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:33:42.196571 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:33:42.203605 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.204229 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:33:42.204835 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.205578 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:33:42.206255 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:33:42.206939 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:33:42.207451 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:33:42.207989 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:33:42.210990 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:33:42.216376 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.217024 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:33:42.217503 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.218097 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:33:42.218653 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:33:42.219221 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:33:42.219636 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:33:42.220042 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:33:42.222711 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:33:42.228353 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.228962 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:33:42.229419 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.229988 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:33:42.230499 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:33:42.231114 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:33:42.231533 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:33:42.231956 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:33:42.234502 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:33:42.239757 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.240359 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:33:42.240950 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.241892 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:33:42.242494 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:33:42.243124 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:33:42.243572 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:33:42.244037 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:33:42.246812 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:33:42.252043 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.252638 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:33:42.253123 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.253713 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:33:42.254243 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:33:42.254804 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:33:42.255224 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:33:42.255619 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:33:42.258373 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:33:42.263718 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.264309 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:33:42.264863 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.265436 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:33:42.265899 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
13:33:42.266528 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:33:42.267024 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
13:33:42.267470 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
13:33:42.269980 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:33:42.278247 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.278833 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
13:33:42.279316 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.279901 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
13:33:42.280420 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
13:33:42.281177 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:33:42.281587 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
13:33:42.281996 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
13:33:42.284367 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:33:42.289847 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.290405 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
13:33:42.290845 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.291519 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
13:33:42.292098 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
13:33:42.292926 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
13:33:42.293418 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
13:33:42.294003 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
13:33:42.297147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
13:33:42.303078 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.303681 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
13:33:42.304123 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.304772 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
13:33:42.305275 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:33:42.305994 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:33:42.306450 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:33:42.306889 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:33:42.309547 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:33:42.314911 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.315498 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:33:42.315967 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.316516 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:33:42.316981 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:33:42.317606 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:33:42.318095 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:33:42.318559 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:33:42.321216 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:33:42.325975 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.326527 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:33:42.327078 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.327717 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:33:42.328230 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:33:42.328862 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:33:42.329315 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:33:42.329760 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:33:42.332343 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:33:42.336796 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.337355 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:33:42.337819 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.338513 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:33:42.338964 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:33:42.339536 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:33:42.339982 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:33:42.340456 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:33:42.342977 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:33:42.348437 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.348997 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:33:42.349429 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.350157 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:33:42.350693 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:33:42.351265 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:33:42.351722 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:33:42.352116 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:33:42.354693 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:33:42.360524 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.361117 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:33:42.361608 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.362201 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:33:42.362651 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:33:42.363273 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:33:42.363725 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:33:42.364119 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:33:42.366837 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:33:42.372114 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.372656 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:33:42.373142 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.373706 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:33:42.374164 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:33:42.374804 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:33:42.375320 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:33:42.375695 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:33:42.378394 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:33:42.383580 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.384100 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:33:42.384493 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.385013 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:33:42.385469 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:33:42.386045 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:33:42.386545 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:33:42.387037 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:33:42.389736 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:33:42.395023 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.395534 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:33:42.396026 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.396906 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:33:42.397432 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:33:42.398032 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:33:42.398493 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:33:42.398884 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:33:42.401604 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:33:42.406582 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.407178 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:33:42.407632 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.408282 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:33:42.408904 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:33:42.409509 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:33:42.409905 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:33:42.410404 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:33:42.413218 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:33:42.418424 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.419011 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:33:42.419470 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.420061 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:33:42.420583 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:33:42.421245 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:33:42.421720 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:33:42.422133 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:33:42.425004 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:33:42.430664 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.431190 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:33:42.431623 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.432223 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:33:42.432693 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:33:42.433205 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:33:42.433634 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:33:42.433991 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:33:42.437611 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:33:42.443282 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.443824 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:33:42.444376 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.445131 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:33:42.445612 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:33:42.446182 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:33:42.446572 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:33:42.447094 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:33:42.488927 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:33:42.496455 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.497169 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:33:42.497635 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.498351 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:33:42.498912 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:33:42.499665 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:33:42.500193 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:33:42.500692 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:33:42.503359 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:33:42.509963 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.510585 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:33:42.511100 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.511846 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:33:42.512411 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:33:42.512962 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:33:42.513375 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:33:42.513776 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:33:42.516319 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:33:42.522712 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.523315 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:33:42.523795 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.524432 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:33:42.524967 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:33:42.525545 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:33:42.525961 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:33:42.526430 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:33:42.529207 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:33:42.535277 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.535867 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:33:42.536287 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.536903 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:33:42.537384 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:33:42.537991 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:33:42.538416 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:33:42.538850 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:33:42.541490 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:33:42.547418 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.548046 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:33:42.548553 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.549203 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:33:42.549714 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:33:42.550457 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:33:42.551105 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:33:42.551595 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:33:42.554219 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:33:42.560471 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.561105 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:33:42.561672 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.562352 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:33:42.562913 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:33:42.563499 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:33:42.563911 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:33:42.564291 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:33:42.566933 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:33:42.572547 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.573107 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:33:42.573511 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.574023 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:33:42.574404 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:33:42.574979 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:33:42.575341 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:33:42.575678 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:33:42.578265 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:33:42.583278 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.583848 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:33:42.584389 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.585062 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:33:42.585487 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:33:42.586022 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:33:42.586345 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:33:42.586851 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:33:42.589644 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:33:42.594917 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.595445 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:33:42.595871 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.596526 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:33:42.597353 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:33:42.597968 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:33:42.598571 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:33:42.599030 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:33:42.601661 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:33:42.607425 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.607935 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:33:42.608488 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.609319 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:33:42.609768 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:33:42.610320 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:33:42.610698 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:33:42.611152 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:33:42.613842 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:33:42.619105 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.619616 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:33:42.620058 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.620663 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:33:42.621168 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:33:42.621767 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:33:42.622228 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:33:42.622556 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:33:42.625113 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:33:42.630581 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.631089 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:33:42.631435 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.631937 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:33:42.632334 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:33:42.632866 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:33:42.633234 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:33:42.633650 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:33:42.637222 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:33:42.642284 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.642904 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:33:42.643350 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.643856 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:33:42.644224 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:33:42.644869 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:33:42.645301 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:33:42.645726 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:33:42.648324 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:33:42.653435 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.653895 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:33:42.654252 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.654732 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:33:42.655294 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:33:42.655852 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:33:42.656250 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:33:42.656647 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:33:42.659527 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:33:42.664663 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.665206 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:33:42.665608 [debug] [Thread-1  ]: finished collecting timing info
13:33:42.666277 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:33:42.667576 [debug] [MainThread]: Connection 'master' was properly closed.
13:33:42.668149 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001' was properly closed.
13:33:42.681364 [info ] [MainThread]: Done.
13:33:42.700092 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
13:33:42.700869 [info ] [MainThread]: Building catalog
13:33:42.703385 [debug] [ThreadPool]: Acquiring new snowflake connection "SALES_PIPELINE.information_schema"
13:33:42.708724 [debug] [ThreadPool]: Using snowflake connection "SALES_PIPELINE.information_schema"
13:33:42.709428 [debug] [ThreadPool]: On SALES_PIPELINE.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "SALES_PIPELINE.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from SALES_PIPELINE.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from SALES_PIPELINE.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw_staging') or upper("table_schema") = upper('raw') or upper("table_schema") = upper('raw_marts'))
      order by "column_index"
13:33:42.710243 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:33:45.196478 [debug] [ThreadPool]: SQL status: SUCCESS 81 in 2.49 seconds
13:33:45.209042 [debug] [ThreadPool]: On SALES_PIPELINE.information_schema: Close
13:33:45.295580 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
13:33:45.296698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x700589236b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7005893b4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70058267d310>]}
13:33:45.721951 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:33:45.723116 [debug] [MainThread]: Connection 'SALES_PIPELINE.information_schema' was properly closed.


============================== 2025-08-05 13:34:06.095338 | a7b412f1-ef7f-4fee-8586-564e9702b25b ==============================
13:34:06.095338 [info ] [MainThread]: Running with dbt=1.0.0
13:34:06.096166 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:34:06.096945 [debug] [MainThread]: Tracking: tracking
13:34:06.097522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f9f71c0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f9f71c0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f9f71c0a30>]}
13:34:06.110825 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
13:34:06.111717 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
13:34:06.112450 [info ] [MainThread]: 
13:34:06.113397 [info ] [MainThread]: 
13:34:06.114130 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 13:35:32.232919 | 99d659fd-1f99-4f31-a870-7fdccb3b67fd ==============================
13:35:32.232919 [info ] [MainThread]: Running with dbt=1.0.0
13:35:32.233774 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8001, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:35:32.234659 [debug] [MainThread]: Tracking: tracking
13:35:32.235296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a4cea9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a4cea9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2a4cea9a90>]}
13:35:32.248693 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
13:35:32.249420 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
13:35:32.250201 [info ] [MainThread]: 
13:35:32.250953 [info ] [MainThread]: 
13:35:32.251664 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 13:38:26.133966 | 5bad9a28-fa9e-472d-a2c3-0df397d47e78 ==============================
13:38:26.133966 [info ] [MainThread]: Running with dbt=1.0.0
13:38:26.135258 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8001, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:38:26.136266 [debug] [MainThread]: Tracking: tracking
13:38:26.137276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12a397fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12a397fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12a397fa60>]}
13:38:26.159334 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
13:38:26.160331 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
13:38:26.161277 [info ] [MainThread]: 
13:38:26.162330 [info ] [MainThread]: 
13:38:26.163455 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 13:48:25.205970 | 883a5f15-cb7e-4a4b-85d4-29b5b7791cad ==============================
13:48:25.205970 [info ] [MainThread]: Running with dbt=1.0.0
13:48:25.207144 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
13:48:25.207921 [debug] [MainThread]: Tracking: tracking
13:48:25.208453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ecc7eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ecc7eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ecc7ea60>]}
13:50:58.290655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
13:50:58.291605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
13:50:58.293086 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

13:50:58.299924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883a5f15-cb7e-4a4b-85d4-29b5b7791cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ebb34f70>]}
13:50:58.321211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883a5f15-cb7e-4a4b-85d4-29b5b7791cad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ecc41040>]}
13:50:58.322158 [info ] [MainThread]: Found 17 models, 42 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:50:58.326001 [info ] [MainThread]: 
13:50:58.327255 [debug] [MainThread]: Acquiring new snowflake connection "master"
13:50:58.329209 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:50:58.338558 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_staging"
13:50:58.339443 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_staging"} */

    show terse objects in SALES_PIPELINE.RAW_staging
13:50:58.339938 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:50:59.372422 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.03 seconds
13:50:59.374649 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: Close
13:50:59.455205 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:50:59.457466 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_marts"
13:50:59.458363 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_marts"} */

    show terse objects in SALES_PIPELINE.RAW_marts
13:50:59.458900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:51:00.151861 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.69 seconds
13:51:00.153622 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: Close
13:51:00.220388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:51:00.221429 [info ] [MainThread]: 
13:51:00.234002 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
13:51:00.235185 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
13:51:00.235743 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
13:51:00.236320 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
13:51:00.237791 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
13:51:00.244629 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.245247 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
13:51:00.245848 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.246619 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
13:51:00.247131 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
13:51:00.248081 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
13:51:00.248571 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
13:51:00.249116 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
13:51:00.250267 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
13:51:00.255347 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.255905 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
13:51:00.256343 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.256948 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
13:51:00.257342 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
13:51:00.257927 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
13:51:00.258343 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
13:51:00.258767 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
13:51:00.260064 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
13:51:00.265226 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.265835 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
13:51:00.266362 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.267001 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
13:51:00.267507 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_item_categories
13:51:00.268213 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
13:51:00.268584 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_item_categories
13:51:00.269036 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_item_categories
13:51:00.271143 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_item_categories"
13:51:00.276476 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.277277 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_item_categories
13:51:00.277849 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.278501 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_item_categories
13:51:00.279076 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_items
13:51:00.279868 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_items"
13:51:00.280330 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_items
13:51:00.280804 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_items
13:51:00.282690 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_items"
13:51:00.287636 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.288270 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_items
13:51:00.288723 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.289608 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_items
13:51:00.290166 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_sales_train
13:51:00.291025 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
13:51:00.291526 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_sales_train
13:51:00.292189 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_sales_train
13:51:00.295231 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_sales_train"
13:51:00.300413 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.300996 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_sales_train
13:51:00.301578 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.302168 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_sales_train
13:51:00.302724 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_shops
13:51:00.303624 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_shops"
13:51:00.303977 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_shops
13:51:00.304309 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_shops
13:51:00.307199 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_shops"
13:51:00.313583 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.314194 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_shops
13:51:00.314814 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.315463 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_shops
13:51:00.316122 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:51:00.317126 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:51:00.317659 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:51:00.318234 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:51:00.325831 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
13:51:00.333534 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.334077 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:51:00.334555 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.335168 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
13:51:00.335680 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:51:00.336235 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:51:00.336648 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:51:00.337031 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:51:00.339869 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
13:51:00.346464 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.347047 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:51:00.347614 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.348273 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
13:51:00.348742 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:51:00.349325 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:51:00.349813 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:51:00.350323 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:51:00.353068 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
13:51:00.359518 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.360203 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:51:00.360781 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.361467 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
13:51:00.361972 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:51:00.362544 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:51:00.362982 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:51:00.363448 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:51:00.366079 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
13:51:00.372377 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.372978 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:51:00.373428 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.374074 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
13:51:00.374687 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:51:00.375394 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:51:00.375866 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:51:00.376291 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:51:00.378820 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
13:51:00.384759 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.385347 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:51:00.385783 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.386394 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
13:51:00.386898 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:51:00.387567 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:51:00.388134 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:51:00.388644 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:51:00.393071 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
13:51:00.398912 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.399492 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:51:00.400011 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.400715 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
13:51:00.401303 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:51:00.401875 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:51:00.402351 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:51:00.402757 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:51:00.405512 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
13:51:00.411170 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.411707 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:51:00.412342 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.413018 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
13:51:00.413534 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:51:00.414107 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:51:00.414523 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:51:00.414908 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:51:00.417538 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
13:51:00.422735 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.423403 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:51:00.423865 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.424415 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
13:51:00.425016 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:51:00.425603 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:51:00.426007 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:51:00.426401 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:51:00.429094 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
13:51:00.434413 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.434989 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:51:00.435441 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.435979 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
13:51:00.436486 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.base_date
13:51:00.437048 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.base_date"
13:51:00.437462 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.base_date
13:51:00.437858 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.base_date
13:51:00.439691 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.base_date"
13:51:00.445321 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.445976 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.base_date
13:51:00.446418 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.446953 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.base_date
13:51:00.447458 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
13:51:00.448387 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
13:51:00.448964 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
13:51:00.449503 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
13:51:00.451904 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
13:51:00.456972 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.457503 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
13:51:00.458082 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.458832 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
13:51:00.459362 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:51:00.460126 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:51:00.460494 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:51:00.460901 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_item_monthly_consistency
13:51:00.463098 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
13:51:00.468462 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.469195 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:51:00.469722 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.470403 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_item_monthly_consistency
13:51:00.470903 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
13:51:00.471665 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
13:51:00.472068 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
13:51:00.472485 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
13:51:00.475147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
13:51:00.480686 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.481310 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
13:51:00.481780 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.482544 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
13:51:00.483067 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_seasonality_by_category
13:51:00.483788 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:51:00.484219 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_seasonality_by_category
13:51:00.484653 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_seasonality_by_category
13:51:00.487098 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
13:51:00.492445 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.493008 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_seasonality_by_category
13:51:00.493513 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.494210 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_seasonality_by_category
13:51:00.494718 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
13:51:00.495629 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
13:51:00.496057 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
13:51:00.496467 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
13:51:00.498747 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
13:51:00.504344 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.504987 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
13:51:00.505473 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.506273 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
13:51:00.506740 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
13:51:00.507505 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
13:51:00.508018 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
13:51:00.508385 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
13:51:00.510468 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
13:51:00.515356 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.515870 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
13:51:00.516357 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.517059 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
13:51:00.517610 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:51:00.518511 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:51:00.518957 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:51:00.519385 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:51:00.522145 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
13:51:00.527113 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.527628 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:51:00.528182 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.528889 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
13:51:00.529466 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:51:00.530079 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:51:00.530524 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:51:00.530869 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:51:00.533554 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
13:51:00.538374 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.538917 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:51:00.539411 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.540270 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
13:51:00.540835 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:51:00.541387 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:51:00.541756 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:51:00.542153 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:51:00.544740 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
13:51:00.549930 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.550513 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:51:00.551024 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.551666 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
13:51:00.552086 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:51:00.552751 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:51:00.553162 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:51:00.553581 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:51:00.556463 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
13:51:00.563468 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.564159 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:51:00.564691 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.565647 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
13:51:00.566211 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:51:00.566722 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:51:00.567160 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:51:00.567489 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:51:00.570265 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
13:51:00.574939 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.575488 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:51:00.575928 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.576536 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
13:51:00.577088 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:51:00.577596 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:51:00.578007 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:51:00.578360 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:51:00.581095 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
13:51:00.586904 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.587522 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:51:00.587997 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.588635 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
13:51:00.589207 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
13:51:00.589808 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:51:00.590280 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
13:51:00.590658 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
13:51:00.593210 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
13:51:00.598317 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.598893 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
13:51:00.599489 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.600184 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
13:51:00.600779 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
13:51:00.601583 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
13:51:00.602042 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
13:51:00.602404 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
13:51:00.604955 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
13:51:00.609932 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.610473 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
13:51:00.610962 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.611561 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
13:51:00.612068 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
13:51:00.612884 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
13:51:00.613307 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
13:51:00.613727 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
13:51:00.617172 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
13:51:00.622638 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.623330 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
13:51:00.623876 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.624457 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
13:51:00.624975 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:51:00.625689 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:51:00.626100 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:51:00.626531 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:51:00.629208 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
13:51:00.634101 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.634686 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:51:00.635102 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.635708 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
13:51:00.636229 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:51:00.636872 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:51:00.637305 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:51:00.637697 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:51:00.640274 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
13:51:00.645044 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.645713 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:51:00.646157 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.646742 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
13:51:00.647219 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:51:00.647718 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:51:00.648268 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:51:00.649043 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:51:00.652354 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
13:51:00.659402 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.660089 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:51:00.660696 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.661431 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
13:51:00.661989 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:51:00.662675 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:51:00.663137 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:51:00.663579 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:51:00.666704 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
13:51:00.672719 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.673331 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:51:00.673898 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.674556 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
13:51:00.675104 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:51:00.675696 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:51:00.676237 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:51:00.676727 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:51:00.679509 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
13:51:00.687025 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.687703 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:51:00.688254 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.688924 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
13:51:00.689505 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:51:00.690174 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:51:00.690657 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:51:00.691163 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:51:00.693778 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
13:51:00.701085 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.701712 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:51:00.702244 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.702956 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
13:51:00.703446 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:51:00.704014 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:51:00.704481 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:51:00.704906 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:51:00.707419 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
13:51:00.714037 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.714638 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:51:00.715145 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.715771 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
13:51:00.716261 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:51:00.716856 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:51:00.717378 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:51:00.717823 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:51:00.720521 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
13:51:00.727223 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.727832 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:51:00.728377 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.729057 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
13:51:00.729570 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:51:00.730167 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:51:00.730618 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:51:00.731027 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:51:00.733646 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
13:51:00.740161 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.740896 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:51:00.741431 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.742079 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
13:51:00.742549 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:51:00.743081 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:51:00.743503 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:51:00.743922 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:51:00.746552 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
13:51:00.753255 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.753840 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:51:00.754339 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.754956 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
13:51:00.755784 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:51:00.756482 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:51:00.756993 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:51:00.757422 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:51:00.760213 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
13:51:00.766675 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.767221 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:51:00.767718 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.768402 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
13:51:00.769025 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:51:00.769662 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:51:00.770336 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:51:00.770904 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:51:00.774669 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
13:51:00.780729 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.781348 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:51:00.781834 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.782434 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
13:51:00.782891 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:51:00.783500 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:51:00.783979 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:51:00.784384 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:51:00.827647 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
13:51:00.836798 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.837506 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:51:00.838097 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.838766 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
13:51:00.839321 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:51:00.839978 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:51:00.840543 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:51:00.841064 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:51:00.843843 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
13:51:00.851517 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.852223 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:51:00.852803 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.853510 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
13:51:00.854022 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:51:00.854699 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:51:00.855232 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:51:00.855679 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:51:00.858509 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
13:51:00.865459 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.866121 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:51:00.866667 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.867347 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
13:51:00.867929 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:51:00.868576 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:51:00.869181 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:51:00.869615 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:51:00.872304 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
13:51:00.878774 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.879584 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:51:00.880151 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.880863 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
13:51:00.881453 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:51:00.882154 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:51:00.882595 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:51:00.883057 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:51:00.885935 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
13:51:00.892785 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.893526 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:51:00.894061 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.894705 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
13:51:00.895312 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:51:00.895976 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:51:00.896470 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:51:00.896959 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:51:00.899788 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
13:51:00.906439 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.907077 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:51:00.907641 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.908366 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
13:51:00.908994 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:51:00.909706 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:51:00.910187 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:51:00.910683 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:51:00.913733 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
13:51:00.920556 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.921300 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:51:00.921856 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.922523 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
13:51:00.923103 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:51:00.923734 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:51:00.924089 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:51:00.924500 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:51:00.927273 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
13:51:00.932563 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.933287 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:51:00.933728 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.934314 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
13:51:00.934725 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:51:00.935233 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:51:00.935560 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:51:00.935996 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:51:00.938588 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
13:51:00.945805 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.946537 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:51:00.947111 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.947784 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
13:51:00.948394 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:51:00.949254 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:51:00.949848 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:51:00.950405 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:51:00.953342 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
13:51:00.959897 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.960507 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:51:00.961215 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.962004 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
13:51:00.962600 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:51:00.963587 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:51:00.964104 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:51:00.964657 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:51:00.967327 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
13:51:00.974063 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.974700 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:51:00.975222 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.975929 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
13:51:00.976477 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:51:00.977127 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:51:00.977574 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:51:00.978103 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:51:00.981488 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
13:51:00.988156 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.988869 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:51:00.989375 [debug] [Thread-1  ]: finished collecting timing info
13:51:00.990151 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
13:51:00.990701 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:51:00.991447 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:51:00.991926 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:51:00.992375 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:51:00.996183 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
13:51:01.003416 [debug] [Thread-1  ]: finished collecting timing info
13:51:01.004094 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:51:01.004878 [debug] [Thread-1  ]: finished collecting timing info
13:51:01.005605 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
13:51:01.006185 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:51:01.006834 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:51:01.007289 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:51:01.007747 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:51:01.010603 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
13:51:01.016433 [debug] [Thread-1  ]: finished collecting timing info
13:51:01.017100 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:51:01.017602 [debug] [Thread-1  ]: finished collecting timing info
13:51:01.018345 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
13:51:01.018891 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:51:01.019752 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:51:01.020350 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:51:01.020900 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:51:01.023685 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
13:51:01.030410 [debug] [Thread-1  ]: finished collecting timing info
13:51:01.031049 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:51:01.031540 [debug] [Thread-1  ]: finished collecting timing info
13:51:01.032177 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
13:51:01.033497 [debug] [MainThread]: Connection 'master' was properly closed.
13:51:01.033967 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001' was properly closed.
13:51:01.049115 [info ] [MainThread]: Done.
13:51:01.068419 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
13:51:01.069121 [info ] [MainThread]: Building catalog
13:51:01.071925 [debug] [ThreadPool]: Acquiring new snowflake connection "SALES_PIPELINE.information_schema"
13:51:01.077592 [debug] [ThreadPool]: Using snowflake connection "SALES_PIPELINE.information_schema"
13:51:01.078515 [debug] [ThreadPool]: On SALES_PIPELINE.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "SALES_PIPELINE.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from SALES_PIPELINE.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from SALES_PIPELINE.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw_staging') or upper("table_schema") = upper('raw') or upper("table_schema") = upper('raw_marts'))
      order by "column_index"
13:51:01.079046 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:51:03.421953 [debug] [ThreadPool]: SQL status: SUCCESS 81 in 2.34 seconds
13:51:03.434939 [debug] [ThreadPool]: On SALES_PIPELINE.information_schema: Close
13:51:03.522121 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
13:51:03.523141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ecc7eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58eace6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58eba08880>]}
13:51:03.971962 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
13:51:03.972988 [debug] [MainThread]: Connection 'SALES_PIPELINE.information_schema' was properly closed.


============================== 2025-08-05 13:53:36.009691 | b3090f15-d6bf-42da-bab1-42cc0e8cd844 ==============================
13:53:36.009691 [info ] [MainThread]: Running with dbt=1.0.0
13:53:36.010775 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8001, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
13:53:36.011545 [debug] [MainThread]: Tracking: tracking
13:53:36.012152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5dc48eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5dc48ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5dc48ea00>]}
13:53:36.028175 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
13:53:36.029003 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
13:53:36.029963 [info ] [MainThread]: 
13:53:36.030877 [info ] [MainThread]: 
13:53:36.031578 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 13:59:00.847736 | 79b655b0-c8db-455d-ad13-e1ec7d93722a ==============================
13:59:00.847736 [info ] [MainThread]: Running with dbt=1.0.0
13:59:00.848497 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, store_failures=False, indirect_selection='eager', threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
13:59:00.849114 [debug] [MainThread]: Tracking: tracking
13:59:00.849741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a398d255af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a398d255a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a398d255a30>]}
14:01:29.115617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:01:29.116342 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:01:29.117330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

14:01:29.122373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79b655b0-c8db-455d-ad13-e1ec7d93722a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a398c136f10>]}
14:01:29.141204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79b655b0-c8db-455d-ad13-e1ec7d93722a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a398d28f040>]}
14:01:29.141929 [info ] [MainThread]: Found 17 models, 42 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:01:29.145618 [info ] [MainThread]: 
14:01:29.146730 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:01:29.149039 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_staging"
14:01:29.158096 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_staging"
14:01:29.159232 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_staging"} */

    show terse objects in SALES_PIPELINE.RAW_staging
14:01:29.160315 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:01:32.352496 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.19 seconds
14:01:32.354817 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: Close
14:01:32.421645 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_marts"
14:01:32.423898 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_marts"
14:01:32.424459 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_marts"} */

    show terse objects in SALES_PIPELINE.RAW_marts
14:01:32.425005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:01:32.966806 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.54 seconds
14:01:32.968569 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: Close
14:01:33.038916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:01:33.039930 [info ] [MainThread]: 
14:01:33.054320 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:01:33.055313 [info ] [Thread-1  ]: 1 of 42 START test not_null_mart_daily_sales_date............................... [RUN]
14:01:33.056101 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
14:01:33.056813 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:01:33.057218 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:01:33.064370 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
14:01:33.070217 [debug] [Thread-1  ]: finished collecting timing info
14:01:33.070774 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:01:33.080477 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
14:01:33.087987 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
14:01:33.088583 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_daily_sales
where date is null



      
    ) dbt_internal_test
14:01:33.089245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:33.627998 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.54 seconds
14:01:33.638606 [debug] [Thread-1  ]: finished collecting timing info
14:01:33.639282 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861: Close
14:01:33.707283 [info ] [Thread-1  ]: 1 of 42 PASS not_null_mart_daily_sales_date..................................... [[32mPASS[0m in 0.65s]
14:01:33.708169 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:01:33.709173 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:01:33.709906 [info ] [Thread-1  ]: 2 of 42 START test not_null_mart_daily_sales_item_id............................ [RUN]
14:01:33.710799 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
14:01:33.711550 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:01:33.712064 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:01:33.714876 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
14:01:33.720792 [debug] [Thread-1  ]: finished collecting timing info
14:01:33.721344 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:01:33.722709 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
14:01:33.728654 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
14:01:33.729231 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_daily_sales
where item_id is null



      
    ) dbt_internal_test
14:01:33.729913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:34.418886 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
14:01:34.420682 [debug] [Thread-1  ]: finished collecting timing info
14:01:34.421263 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f: Close
14:01:34.489344 [info ] [Thread-1  ]: 2 of 42 PASS not_null_mart_daily_sales_item_id.................................. [[32mPASS[0m in 0.78s]
14:01:34.490443 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:01:34.491052 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:01:34.491601 [info ] [Thread-1  ]: 3 of 42 START test not_null_mart_daily_sales_shop_id............................ [RUN]
14:01:34.492376 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
14:01:34.493012 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:01:34.493580 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:01:34.496280 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
14:01:34.502162 [debug] [Thread-1  ]: finished collecting timing info
14:01:34.502841 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:01:34.504546 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
14:01:34.511683 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
14:01:34.512266 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_daily_sales
where shop_id is null



      
    ) dbt_internal_test
14:01:34.512688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:35.068232 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:01:35.070507 [debug] [Thread-1  ]: finished collecting timing info
14:01:35.071170 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50: Close
14:01:35.139560 [info ] [Thread-1  ]: 3 of 42 PASS not_null_mart_daily_sales_shop_id.................................. [[32mPASS[0m in 0.65s]
14:01:35.140550 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:01:35.141243 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:01:35.141785 [info ] [Thread-1  ]: 4 of 42 START test not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM........ [RUN]
14:01:35.142528 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
14:01:35.143125 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:01:35.143575 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:01:35.146222 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
14:01:35.152460 [debug] [Thread-1  ]: finished collecting timing info
14:01:35.153105 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:01:35.154976 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
14:01:35.162591 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
14:01:35.163095 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_item_monthly_consistency
where DATE_BLOCK_NUM is null



      
    ) dbt_internal_test
14:01:35.163575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:35.696459 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
14:01:35.698139 [debug] [Thread-1  ]: finished collecting timing info
14:01:35.698843 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b: Close
14:01:35.770533 [info ] [Thread-1  ]: 4 of 42 PASS not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.............. [[32mPASS[0m in 0.63s]
14:01:35.771278 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:01:35.771953 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:01:35.772493 [info ] [Thread-1  ]: 5 of 42 START test not_null_mart_item_monthly_consistency_ITEM_ID............... [RUN]
14:01:35.773442 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
14:01:35.773864 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:01:35.774279 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:01:35.777035 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
14:01:35.782574 [debug] [Thread-1  ]: finished collecting timing info
14:01:35.783151 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:01:35.785190 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
14:01:35.791996 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
14:01:35.792876 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_item_monthly_consistency
where ITEM_ID is null



      
    ) dbt_internal_test
14:01:35.793368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:36.360243 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
14:01:36.362081 [debug] [Thread-1  ]: finished collecting timing info
14:01:36.362665 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b: Close
14:01:36.431443 [info ] [Thread-1  ]: 5 of 42 PASS not_null_mart_item_monthly_consistency_ITEM_ID..................... [[32mPASS[0m in 0.66s]
14:01:36.432236 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:01:36.433005 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:01:36.433498 [info ] [Thread-1  ]: 6 of 42 START test not_null_mart_item_monthly_consistency_MONTHLY_REVENUE....... [RUN]
14:01:36.434129 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
14:01:36.434599 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:01:36.435037 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:01:36.437708 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
14:01:36.443427 [debug] [Thread-1  ]: finished collecting timing info
14:01:36.444024 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:01:36.445897 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
14:01:36.453822 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
14:01:36.454348 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_item_monthly_consistency
where MONTHLY_REVENUE is null



      
    ) dbt_internal_test
14:01:36.454821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:36.988738 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.53 seconds
14:01:36.990627 [debug] [Thread-1  ]: finished collecting timing info
14:01:36.991235 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5: Close
14:01:37.064153 [info ] [Thread-1  ]: 6 of 42 PASS not_null_mart_item_monthly_consistency_MONTHLY_REVENUE............. [[32mPASS[0m in 0.63s]
14:01:37.065026 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:01:37.065658 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:01:37.066080 [info ] [Thread-1  ]: 7 of 42 START test not_null_mart_monthly_sales_date_block_num................... [RUN]
14:01:37.066694 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:01:37.067184 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:01:37.067570 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:01:37.070514 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:01:37.075960 [debug] [Thread-1  ]: finished collecting timing info
14:01:37.076446 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:01:37.078221 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:01:37.085314 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:01:37.085823 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_monthly_sales
where date_block_num is null



      
    ) dbt_internal_test
14:01:37.086298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:37.637239 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:01:37.638984 [debug] [Thread-1  ]: finished collecting timing info
14:01:37.639682 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562: Close
14:01:37.705399 [info ] [Thread-1  ]: 7 of 42 PASS not_null_mart_monthly_sales_date_block_num......................... [[32mPASS[0m in 0.64s]
14:01:37.706240 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:01:37.706827 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:01:37.707335 [info ] [Thread-1  ]: 8 of 42 START test not_null_mart_monthly_sales_item_id.......................... [RUN]
14:01:37.707978 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:01:37.708559 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:01:37.709006 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:01:37.711784 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:01:37.718991 [debug] [Thread-1  ]: finished collecting timing info
14:01:37.719837 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:01:37.721546 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:01:37.727239 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:01:37.727702 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_monthly_sales
where item_id is null



      
    ) dbt_internal_test
14:01:37.728125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:38.287112 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:01:38.288818 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.289323 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8: Close
14:01:38.355136 [info ] [Thread-1  ]: 8 of 42 PASS not_null_mart_monthly_sales_item_id................................ [[32mPASS[0m in 0.65s]
14:01:38.355968 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:01:38.356710 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:01:38.357258 [info ] [Thread-1  ]: 9 of 42 START test not_null_mart_monthly_sales_shop_id.......................... [RUN]
14:01:38.358011 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:01:38.358620 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:01:38.359025 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:01:38.361951 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:01:38.367044 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.367949 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:01:38.369915 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:01:38.375377 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:01:38.375922 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_monthly_sales
where shop_id is null



      
    ) dbt_internal_test
14:01:38.376337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:38.916279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.54 seconds
14:01:38.918262 [debug] [Thread-1  ]: finished collecting timing info
14:01:38.918891 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a: Close
14:01:38.986825 [info ] [Thread-1  ]: 9 of 42 PASS not_null_mart_monthly_sales_shop_id................................ [[32mPASS[0m in 0.63s]
14:01:38.987817 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:01:38.988487 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:01:38.989042 [info ] [Thread-1  ]: 10 of 42 START test not_null_mart_revenue_by_month_date_block_num............... [RUN]
14:01:38.989911 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
14:01:38.990428 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:01:38.990925 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:01:38.993603 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
14:01:38.999494 [debug] [Thread-1  ]: finished collecting timing info
14:01:39.000330 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:01:39.002071 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
14:01:39.007811 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
14:01:39.008388 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_revenue_by_month
where date_block_num is null



      
    ) dbt_internal_test
14:01:39.008971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:39.604288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
14:01:39.605987 [debug] [Thread-1  ]: finished collecting timing info
14:01:39.606487 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f: Close
14:01:39.676808 [info ] [Thread-1  ]: 10 of 42 PASS not_null_mart_revenue_by_month_date_block_num..................... [[32mPASS[0m in 0.69s]
14:01:39.677663 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:01:39.678234 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:01:39.678907 [info ] [Thread-1  ]: 11 of 42 START test not_null_mart_revenue_by_month_monthly_revenue.............. [RUN]
14:01:39.679765 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
14:01:39.680374 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:01:39.681208 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:01:39.684065 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
14:01:39.689997 [debug] [Thread-1  ]: finished collecting timing info
14:01:39.690749 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:01:39.724030 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
14:01:39.731755 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
14:01:39.732289 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_revenue_by_month
where monthly_revenue is null



      
    ) dbt_internal_test
14:01:39.732733 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:40.278876 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:01:40.280750 [debug] [Thread-1  ]: finished collecting timing info
14:01:40.281292 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b: Close
14:01:40.351826 [info ] [Thread-1  ]: 11 of 42 PASS not_null_mart_revenue_by_month_monthly_revenue.................... [[32mPASS[0m in 0.67s]
14:01:40.352712 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:01:40.353399 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:01:40.353981 [info ] [Thread-1  ]: 12 of 42 START test not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID...... [RUN]
14:01:40.354773 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
14:01:40.355343 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:01:40.355858 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:01:40.358435 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
14:01:40.363566 [debug] [Thread-1  ]: finished collecting timing info
14:01:40.364288 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:01:40.365695 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
14:01:40.371421 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
14:01:40.372342 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_seasonality_by_category
where ITEM_CATEGORY_ID is null



      
    ) dbt_internal_test
14:01:40.373063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:40.979963 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
14:01:40.981698 [debug] [Thread-1  ]: finished collecting timing info
14:01:40.982256 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028: Close
14:01:41.050238 [info ] [Thread-1  ]: 12 of 42 PASS not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID............ [[32mPASS[0m in 0.70s]
14:01:41.051209 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:01:41.051862 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:01:41.052378 [info ] [Thread-1  ]: 13 of 42 START test not_null_mart_seasonality_by_category_MONTH_LABEL........... [RUN]
14:01:41.053092 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
14:01:41.053553 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:01:41.054046 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:01:41.056705 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
14:01:41.062646 [debug] [Thread-1  ]: finished collecting timing info
14:01:41.063324 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:01:41.065346 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
14:01:41.071304 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
14:01:41.071877 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_seasonality_by_category
where MONTH_LABEL is null



      
    ) dbt_internal_test
14:01:41.072284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:41.626985 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:01:41.628909 [debug] [Thread-1  ]: finished collecting timing info
14:01:41.629477 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d: Close
14:01:41.697732 [info ] [Thread-1  ]: 13 of 42 PASS not_null_mart_seasonality_by_category_MONTH_LABEL................. [[32mPASS[0m in 0.64s]
14:01:41.698732 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:01:41.699460 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:01:41.700134 [info ] [Thread-1  ]: 14 of 42 START test not_null_mart_seasonality_by_category_SEASONALITY_SCORE..... [RUN]
14:01:41.700809 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
14:01:41.701272 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:01:41.701658 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:01:41.704043 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
14:01:41.709000 [debug] [Thread-1  ]: finished collecting timing info
14:01:41.709536 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:01:41.711185 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
14:01:41.718506 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
14:01:41.719109 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_seasonality_by_category
where SEASONALITY_SCORE is null



      
    ) dbt_internal_test
14:01:41.719741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:42.263290 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.54 seconds
14:01:42.265142 [debug] [Thread-1  ]: finished collecting timing info
14:01:42.265696 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3: Close
14:01:42.335507 [info ] [Thread-1  ]: 14 of 42 PASS not_null_mart_seasonality_by_category_SEASONALITY_SCORE........... [[32mPASS[0m in 0.63s]
14:01:42.336385 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:01:42.337054 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:01:42.337599 [info ] [Thread-1  ]: 15 of 42 START test not_null_mart_shop_category_matrix_item_category_id......... [RUN]
14:01:42.338220 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
14:01:42.338742 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:01:42.339112 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:01:42.341582 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
14:01:42.346691 [debug] [Thread-1  ]: finished collecting timing info
14:01:42.347307 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:01:42.348976 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
14:01:42.357393 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
14:01:42.358012 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_category_matrix
where item_category_id is null



      
    ) dbt_internal_test
14:01:42.358521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:42.921640 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:01:42.923359 [debug] [Thread-1  ]: finished collecting timing info
14:01:42.923944 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39: Close
14:01:42.990558 [info ] [Thread-1  ]: 15 of 42 PASS not_null_mart_shop_category_matrix_item_category_id............... [[32mPASS[0m in 0.65s]
14:01:42.991402 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:01:42.992018 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:01:42.992420 [info ] [Thread-1  ]: 16 of 42 START test not_null_mart_shop_category_matrix_shop_id.................. [RUN]
14:01:42.992999 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
14:01:42.993516 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:01:42.993929 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:01:42.996614 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
14:01:43.002697 [debug] [Thread-1  ]: finished collecting timing info
14:01:43.003427 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:01:43.005117 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
14:01:43.012529 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
14:01:43.013354 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_category_matrix
where shop_id is null



      
    ) dbt_internal_test
14:01:43.013983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:43.551422 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.54 seconds
14:01:43.553089 [debug] [Thread-1  ]: finished collecting timing info
14:01:43.553598 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575: Close
14:01:43.619391 [info ] [Thread-1  ]: 16 of 42 PASS not_null_mart_shop_category_matrix_shop_id........................ [[32mPASS[0m in 0.63s]
14:01:43.620486 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:01:43.621411 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:01:43.621921 [info ] [Thread-1  ]: 17 of 42 START test not_null_mart_shop_profile_AVG_ITEM_PRICE................... [RUN]
14:01:43.622567 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
14:01:43.623149 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:01:43.623597 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:01:43.626512 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
14:01:43.633355 [debug] [Thread-1  ]: finished collecting timing info
14:01:43.633988 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:01:43.635707 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
14:01:43.643482 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
14:01:43.644195 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where AVG_ITEM_PRICE is null



      
    ) dbt_internal_test
14:01:43.644631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:44.337895 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.69 seconds
14:01:44.339768 [debug] [Thread-1  ]: finished collecting timing info
14:01:44.340336 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798: Close
14:01:44.403853 [info ] [Thread-1  ]: 17 of 42 PASS not_null_mart_shop_profile_AVG_ITEM_PRICE......................... [[32mPASS[0m in 0.78s]
14:01:44.404793 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:01:44.405435 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:01:44.405993 [info ] [Thread-1  ]: 18 of 42 START test not_null_mart_shop_profile_CATEGORY_COUNT................... [RUN]
14:01:44.406608 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
14:01:44.407146 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:01:44.408064 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:01:44.411160 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
14:01:44.417241 [debug] [Thread-1  ]: finished collecting timing info
14:01:44.417967 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:01:44.420225 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
14:01:44.426630 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
14:01:44.427255 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where CATEGORY_COUNT is null



      
    ) dbt_internal_test
14:01:44.427722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:44.986048 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:01:44.987876 [debug] [Thread-1  ]: finished collecting timing info
14:01:44.988585 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4: Close
14:01:45.054148 [info ] [Thread-1  ]: 18 of 42 PASS not_null_mart_shop_profile_CATEGORY_COUNT......................... [[32mPASS[0m in 0.65s]
14:01:45.055039 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:01:45.055651 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:01:45.056129 [info ] [Thread-1  ]: 19 of 42 START test not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE......... [RUN]
14:01:45.056886 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
14:01:45.057446 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:01:45.057825 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:01:45.060425 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
14:01:45.065634 [debug] [Thread-1  ]: finished collecting timing info
14:01:45.066295 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:01:45.067819 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
14:01:45.075135 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
14:01:45.075587 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where MONTHLY_REVENUE_VARIANCE is null



      
    ) dbt_internal_test
14:01:45.075891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:45.852307 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.78 seconds
14:01:45.854359 [debug] [Thread-1  ]: finished collecting timing info
14:01:45.854939 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607: Close
14:01:45.925955 [info ] [Thread-1  ]: 19 of 42 PASS not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE............... [[32mPASS[0m in 0.87s]
14:01:45.926858 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:01:45.927583 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:01:45.928185 [info ] [Thread-1  ]: 20 of 42 START test not_null_mart_shop_profile_REVENUE_PER_ITEM................. [RUN]
14:01:45.929163 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
14:01:45.929840 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:01:45.930307 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:01:45.933220 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
14:01:45.938653 [debug] [Thread-1  ]: finished collecting timing info
14:01:45.939385 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:01:45.941403 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
14:01:45.948000 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
14:01:45.948673 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where REVENUE_PER_ITEM is null



      
    ) dbt_internal_test
14:01:45.949141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:46.498570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:01:46.500311 [debug] [Thread-1  ]: finished collecting timing info
14:01:46.501079 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b: Close
14:01:46.572531 [info ] [Thread-1  ]: 20 of 42 PASS not_null_mart_shop_profile_REVENUE_PER_ITEM....................... [[32mPASS[0m in 0.64s]
14:01:46.573327 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:01:46.574033 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:01:46.574513 [info ] [Thread-1  ]: 21 of 42 START test not_null_mart_shop_profile_SHOP_ID.......................... [RUN]
14:01:46.575249 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
14:01:46.575779 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:01:46.576288 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:01:46.579199 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
14:01:46.585236 [debug] [Thread-1  ]: finished collecting timing info
14:01:46.585955 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:01:46.587782 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
14:01:46.595565 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
14:01:46.596206 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where SHOP_ID is null



      
    ) dbt_internal_test
14:01:46.596702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:47.178068 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
14:01:47.180079 [debug] [Thread-1  ]: finished collecting timing info
14:01:47.180702 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6: Close
14:01:47.262043 [info ] [Thread-1  ]: 21 of 42 PASS not_null_mart_shop_profile_SHOP_ID................................ [[32mPASS[0m in 0.69s]
14:01:47.263098 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:01:47.263905 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:01:47.264471 [info ] [Thread-1  ]: 22 of 42 START test not_null_mart_shop_profile_SHOP_NAME........................ [RUN]
14:01:47.265321 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
14:01:47.265881 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:01:47.266265 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:01:47.268900 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
14:01:47.274932 [debug] [Thread-1  ]: finished collecting timing info
14:01:47.275475 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:01:47.277323 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
14:01:47.282425 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
14:01:47.282958 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_shop_profile
where SHOP_NAME is null



      
    ) dbt_internal_test
14:01:47.283461 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:47.839400 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:01:47.841212 [debug] [Thread-1  ]: finished collecting timing info
14:01:47.841723 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f: Close
14:01:47.913377 [info ] [Thread-1  ]: 22 of 42 PASS not_null_mart_shop_profile_SHOP_NAME.............................. [[32mPASS[0m in 0.65s]
14:01:47.915033 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:01:47.916252 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:01:47.917350 [info ] [Thread-1  ]: 23 of 42 START test not_null_mart_top_item_categories_item_category_id.......... [RUN]
14:01:47.918859 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
14:01:47.919824 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:01:47.920750 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:01:47.925265 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
14:01:47.932768 [debug] [Thread-1  ]: finished collecting timing info
14:01:47.933618 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:01:47.935841 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
14:01:47.943319 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
14:01:47.944527 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_item_categories
where item_category_id is null



      
    ) dbt_internal_test
14:01:47.945649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:48.513530 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
14:01:48.515174 [debug] [Thread-1  ]: finished collecting timing info
14:01:48.515668 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb: Close
14:01:48.590291 [info ] [Thread-1  ]: 23 of 42 PASS not_null_mart_top_item_categories_item_category_id................ [[32mPASS[0m in 0.67s]
14:01:48.591194 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:01:48.591858 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:01:48.592262 [info ] [Thread-1  ]: 24 of 42 START test not_null_mart_top_item_categories_total_revenue............. [RUN]
14:01:48.593081 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
14:01:48.593754 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:01:48.594260 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:01:48.597434 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
14:01:48.603048 [debug] [Thread-1  ]: finished collecting timing info
14:01:48.603655 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:01:48.605488 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
14:01:48.610804 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
14:01:48.611330 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_item_categories
where total_revenue is null



      
    ) dbt_internal_test
14:01:48.611784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:49.161428 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:01:49.163159 [debug] [Thread-1  ]: finished collecting timing info
14:01:49.163637 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765: Close
14:01:49.234353 [info ] [Thread-1  ]: 24 of 42 PASS not_null_mart_top_item_categories_total_revenue................... [[32mPASS[0m in 0.64s]
14:01:49.235222 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:01:49.235877 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:01:49.236374 [info ] [Thread-1  ]: 25 of 42 START test not_null_mart_top_shops_shop_id............................. [RUN]
14:01:49.237071 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
14:01:49.237629 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:01:49.238092 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:01:49.241321 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
14:01:49.247759 [debug] [Thread-1  ]: finished collecting timing info
14:01:49.248305 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:01:49.250380 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
14:01:49.256786 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
14:01:49.257611 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_shops
where shop_id is null



      
    ) dbt_internal_test
14:01:49.258097 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:49.815020 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:01:49.817290 [debug] [Thread-1  ]: finished collecting timing info
14:01:49.817889 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83: Close
14:01:49.890853 [info ] [Thread-1  ]: 25 of 42 PASS not_null_mart_top_shops_shop_id................................... [[32mPASS[0m in 0.65s]
14:01:49.891809 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:01:49.892484 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:01:49.893081 [info ] [Thread-1  ]: 26 of 42 START test not_null_mart_top_shops_total_revenue....................... [RUN]
14:01:49.893972 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
14:01:49.894483 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:01:49.894906 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:01:49.897665 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
14:01:49.902885 [debug] [Thread-1  ]: finished collecting timing info
14:01:49.903447 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:01:49.905252 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
14:01:49.911072 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
14:01:49.911724 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_top_shops
where total_revenue is null



      
    ) dbt_internal_test
14:01:49.912114 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:50.465254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.55 seconds
14:01:50.466886 [debug] [Thread-1  ]: finished collecting timing info
14:01:50.467380 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001: Close
14:01:50.535363 [info ] [Thread-1  ]: 26 of 42 PASS not_null_mart_top_shops_total_revenue............................. [[32mPASS[0m in 0.64s]
14:01:50.536286 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:01:50.537396 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:01:50.537953 [info ] [Thread-1  ]: 27 of 42 START test not_null_mart_total_revenue_total_revenue................... [RUN]
14:01:50.538817 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
14:01:50.539521 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:01:50.540198 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:01:50.543691 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
14:01:50.550066 [debug] [Thread-1  ]: finished collecting timing info
14:01:50.550838 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:01:50.553009 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
14:01:50.558285 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
14:01:50.559130 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_marts.mart_total_revenue
where total_revenue is null



      
    ) dbt_internal_test
14:01:50.559962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:51.170616 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
14:01:51.172642 [debug] [Thread-1  ]: finished collecting timing info
14:01:51.173287 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6: Close
14:01:51.247621 [info ] [Thread-1  ]: 27 of 42 PASS not_null_mart_total_revenue_total_revenue......................... [[32mPASS[0m in 0.71s]
14:01:51.248581 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:01:51.249236 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:01:51.249752 [info ] [Thread-1  ]: 28 of 42 START test not_null_stg_item_categories_item_category_id............... [RUN]
14:01:51.250532 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
14:01:51.251222 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:01:51.251659 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:01:51.254601 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
14:01:51.259845 [debug] [Thread-1  ]: finished collecting timing info
14:01:51.260669 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:01:51.262647 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
14:01:51.269443 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
14:01:51.270039 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_item_categories
where item_category_id is null



      
    ) dbt_internal_test
14:01:51.270901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:51.867969 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
14:01:51.870114 [debug] [Thread-1  ]: finished collecting timing info
14:01:51.870848 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6: Close
14:01:51.942867 [info ] [Thread-1  ]: 28 of 42 PASS not_null_stg_item_categories_item_category_id..................... [[32mPASS[0m in 0.69s]
14:01:51.943807 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:01:51.944390 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:01:51.944926 [info ] [Thread-1  ]: 29 of 42 START test not_null_stg_item_categories_item_category_name............. [RUN]
14:01:51.945588 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
14:01:51.946035 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:01:51.946471 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:01:51.949173 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
14:01:51.954882 [debug] [Thread-1  ]: finished collecting timing info
14:01:51.955576 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:01:51.957419 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
14:01:51.963731 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
14:01:51.964303 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_item_categories
where item_category_name is null



      
    ) dbt_internal_test
14:01:51.964772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:52.733048 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.77 seconds
14:01:52.734886 [debug] [Thread-1  ]: finished collecting timing info
14:01:52.735424 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8: Close
14:01:53.088362 [info ] [Thread-1  ]: 29 of 42 PASS not_null_stg_item_categories_item_category_name................... [[32mPASS[0m in 1.14s]
14:01:53.089310 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:01:53.090342 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:01:53.090846 [info ] [Thread-1  ]: 30 of 42 START test not_null_stg_items_item_id.................................. [RUN]
14:01:53.091520 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
14:01:53.092114 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:01:53.092615 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:01:53.095335 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
14:01:53.100854 [debug] [Thread-1  ]: finished collecting timing info
14:01:53.101601 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:01:53.103348 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
14:01:53.109002 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
14:01:53.109617 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_items
where item_id is null



      
    ) dbt_internal_test
14:01:53.110141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:53.703952 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
14:01:53.705699 [debug] [Thread-1  ]: finished collecting timing info
14:01:53.706200 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a: Close
14:01:53.906401 [info ] [Thread-1  ]: 30 of 42 PASS not_null_stg_items_item_id........................................ [[32mPASS[0m in 0.81s]
14:01:53.907274 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:01:53.907913 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:01:53.908527 [info ] [Thread-1  ]: 31 of 42 START test not_null_stg_items_item_name................................ [RUN]
14:01:53.909299 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
14:01:53.909834 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:01:53.910399 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:01:53.912992 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
14:01:53.917952 [debug] [Thread-1  ]: finished collecting timing info
14:01:53.918570 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:01:53.920381 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
14:01:53.926452 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
14:01:53.927050 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_items
where item_name is null



      
    ) dbt_internal_test
14:01:53.927609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:54.672441 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.74 seconds
14:01:54.674492 [debug] [Thread-1  ]: finished collecting timing info
14:01:54.675098 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85: Close
14:01:54.745681 [info ] [Thread-1  ]: 31 of 42 PASS not_null_stg_items_item_name...................................... [[32mPASS[0m in 0.84s]
14:01:54.746498 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:01:54.747160 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:01:54.747650 [info ] [Thread-1  ]: 32 of 42 START test not_null_stg_sales_train_date............................... [RUN]
14:01:54.748300 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
14:01:54.748947 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:01:54.749416 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:01:54.752464 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
14:01:54.757137 [debug] [Thread-1  ]: finished collecting timing info
14:01:54.757690 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:01:54.759308 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
14:01:54.764305 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
14:01:54.764915 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where date is null



      
    ) dbt_internal_test
14:01:54.765428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:55.895622 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.13 seconds
14:01:55.897487 [debug] [Thread-1  ]: finished collecting timing info
14:01:55.898002 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9: Close
14:01:55.967148 [info ] [Thread-1  ]: 32 of 42 PASS not_null_stg_sales_train_date..................................... [[32mPASS[0m in 1.22s]
14:01:55.968133 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:01:55.968860 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:01:55.969491 [info ] [Thread-1  ]: 33 of 42 START test not_null_stg_sales_train_date_block_num..................... [RUN]
14:01:55.970248 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
14:01:55.970719 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:01:55.971192 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:01:55.974110 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
14:01:55.979091 [debug] [Thread-1  ]: finished collecting timing info
14:01:55.979849 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:01:55.981912 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
14:01:55.987906 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
14:01:55.988443 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where date_block_num is null



      
    ) dbt_internal_test
14:01:55.989167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:56.575154 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.59 seconds
14:01:56.577067 [debug] [Thread-1  ]: finished collecting timing info
14:01:56.577586 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d: Close
14:01:56.650746 [info ] [Thread-1  ]: 33 of 42 PASS not_null_stg_sales_train_date_block_num........................... [[32mPASS[0m in 0.68s]
14:01:56.651599 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:01:56.652339 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:01:56.652991 [info ] [Thread-1  ]: 34 of 42 START test not_null_stg_sales_train_item_cnt_day....................... [RUN]
14:01:56.653963 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
14:01:56.654462 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:01:56.654958 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:01:56.658038 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
14:01:56.663750 [debug] [Thread-1  ]: finished collecting timing info
14:01:56.664365 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:01:56.666142 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
14:01:56.671652 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
14:01:56.672221 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where item_cnt_day is null



      
    ) dbt_internal_test
14:01:56.672665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:58.058005 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.39 seconds
14:01:58.059909 [debug] [Thread-1  ]: finished collecting timing info
14:01:58.060577 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7: Close
14:01:58.145329 [info ] [Thread-1  ]: 34 of 42 PASS not_null_stg_sales_train_item_cnt_day............................. [[32mPASS[0m in 1.49s]
14:01:58.146195 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:01:58.146841 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:01:58.147384 [info ] [Thread-1  ]: 35 of 42 START test not_null_stg_sales_train_item_id............................ [RUN]
14:01:58.148125 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
14:01:58.148637 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:01:58.149081 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:01:58.151689 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
14:01:58.156901 [debug] [Thread-1  ]: finished collecting timing info
14:01:58.157460 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:01:58.159115 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
14:01:58.164308 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
14:01:58.164892 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where item_id is null



      
    ) dbt_internal_test
14:01:58.165326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:58.739622 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
14:01:58.741522 [debug] [Thread-1  ]: finished collecting timing info
14:01:58.742040 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8: Close
14:01:58.810943 [info ] [Thread-1  ]: 35 of 42 PASS not_null_stg_sales_train_item_id.................................. [[32mPASS[0m in 0.66s]
14:01:58.811739 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:01:58.812288 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:01:58.812894 [info ] [Thread-1  ]: 36 of 42 START test not_null_stg_sales_train_item_price......................... [RUN]
14:01:58.813492 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
14:01:58.814112 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:01:58.814547 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:01:58.817025 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
14:01:58.821971 [debug] [Thread-1  ]: finished collecting timing info
14:01:58.822491 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:01:58.824071 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
14:01:58.828850 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
14:01:58.829358 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where item_price is null



      
    ) dbt_internal_test
14:01:58.829859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:01:59.433248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
14:01:59.434982 [debug] [Thread-1  ]: finished collecting timing info
14:01:59.435435 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da: Close
14:01:59.505934 [info ] [Thread-1  ]: 36 of 42 PASS not_null_stg_sales_train_item_price............................... [[32mPASS[0m in 0.69s]
14:01:59.506907 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:01:59.507459 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:01:59.507969 [info ] [Thread-1  ]: 37 of 42 START test not_null_stg_sales_train_shop_id............................ [RUN]
14:01:59.508703 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
14:01:59.509195 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:01:59.509621 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:01:59.512418 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
14:01:59.517333 [debug] [Thread-1  ]: finished collecting timing info
14:01:59.518009 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:01:59.520004 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
14:01:59.526608 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
14:01:59.527071 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_sales_train
where shop_id is null



      
    ) dbt_internal_test
14:01:59.527480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:00.165037 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.64 seconds
14:02:00.167112 [debug] [Thread-1  ]: finished collecting timing info
14:02:00.167695 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831: Close
14:02:00.233833 [info ] [Thread-1  ]: 37 of 42 PASS not_null_stg_sales_train_shop_id.................................. [[32mPASS[0m in 0.73s]
14:02:00.234858 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:02:00.235566 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:02:00.236081 [info ] [Thread-1  ]: 38 of 42 START test not_null_stg_shops_shop_id.................................. [RUN]
14:02:00.236984 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
14:02:00.237538 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:02:00.238097 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:02:00.241513 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
14:02:00.246107 [debug] [Thread-1  ]: finished collecting timing info
14:02:00.246633 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:02:00.248394 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
14:02:00.254117 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
14:02:00.254664 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_shops
where shop_id is null



      
    ) dbt_internal_test
14:02:00.255024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:00.822949 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.57 seconds
14:02:00.824741 [debug] [Thread-1  ]: finished collecting timing info
14:02:00.825322 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db: Close
14:02:00.898416 [info ] [Thread-1  ]: 38 of 42 PASS not_null_stg_shops_shop_id........................................ [[32mPASS[0m in 0.66s]
14:02:00.899295 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:02:00.900015 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:02:00.900692 [info ] [Thread-1  ]: 39 of 42 START test not_null_stg_shops_shop_name................................ [RUN]
14:02:00.901413 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
14:02:00.901967 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:02:00.902492 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:02:00.905119 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
14:02:00.910216 [debug] [Thread-1  ]: finished collecting timing info
14:02:00.910795 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:02:00.912814 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
14:02:00.917987 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
14:02:00.918516 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from SALES_PIPELINE.RAW_staging.stg_shops
where shop_name is null



      
    ) dbt_internal_test
14:02:00.918920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:01.500911 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
14:02:01.502738 [debug] [Thread-1  ]: finished collecting timing info
14:02:01.503529 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef: Close
14:02:01.571627 [info ] [Thread-1  ]: 39 of 42 PASS not_null_stg_shops_shop_name...................................... [[32mPASS[0m in 0.67s]
14:02:01.572540 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:02:01.573370 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:02:01.573940 [info ] [Thread-1  ]: 40 of 42 START test unique_stg_item_categories_item_category_id................. [RUN]
14:02:01.574861 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
14:02:01.575507 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:02:01.576158 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:02:01.581064 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
14:02:01.588255 [debug] [Thread-1  ]: finished collecting timing info
14:02:01.589212 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:02:01.590957 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
14:02:01.597171 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
14:02:01.598020 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_category_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.RAW_staging.stg_item_categories
where item_category_id is not null
group by item_category_id
having count(*) > 1



      
    ) dbt_internal_test
14:02:01.598613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:02.180477 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.58 seconds
14:02:02.182242 [debug] [Thread-1  ]: finished collecting timing info
14:02:02.182734 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96: Close
14:02:02.257927 [info ] [Thread-1  ]: 40 of 42 PASS unique_stg_item_categories_item_category_id....................... [[32mPASS[0m in 0.68s]
14:02:02.258864 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:02:02.259616 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:02:02.260081 [info ] [Thread-1  ]: 41 of 42 START test unique_stg_items_item_id.................................... [RUN]
14:02:02.260923 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
14:02:02.261475 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:02:02.261932 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:02:02.264773 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
14:02:02.270060 [debug] [Thread-1  ]: finished collecting timing info
14:02:02.270719 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:02:02.272702 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
14:02:02.277559 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
14:02:02.278150 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    item_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.RAW_staging.stg_items
where item_id is not null
group by item_id
having count(*) > 1



      
    ) dbt_internal_test
14:02:02.278692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:02.834667 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.56 seconds
14:02:02.836265 [debug] [Thread-1  ]: finished collecting timing info
14:02:02.836816 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757: Close
14:02:02.903707 [info ] [Thread-1  ]: 41 of 42 PASS unique_stg_items_item_id.......................................... [[32mPASS[0m in 0.64s]
14:02:02.905137 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:02:02.906077 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:02:02.906729 [info ] [Thread-1  ]: 42 of 42 START test unique_stg_shops_shop_id.................................... [RUN]
14:02:02.907613 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
14:02:02.908139 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:02:02.908647 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:02:02.911241 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
14:02:02.916764 [debug] [Thread-1  ]: finished collecting timing info
14:02:02.917506 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:02:02.919235 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
14:02:02.925932 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
14:02:02.926527 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "node_id": "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    shop_id as unique_field,
    count(*) as n_records

from SALES_PIPELINE.RAW_staging.stg_shops
where shop_id is not null
group by shop_id
having count(*) > 1



      
    ) dbt_internal_test
14:02:02.927009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:02:03.523823 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.6 seconds
14:02:03.525689 [debug] [Thread-1  ]: finished collecting timing info
14:02:03.526204 [debug] [Thread-1  ]: On test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3: Close
14:02:03.590350 [info ] [Thread-1  ]: 42 of 42 PASS unique_stg_shops_shop_id.......................................... [[32mPASS[0m in 0.68s]
14:02:03.591169 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:02:03.593443 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:02:03.594158 [info ] [MainThread]: 
14:02:03.594657 [info ] [MainThread]: Finished running 42 tests in 34.45s.
14:02:03.595298 [debug] [MainThread]: Connection 'master' was properly closed.
14:02:03.595858 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3' was properly closed.
14:02:03.610106 [info ] [MainThread]: 
14:02:03.611036 [info ] [MainThread]: [32mCompleted successfully[0m
14:02:03.611931 [info ] [MainThread]: 
14:02:03.612759 [info ] [MainThread]: Done. PASS=42 WARN=0 ERROR=0 SKIP=0 TOTAL=42
14:02:03.613720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a398539d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a398c10aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3986d30c70>]}


============================== 2025-08-05 14:02:19.206284 | e59c6e10-a664-4409-8c1b-1709e8848a4b ==============================
14:02:19.206284 [info ] [MainThread]: Running with dbt=1.0.0
14:02:19.207067 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, compile=True, threads=None, select=None, exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.generate.GenerateTask'>, which='generate', rpc_method='docs.generate')
14:02:19.207803 [debug] [MainThread]: Tracking: tracking
14:02:19.208399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce8081c0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce8081c0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce8081c0a30>]}
14:04:47.302930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:04:47.303696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:04:47.304621 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_sales_pipeline.staging.utils

14:04:47.310105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e59c6e10-a664-4409-8c1b-1709e8848a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce8080b4f40>]}
14:04:47.327606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e59c6e10-a664-4409-8c1b-1709e8848a4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce808187070>]}
14:04:47.328577 [info ] [MainThread]: Found 17 models, 42 tests, 0 snapshots, 0 analyses, 180 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:04:47.331543 [info ] [MainThread]: 
14:04:47.332878 [debug] [MainThread]: Acquiring new snowflake connection "master"
14:04:47.334618 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_marts"
14:04:47.343335 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_marts"
14:04:47.344291 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_marts"} */

    show terse objects in SALES_PIPELINE.RAW_marts
14:04:47.344996 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:04:48.346904 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.0 seconds
14:04:48.349260 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_marts: Close
14:04:48.419232 [debug] [ThreadPool]: Acquiring new snowflake connection "list_SALES_PIPELINE_RAW_staging"
14:04:48.421672 [debug] [ThreadPool]: Using snowflake connection "list_SALES_PIPELINE_RAW_staging"
14:04:48.422363 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "list_SALES_PIPELINE_RAW_staging"} */

    show terse objects in SALES_PIPELINE.RAW_staging
14:04:48.422984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:04:48.948203 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.53 seconds
14:04:48.949985 [debug] [ThreadPool]: On list_SALES_PIPELINE_RAW_staging: Close
14:04:49.014715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:04:49.015598 [info ] [MainThread]: 
14:04:49.030381 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_monthly_sales
14:04:49.031240 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_monthly_sales"
14:04:49.031710 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_monthly_sales
14:04:49.032215 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_monthly_sales
14:04:49.033495 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_monthly_sales"
14:04:49.037967 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.038519 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_monthly_sales
14:04:49.038984 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.039640 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_monthly_sales
14:04:49.040054 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_store
14:04:49.040882 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_store"
14:04:49.041397 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_store
14:04:49.041834 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_store
14:04:49.042969 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_store"
14:04:49.047851 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.048358 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_store
14:04:49.048827 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.049419 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_store
14:04:49.049869 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_products
14:04:49.050445 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_products"
14:04:49.050857 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_products
14:04:49.051239 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_products
14:04:49.052947 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_products"
14:04:49.057570 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.058145 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_products
14:04:49.058657 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.059240 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_products
14:04:49.059677 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_item_categories
14:04:49.060261 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_item_categories"
14:04:49.060682 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_item_categories
14:04:49.061094 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_item_categories
14:04:49.063331 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_item_categories"
14:04:49.067854 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.068379 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_item_categories
14:04:49.068906 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.069468 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_item_categories
14:04:49.069946 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_items
14:04:49.070719 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_items"
14:04:49.071106 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_items
14:04:49.071633 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_items
14:04:49.073598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_items"
14:04:49.078601 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.079184 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_items
14:04:49.079657 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.080247 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_items
14:04:49.080691 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_sales_train
14:04:49.081379 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_sales_train"
14:04:49.081862 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_sales_train
14:04:49.082259 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_sales_train
14:04:49.084261 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_sales_train"
14:04:49.088683 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.089287 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_sales_train
14:04:49.089817 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.090409 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_sales_train
14:04:49.090881 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.stg_shops
14:04:49.091766 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.stg_shops"
14:04:49.092142 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.stg_shops
14:04:49.092576 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.stg_shops
14:04:49.095246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.stg_shops"
14:04:49.099938 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.100542 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.stg_shops
14:04:49.101051 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.101682 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.stg_shops
14:04:49.102127 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:49.102881 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:04:49.103305 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:49.103694 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:49.110414 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562"
14:04:49.115631 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.116285 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:49.116841 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.117488 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_date_block_num.c05d4ef562
14:04:49.117929 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:49.118617 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:04:49.119038 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:49.119469 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:49.122157 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8"
14:04:49.127271 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.127751 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:49.128145 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.128703 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_item_id.4e105c8eb8
14:04:49.129128 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:49.129650 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:04:49.130006 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:49.130440 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:49.133224 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a"
14:04:49.138144 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.138686 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:49.139164 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.139766 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_monthly_sales_shop_id.b19f0e419a
14:04:49.140204 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:04:49.140922 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
14:04:49.141379 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:04:49.141828 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:04:49.144415 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6"
14:04:49.149309 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.149884 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:04:49.150381 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.151114 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_id.7a34a016c6
14:04:49.151642 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:04:49.152262 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
14:04:49.152743 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:04:49.153187 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:04:49.155728 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8"
14:04:49.160067 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.160629 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:04:49.161035 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.161738 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_item_categories_item_category_name.b180d231b8
14:04:49.162353 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:04:49.162985 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
14:04:49.163511 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:04:49.163907 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:04:49.168429 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96"
14:04:49.173721 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.174297 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:04:49.174761 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.175449 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_item_categories_item_category_id.93e4d17e96
14:04:49.175977 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:04:49.176661 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
14:04:49.177048 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:04:49.177457 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:04:49.180136 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a"
14:04:49.185663 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.186238 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:04:49.186742 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.187344 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_id.2983e86e1a
14:04:49.187917 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:04:49.188565 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
14:04:49.189057 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:04:49.189713 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:04:49.192832 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85"
14:04:49.197176 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.197849 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:04:49.198305 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.198883 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_items_item_name.d5044a8c85
14:04:49.199455 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:04:49.200068 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
14:04:49.200577 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:04:49.201017 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:04:49.203677 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757"
14:04:49.208505 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.209219 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:04:49.209833 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.210467 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_items_item_id.20a7a48757
14:04:49.210927 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.base_date
14:04:49.211514 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.base_date"
14:04:49.212025 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.base_date
14:04:49.212526 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.base_date
14:04:49.214459 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.base_date"
14:04:49.219230 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.219801 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.base_date
14:04:49.220309 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.220929 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.base_date
14:04:49.221519 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_daily_sales
14:04:49.222272 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_daily_sales"
14:04:49.222888 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_daily_sales
14:04:49.223520 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_daily_sales
14:04:49.225591 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_daily_sales"
14:04:49.230504 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.231086 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_daily_sales
14:04:49.231654 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.232278 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_daily_sales
14:04:49.232820 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_item_monthly_consistency
14:04:49.233739 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_item_monthly_consistency"
14:04:49.234096 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_item_monthly_consistency
14:04:49.234505 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_item_monthly_consistency
14:04:49.237012 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_item_monthly_consistency"
14:04:49.241579 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.242124 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_item_monthly_consistency
14:04:49.242640 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.243295 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_item_monthly_consistency
14:04:49.243806 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_revenue_by_month
14:04:49.244470 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_revenue_by_month"
14:04:49.244883 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_revenue_by_month
14:04:49.245274 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_revenue_by_month
14:04:49.248238 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_revenue_by_month"
14:04:49.253291 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.253964 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_revenue_by_month
14:04:49.254438 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.255306 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_revenue_by_month
14:04:49.255894 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_seasonality_by_category
14:04:49.256553 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_seasonality_by_category"
14:04:49.257007 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_seasonality_by_category
14:04:49.257397 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_seasonality_by_category
14:04:49.259897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_seasonality_by_category"
14:04:49.264983 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.265580 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_seasonality_by_category
14:04:49.266105 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.266905 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_seasonality_by_category
14:04:49.267452 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_item_categories
14:04:49.268071 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_item_categories"
14:04:49.268474 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_item_categories
14:04:49.268872 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_item_categories
14:04:49.271291 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_item_categories"
14:04:49.276345 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.276968 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_item_categories
14:04:49.277454 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.278041 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_item_categories
14:04:49.278634 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_total_revenue
14:04:49.279378 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_total_revenue"
14:04:49.279802 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_total_revenue
14:04:49.280224 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_total_revenue
14:04:49.282211 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_total_revenue"
14:04:49.287557 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.288287 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_total_revenue
14:04:49.288714 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.289435 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_total_revenue
14:04:49.289945 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:04:49.290703 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
14:04:49.291136 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:04:49.291642 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:04:49.294417 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9"
14:04:49.298888 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.299423 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:04:49.299899 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.300471 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date.8dbbe923c9
14:04:49.300949 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:04:49.301539 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
14:04:49.302320 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:04:49.302808 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:04:49.305540 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d"
14:04:49.309981 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.310496 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:04:49.311025 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.311629 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_date_block_num.434ae7f18d
14:04:49.312141 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:04:49.312860 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
14:04:49.313290 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:04:49.313714 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:04:49.316284 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7"
14:04:49.322692 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.323790 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:04:49.324818 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.325633 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_cnt_day.55e375a5c7
14:04:49.326264 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:04:49.327056 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
14:04:49.327614 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:04:49.328111 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:04:49.330743 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8"
14:04:49.336269 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.337420 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:04:49.338072 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.338630 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_id.85349643d8
14:04:49.339211 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:04:49.339829 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
14:04:49.340283 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:04:49.340804 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:04:49.343895 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da"
14:04:49.350345 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.350997 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:04:49.351587 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.352277 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_item_price.857f5a42da
14:04:49.352980 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:04:49.353925 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
14:04:49.354529 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:04:49.355004 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:04:49.357834 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831"
14:04:49.363715 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.364374 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:04:49.364914 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.365532 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_sales_train_shop_id.9a549f4831
14:04:49.366092 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_category_matrix
14:04:49.366742 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_category_matrix"
14:04:49.367226 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_category_matrix
14:04:49.367708 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_category_matrix
14:04:49.370425 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_category_matrix"
14:04:49.376207 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.376881 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_category_matrix
14:04:49.377570 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.378269 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_category_matrix
14:04:49.378915 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_shop_profile
14:04:49.379686 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_shop_profile"
14:04:49.380184 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_shop_profile
14:04:49.380655 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_shop_profile
14:04:49.383362 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_shop_profile"
14:04:49.389157 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.389765 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_shop_profile
14:04:49.390257 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.390948 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_shop_profile
14:04:49.391533 [debug] [Thread-1  ]: Began running node model.dbt_sales_pipeline.mart_top_shops
14:04:49.392449 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.dbt_sales_pipeline.mart_top_shops"
14:04:49.393121 [debug] [Thread-1  ]: Began compiling node model.dbt_sales_pipeline.mart_top_shops
14:04:49.393673 [debug] [Thread-1  ]: Compiling model.dbt_sales_pipeline.mart_top_shops
14:04:49.396970 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_sales_pipeline.mart_top_shops"
14:04:49.403051 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.403719 [debug] [Thread-1  ]: Began executing node model.dbt_sales_pipeline.mart_top_shops
14:04:49.404291 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.405070 [debug] [Thread-1  ]: Finished running node model.dbt_sales_pipeline.mart_top_shops
14:04:49.405629 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:04:49.406408 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
14:04:49.406897 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:04:49.407358 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:04:49.410170 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db"
14:04:49.416702 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.417321 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:04:49.417917 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.418546 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_id.57fba4b2db
14:04:49.419032 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:04:49.419808 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
14:04:49.420532 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:04:49.421067 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:04:49.423891 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef"
14:04:49.429730 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.430358 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:04:49.430906 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.431691 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_stg_shops_shop_name.9a24728aef
14:04:49.432288 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:04:49.432971 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
14:04:49.433496 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:04:49.433975 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:04:49.436923 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3"
14:04:49.441847 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.442566 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:04:49.443373 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.444110 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.unique_stg_shops_shop_id.76719fa9d3
14:04:49.444693 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:04:49.445338 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
14:04:49.445872 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:04:49.446353 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:04:49.449355 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861"
14:04:49.455167 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.455863 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:04:49.456396 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.457192 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_date.1ea3355861
14:04:49.457763 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:04:49.458436 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
14:04:49.458960 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:04:49.459500 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:04:49.462601 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f"
14:04:49.467691 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.468286 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:04:49.468917 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.469604 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_item_id.2d2aa8161f
14:04:49.470106 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:04:49.470711 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
14:04:49.471183 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:04:49.471642 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:04:49.474572 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50"
14:04:49.480724 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.481367 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:04:49.481971 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.482672 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_daily_sales_shop_id.ed61a04c50
14:04:49.483237 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:04:49.483885 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
14:04:49.484389 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:04:49.484863 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:04:49.488025 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b"
14:04:49.494403 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.495086 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:04:49.495599 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.496203 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_DATE_BLOCK_NUM.9fb8715a2b
14:04:49.496746 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:04:49.497387 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
14:04:49.497797 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:04:49.498267 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:04:49.501342 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b"
14:04:49.507573 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.508164 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:04:49.508754 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.509424 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_ITEM_ID.2e7626eb1b
14:04:49.509956 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:04:49.510621 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
14:04:49.511160 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:04:49.511692 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:04:49.514524 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5"
14:04:49.520171 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.520804 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:04:49.521299 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.522073 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_item_monthly_consistency_MONTHLY_REVENUE.4eee86dea5
14:04:49.522643 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:04:49.523499 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
14:04:49.524122 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:04:49.524696 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:04:49.527532 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f"
14:04:49.534061 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.534765 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:04:49.535277 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.535996 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_date_block_num.dc35a0bd5f
14:04:49.536658 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:04:49.537297 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
14:04:49.537803 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:04:49.538240 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:04:49.540966 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b"
14:04:49.546449 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.547172 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:04:49.547675 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.548348 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_revenue_by_month_monthly_revenue.7b84e90f1b
14:04:49.548907 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:04:49.549498 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
14:04:49.550356 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:04:49.550916 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:04:49.555282 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028"
14:04:49.562177 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.562884 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:04:49.563468 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.564154 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_ITEM_CATEGORY_ID.22ce74e028
14:04:49.564856 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:04:49.565552 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
14:04:49.566021 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:04:49.566673 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:04:49.604249 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d"
14:04:49.611582 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.612375 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:04:49.613007 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.613719 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_MONTH_LABEL.6313d2983d
14:04:49.614249 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:04:49.614876 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
14:04:49.615413 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:04:49.615865 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:04:49.618807 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3"
14:04:49.625706 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.626335 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:04:49.626893 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.627563 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_seasonality_by_category_SEASONALITY_SCORE.e8ab9ef0f3
14:04:49.628218 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:04:49.628849 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
14:04:49.629285 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:04:49.629715 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:04:49.632396 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb"
14:04:49.638454 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.639017 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:04:49.639659 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.640459 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_item_category_id.662c4872fb
14:04:49.640947 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:04:49.641502 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
14:04:49.641938 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:04:49.642352 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:04:49.645446 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765"
14:04:49.650402 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.650955 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:04:49.651440 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.652189 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_item_categories_total_revenue.2e4999a765
14:04:49.652746 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:04:49.653489 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
14:04:49.654031 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:04:49.654425 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:04:49.657082 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6"
14:04:49.662179 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.662842 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:04:49.663419 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.664117 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_total_revenue_total_revenue.207dd0bbe6
14:04:49.664579 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:04:49.665167 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
14:04:49.665542 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:04:49.665892 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:04:49.668423 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39"
14:04:49.673786 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.674457 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:04:49.674952 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.675509 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_item_category_id.d23ca9fa39
14:04:49.676052 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:04:49.676638 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
14:04:49.677059 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:04:49.677394 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:04:49.679932 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575"
14:04:49.685280 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.685893 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:04:49.686417 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.687062 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_category_matrix_shop_id.9e4e4a7575
14:04:49.687607 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:04:49.688143 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
14:04:49.688550 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:04:49.689336 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:04:49.692359 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798"
14:04:49.697493 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.698068 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:04:49.698474 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.699109 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_AVG_ITEM_PRICE.31d48e1798
14:04:49.699608 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:04:49.700127 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
14:04:49.700507 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:04:49.700862 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:04:49.703544 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4"
14:04:49.708487 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.709221 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:04:49.709629 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.710140 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_CATEGORY_COUNT.95636ac9d4
14:04:49.710633 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:04:49.711111 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
14:04:49.711583 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:04:49.712072 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:04:49.714980 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607"
14:04:49.720560 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.721155 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:04:49.721543 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.722166 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_MONTHLY_REVENUE_VARIANCE.4c34fb1607
14:04:49.722564 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:04:49.723272 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
14:04:49.723758 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:04:49.724212 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:04:49.726869 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b"
14:04:49.731897 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.732470 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:04:49.733029 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.733770 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_REVENUE_PER_ITEM.50dcd3500b
14:04:49.734290 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:04:49.734934 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
14:04:49.735335 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:04:49.735953 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:04:49.738565 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6"
14:04:49.743762 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.744373 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:04:49.744890 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.745618 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_ID.2a57daace6
14:04:49.746115 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:04:49.746673 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
14:04:49.747069 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:04:49.747465 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:04:49.751210 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f"
14:04:49.756859 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.757496 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:04:49.757973 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.758584 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_shop_profile_SHOP_NAME.ffad43b95f
14:04:49.759101 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:04:49.759701 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
14:04:49.760129 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:04:49.760536 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:04:49.763553 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83"
14:04:49.769000 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.769602 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:04:49.770112 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.770730 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_shop_id.5f28a1ac83
14:04:49.771280 [debug] [Thread-1  ]: Began running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:04:49.771963 [debug] [Thread-1  ]: Acquiring new snowflake connection "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
14:04:49.772663 [debug] [Thread-1  ]: Began compiling node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:04:49.773173 [debug] [Thread-1  ]: Compiling test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:04:49.776056 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001"
14:04:49.781187 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.782019 [debug] [Thread-1  ]: Began executing node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:04:49.782608 [debug] [Thread-1  ]: finished collecting timing info
14:04:49.783266 [debug] [Thread-1  ]: Finished running node test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001
14:04:49.784518 [debug] [MainThread]: Connection 'master' was properly closed.
14:04:49.785031 [debug] [MainThread]: Connection 'test.dbt_sales_pipeline.not_null_mart_top_shops_total_revenue.8061af0001' was properly closed.
14:04:49.797900 [info ] [MainThread]: Done.
14:04:49.812840 [debug] [MainThread]: Acquiring new snowflake connection "generate_catalog"
14:04:49.813446 [info ] [MainThread]: Building catalog
14:04:49.816440 [debug] [ThreadPool]: Acquiring new snowflake connection "SALES_PIPELINE.information_schema"
14:04:49.821730 [debug] [ThreadPool]: Using snowflake connection "SALES_PIPELINE.information_schema"
14:04:49.822470 [debug] [ThreadPool]: On SALES_PIPELINE.information_schema: /* {"app": "dbt", "dbt_version": "1.0.0", "profile_name": "sales_pipeline", "target_name": "dev", "connection_name": "SALES_PIPELINE.information_schema"} */

    
      with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from SALES_PIPELINE.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from SALES_PIPELINE.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('raw_staging') or upper("table_schema") = upper('raw') or upper("table_schema") = upper('raw_marts'))
      order by "column_index"
14:04:49.823191 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:04:52.255317 [debug] [ThreadPool]: SQL status: SUCCESS 81 in 2.43 seconds
14:04:52.275151 [debug] [ThreadPool]: On SALES_PIPELINE.information_schema: Close
14:04:52.365841 [info ] [MainThread]: Catalog written to /usr/app/target/catalog.json
14:04:52.366852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce8081c0af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce80324b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce802c4ff40>]}
14:04:52.772987 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
14:04:52.773768 [debug] [MainThread]: Connection 'SALES_PIPELINE.information_schema' was properly closed.


============================== 2025-08-05 14:05:05.185802 | dae9d874-68ec-498b-8b55-c360012b0ace ==============================
14:05:05.185802 [info ] [MainThread]: Running with dbt=1.0.0
14:05:05.186644 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8080, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
14:05:05.187383 [debug] [MainThread]: Tracking: tracking
14:05:05.188026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cc5580a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cc5580a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752cc55809d0>]}
14:05:05.201432 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
14:05:05.202243 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
14:05:05.203051 [info ] [MainThread]: 
14:05:05.203842 [info ] [MainThread]: 
14:05:05.204532 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 14:05:37.962390 | 0a05332c-c9d5-429b-a7f5-6e17563e463f ==============================
14:05:37.962390 [info ] [MainThread]: Running with dbt=1.0.0
14:05:37.963550 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8001, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
14:05:37.964372 [debug] [MainThread]: Tracking: tracking
14:05:37.965088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71858975cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71858975caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71858975ca90>]}
14:05:37.979289 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
14:05:37.980520 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
14:05:37.981419 [info ] [MainThread]: 
14:05:37.982041 [info ] [MainThread]: 
14:05:37.982701 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 14:06:44.303239 | c629a73f-5821-491f-a9d0-cc5215760514 ==============================
14:06:44.303239 [info ] [MainThread]: Running with dbt=1.0.0
14:06:44.304037 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8001, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
14:06:44.304712 [debug] [MainThread]: Tracking: tracking
14:06:44.305335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39a7ecdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39a7ecdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a39a7ecda90>]}
14:06:44.319647 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
14:06:44.320419 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
14:06:44.321271 [info ] [MainThread]: 
14:06:44.322136 [info ] [MainThread]: 
14:06:44.322939 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 14:07:17.964062 | 68c16cf8-e07c-45a6-94c5-fe781e0e09e8 ==============================
14:07:17.964062 [info ] [MainThread]: Running with dbt=1.0.0
14:07:17.964890 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8001, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
14:07:17.965559 [debug] [MainThread]: Tracking: tracking
14:07:17.966155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2433beb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2433beac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d2433bea60>]}
14:07:17.977944 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
14:07:17.978804 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
14:07:17.979568 [info ] [MainThread]: 
14:07:17.980131 [info ] [MainThread]: 
14:07:17.980716 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2025-08-05 14:10:10.760545 | 6f6316bf-5019-4bd9-9a4a-55ce9db6a3da ==============================
14:10:10.760545 [info ] [MainThread]: Running with dbt=1.0.0
14:10:10.761453 [debug] [MainThread]: running dbt with arguments Namespace(record_timing_info=None, debug=None, log_format=None, write_json=None, use_colors=None, printer_width=None, warn_error=None, version_check=None, partial_parse=None, single_threaded=False, use_experimental_parser=None, static_parser=None, profiles_dir='/root/.dbt', send_anonymous_usage_stats=None, fail_fast=None, event_buffer_size=None, project_dir=None, profile=None, target=None, vars='{}', log_cache_events=False, port=8001, open_browser=True, defer=None, state=None, cls=<class 'dbt.task.serve.ServeTask'>, which='serve', rpc_method=None)
14:10:10.762120 [debug] [MainThread]: Tracking: tracking
14:10:10.762702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798433d06ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798433d06a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x798433d06a00>]}
14:10:10.774193 [info ] [MainThread]: Serving docs at 0.0.0.0:8001
14:10:10.774768 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8001
14:10:10.775432 [info ] [MainThread]: 
14:10:10.776068 [info ] [MainThread]: 
14:10:10.776756 [info ] [MainThread]: Press Ctrl+C to exit.
